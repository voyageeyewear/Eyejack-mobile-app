<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eyejack Mobile App - Live Demo</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f8fafc;
            color: #1f2937;
            overflow-x: hidden;
        }

        body.splash-active {
            overflow: hidden;
        }

        /* Font fallbacks to prevent 404 errors */
        @font-face {
            font-family: 'ShopifySans';
            src: local('Inter'), local('system-ui'), local('-apple-system');
            font-display: swap;
        }

        /* Splash Screen Styles */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2563EB 0%, #1d4ed8 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 1;
            transition: opacity 0.5s ease-out;
        }

        .splash-screen.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        .splash-content {
            text-align: center;
            color: white;
            animation: fadeInUp 1s ease-out;
        }

        .splash-logo {
            margin-bottom: 40px;
        }

        .splash-logo-img {
            width: 120px;
            height: auto;
            filter: brightness(0) invert(1);
            animation: logoGlow 2s infinite alternate;
        }

        .splash-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .loading-text {
            font-size: 16px;
            font-weight: 500;
            opacity: 0.9;
            margin: 0;
            animation: pulse 2s infinite;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes logoGlow {
            from {
                filter: brightness(0) invert(1) drop-shadow(0 0 10px rgba(255, 255, 255, 0.5));
            }
            to {
                filter: brightness(0) invert(1) drop-shadow(0 0 20px rgba(255, 255, 255, 0.8));
            }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.9; }
            50% { opacity: 0.6; }
        }

        /* Product Detail Modal Styles */
        .product-detail-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #FFFFFF;
            z-index: 1000;
            display: none;
            flex-direction: column;
            animation: slideInUp 0.3s ease-out;
        }

        .product-detail-overlay.active {
            display: flex;
            transform: translateY(0);
        }

        @keyframes slideInUp {
            from {
                transform: translateY(100%);
            }
            to {
                transform: translateY(0);
            }
        }

        .product-detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 0;
            z-index: 1001;
        }

        .product-detail-back,
        .product-detail-share {
            background: none;
            border: none;
            font-size: 24px;
            font-weight: 600;
            color: #111827;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: all 0.2s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-detail-back:hover,
        .product-detail-share:hover {
            background: #f3f4f6;
        }

        .product-detail-content {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 120px;
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE/Edge */
        }
        
        .product-detail-content::-webkit-scrollbar {
            display: none; /* Chrome/Safari */
        }

        .product-detail-image-container {
            width: calc(100% - 40px);
            height: 350px;
            max-height: 350px;
            background: #f5f5f5;
            border-radius: 20px;
            margin: 20px;
            margin-bottom: 0;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-detail-image {
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: none;
        }

        .product-detail-placeholder {
            font-size: 80px;
            color: #9ca3af;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-detail-info {
            padding: 20px;
        }

        .product-detail-brand {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 8px;
        }

        .product-detail-title {
            font-size: 24px;
            font-weight: 700;
            color: #111827;
            margin: 0 0 12px 0;
            line-height: 1.2;
        }

        .product-detail-price {
            font-size: 28px;
            font-weight: 700;
            color: #111827;
            margin-bottom: 16px;
        }

        .product-detail-rating {
            margin-bottom: 24px;
        }

        .rating-stars {
            display: flex;
            align-items: center;
            gap: 4px;
            margin-bottom: 8px;
        }

        .rating-star {
            font-size: 18px;
            color: #d1d5db;
        }

        .rating-star.filled {
            color: #fbbf24;
        }

        .rating-value {
            font-size: 16px;
            font-weight: 600;
            color: #111827;
            margin-left: 8px;
        }

        .rating-details {
            display: flex;
            gap: 16px;
            font-size: 14px;
            color: #6b7280;
        }

        .product-detail-size {
            margin-bottom: 24px;
        }

        .size-label {
            font-size: 16px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 12px;
            display: block;
        }

        .size-options {
            display: flex;
            gap: 12px;
        }

        .size-option {
            width: 48px;
            height: 48px;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            color: #374151;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .size-option:hover {
            border-color: #ef4444;
        }

        .size-option.selected {
            border-color: #ef4444;
            background: #ef4444;
            color: white;
        }

        /* Color selection styles */
        .color-label {
            font-size: 16px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 12px;
            display: block;
        }

        .color-options {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .color-option {
            width: 48px;
            height: 48px;
            border: 3px solid #e5e7eb;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            position: relative;
        }

        .color-option:hover {
            transform: scale(1.1);
            border-color: #374151;
        }

        .color-option.selected {
            border-color: #ef4444;
            transform: scale(1.1);
            box-shadow: 0 0 0 2px #ef4444;
        }

        .color-option.selected::after {
            content: '✓';
            position: absolute;
            color: #fff;
            font-size: 16px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        .product-detail-description {
            margin-bottom: 24px;
            margin-top: 15px;
        }

        .product-detail-description h3 {
            font-size: 16px;
            font-weight: 600;
            color: #111827;
            margin: 0 0 12px 0;
        }

        .description-text {
            font-size: 14px;
            line-height: 1.6;
            color: #6b7280;
        }

        .product-detail-actions {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 16px 20px;
            box-shadow: 0 -2px 20px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            z-index: 1002;
            max-width: 100vw;
            margin: 0 auto;
        }

        .cart-icon-container {
            cursor: pointer;
            position: relative;
        }

        .cart-icon-wrapper {
            width: 52px;
            height: 52px;
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .cart-icon-wrapper:hover {
            background: #f5f5f5;
            border-color: #111827;
        }

        .cart-icon {
            width: 24px;
            height: 24px;
            color: #374151;
        }

        .cart-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }

        .action-btn {
            flex: 1;
            padding: 16px;
            border: 2px solid transparent;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            height: 52px;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 0;
        }

        .buy-now-btn {
            background: white;
            color: #111827;
            border-color: #e5e7eb;
        }

        .buy-now-btn:hover {
            border-color: #111827;
        }

        .add-to-cart-btn {
            background: #ef4444;
            color: white;
            border-color: #ef4444;
        }

        .add-to-cart-btn:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }

        /* Hide bottom nav when product detail is open */
        body:has(.product-detail-overlay.active) .bottom-nav {
            display: none !important;
        }

        /* Authentication Modal Styles */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 20000;
            backdrop-filter: blur(5px);
        }

        .auth-modal.active {
            display: flex;
        }

        .auth-modal-content {
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 400px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUpModal 0.3s ease-out;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .auth-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 25px 25px 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .auth-title {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
            margin: 0;
        }

        .auth-close {
            background: none;
            border: none;
            font-size: 28px;
            color: #6b7280;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s;
        }

        .auth-close:hover {
            background: #f3f4f6;
            color: #374151;
        }

        .auth-body {
            padding: 25px;
        }

        .auth-screen {
            animation: fadeIn 0.3s ease-in-out;
        }

        .auth-welcome {
            text-align: center;
            margin-bottom: 30px;
        }

        .auth-welcome p {
            color: #6b7280;
            font-size: 16px;
            line-height: 1.5;
            margin: 0;
        }

        .social-login-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 25px;
        }

        .social-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 15px 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            background: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
        }

        .social-btn:hover {
            border-color: #d1d5db;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .google-btn {
            color: #4285f4;
        }

        .google-btn:hover {
            border-color: #4285f4;
            background: #f8faff;
        }

        .facebook-btn {
            color: #1877f2;
        }

        .facebook-btn:hover {
            border-color: #1877f2;
            background: #f0f7ff;
        }

        .apple-btn {
            color: #000;
        }

        .apple-btn:hover {
            border-color: #000;
            background: #f9f9f9;
        }

        .auth-divider {
            text-align: center;
            margin: 25px 0;
            position: relative;
        }

        .auth-divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #e5e7eb;
        }

        .auth-divider span {
            background: white;
            padding: 0 20px;
            color: #6b7280;
            font-size: 14px;
        }

        .phone-login-btn {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 15px 20px;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .phone-login-btn:hover {
            background: #1d4ed8;
            transform: translateY(-1px);
        }

        .phone-login h3 {
            text-align: center;
            font-size: 22px;
            font-weight: 700;
            color: #1f2937;
            margin: 0 0 8px 0;
        }

        .phone-login p {
            text-align: center;
            color: #6b7280;
            margin: 0 0 30px 0;
        }

        .phone-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
        }

        .country-code {
            width: 100px;
            padding: 15px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 16px;
            background: white;
            cursor: pointer;
        }

        .phone-input {
            flex: 1;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 16px;
            transition: border-color 0.2s;
        }

        .phone-input:focus {
            outline: none;
            border-color: #2563eb;
        }

        .auth-submit-btn {
            width: 100%;
            padding: 15px;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .auth-submit-btn:hover:not(:disabled) {
            background: #1d4ed8;
        }

        .auth-submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .auth-back-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            background: none;
            border: none;
            color: #6b7280;
            font-size: 16px;
            cursor: pointer;
            padding: 10px 0;
            transition: color 0.2s;
        }

        .auth-back-btn:hover {
            color: #374151;
        }

        .otp-verification h3 {
            text-align: center;
            font-size: 22px;
            font-weight: 700;
            color: #1f2937;
            margin: 0 0 8px 0;
        }

        .otp-verification p {
            text-align: center;
            color: #6b7280;
            margin: 0 0 30px 0;
        }

        .otp-input-group {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 30px;
        }

        .otp-digit {
            width: 45px;
            height: 55px;
            text-align: center;
            font-size: 24px;
            font-weight: 600;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            transition: border-color 0.2s;
        }

        .otp-digit:focus {
            outline: none;
            border-color: #2563eb;
        }

        .resend-btn {
            display: block;
            width: 100%;
            text-align: center;
            background: none;
            border: none;
            color: #6b7280;
            font-size: 14px;
            cursor: pointer;
            padding: 15px 0;
            margin-bottom: 10px;
            transition: color 0.2s;
        }

        .resend-text {
            color: #2563eb;
            font-weight: 600;
        }

        .resend-btn:hover .resend-text {
            text-decoration: underline;
        }

        .auth-loading {
            text-align: center;
            padding: 40px 20px;
        }

        .loading-spinner-large {
            width: 60px;
            height: 60px;
            border: 4px solid #e5e7eb;
            border-top: 4px solid #2563eb;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 30px;
        }

        .auth-loading h3 {
            font-size: 20px;
            font-weight: 600;
            color: #1f2937;
            margin: 0 0 10px 0;
        }

        .auth-loading p {
            color: #6b7280;
            margin: 0;
        }

        .btn-loader {
            width: 20px;
            height: 20px;
            border: 2px solid transparent;
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes slideUpModal {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Profile Drawer Styles */
        .profile-drawer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 21000;
            backdrop-filter: blur(3px);
        }

        .profile-drawer.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        .profile-drawer-content {
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: #f8f9fa;
            transform: translateX(100%);
            transition: transform 0.3s ease-out;
            overflow-y: auto;
        }

        .profile-drawer.active .profile-drawer-content {
            transform: translateX(0);
        }

        .profile-header {
            background: white;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .profile-back-btn {
            background: none;
            border: none;
            font-size: 20px;
            color: #333;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .profile-back-btn:hover {
            background: #f0f0f0;
        }

        .profile-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin: 0;
        }

        .profile-body {
            padding: 0;
        }

        .profile-section {
            background: white;
            margin-bottom: 12px;
            padding: 20px;
        }

        .profile-section-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin: 0 0 15px 0;
        }

        .account-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .profile-phone-icon {
            color: #666;
            font-size: 18px;
        }

        .account-email {
            font-size: 18px;
            color: #333;
            font-weight: 500;
        }

        .birthday-section {
            background: #fef7e3;
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 16px;
            margin: 0 20px 20px 20px;
            transition: all 0.3s ease;
            border: 1px solid #fde68a;
        }

        .birthday-section:hover {
            background: #fef3c7;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .birthday-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .birthday-text h4 {
            margin: 0 0 5px 0;
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .birthday-subtitle {
            color: #059669;
            font-size: 16px;
            font-weight: 600;
        }

        .birthday-icon {
            font-size: 32px;
        }

        /* Birthday Modal Styles */
        .birthday-form {
            text-align: center;
            padding: 20px;
        }

        .birthday-icon-large {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .birthday-description {
            color: #666;
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 30px;
            padding: 0 10px;
        }

        .birthday-input-group {
            margin-bottom: 30px;
            text-align: left;
        }

        .birthday-input-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .birthday-input {
            width: 100%;
            padding: 16px;
            font-size: 16px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            background: #f9fafb;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        .birthday-input:focus {
            outline: none;
            border-color: #2563eb;
            background: #fff;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .birthday-privacy {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            color: #666;
            font-size: 14px;
            background: #f0f9ff;
            padding: 12px 16px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .birthday-privacy i {
            color: #2563eb;
        }

        .action-cards {
            display: flex;
            flex-direction: column;
            gap: 16px;
            padding: 0 20px;
            margin-bottom: 20px;
        }

        .action-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid #f1f5f9;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .action-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            border-color: #e2e8f0;
        }

        .action-card-icon {
            width: 52px;
            height: 52px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .action-card-icon.wallet {
            background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
        }

        .action-card-icon.support {
            background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
        }

        .action-card-icon.payments {
            background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
        }

        .action-card-icon i {
            color: white;
            font-size: 22px;
        }

        .action-card-content {
            flex: 1;
        }

        .action-card-title {
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
            margin: 0;
            line-height: 1.3;
        }

        .update-notification {
            background: #e0f2fe;
            margin: 0 20px 12px 20px;
            border-radius: 12px;
            padding: 16px 20px;
        }

        .update-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .update-content i:first-child {
            color: #0277bd;
            font-size: 18px;
        }

        .update-text {
            flex: 1;
            font-size: 16px;
            font-weight: 500;
            color: #333;
        }

        .update-version {
            color: #0277bd;
            font-size: 14px;
            font-weight: 600;
        }

        .update-content i:last-child {
            color: #666;
            font-size: 14px;
        }

        .appearance-setting {
            background: white;
            margin-bottom: 12px;
            padding: 20px;
        }

        .appearance-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .appearance-content i:first-child {
            color: #666;
            font-size: 18px;
        }

        .appearance-content > span {
            flex: 1;
            font-size: 16px;
            font-weight: 500;
            color: #333;
        }

        .appearance-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toggle-label {
            color: #666;
            font-size: 14px;
            font-weight: 500;
        }

        .appearance-toggle i {
            color: #666;
            font-size: 12px;
        }

        .section-subtitle {
            color: #9ca3af;
            font-size: 12px;
            font-weight: 600;
            letter-spacing: 0.5px;
            margin: 0 0 15px 0;
            text-transform: uppercase;
        }

        .info-menu {
            display: flex;
            flex-direction: column;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 16px 0;
            border-bottom: 1px solid #f3f4f6;
            cursor: pointer;
            transition: background 0.2s;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-item:hover {
            background: #f9fafb;
        }

        .info-item i:first-child {
            color: #666;
            font-size: 18px;
            width: 20px;
            text-align: center;
        }

        .info-item > span {
            flex: 1;
            font-size: 16px;
            font-weight: 500;
            color: #333;
        }

        .info-item i:last-child {
            color: #9ca3af;
            font-size: 14px;
        }

        .profile-actions {
            padding: 20px;
            margin-top: 20px;
        }

        .sign-out-btn {
            width: 100%;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: background 0.2s;
        }

        .sign-out-btn:hover {
            background: #dc2626;
        }

        @media (min-width: 768px) {
            .profile-drawer-content {
                width: 400px;
                right: 0;
                box-shadow: -4px 0 20px rgba(0, 0, 0, 0.15);
            }
        }

        /* Feature Modals Styles */
        .feature-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            z-index: 22000;
        }

        /* Appearance Modal specific styling */
        #appearanceModal {
            z-index: 23000;
        }

        #appearanceModal .modal-content {
            z-index: 23001;
        }

        .feature-modal.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        .modal-backdrop {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(3px);
        }

        .modal-content {
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: #f8f9fa;
            transform: translateX(100%);
            transition: transform 0.3s ease-out;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .feature-modal.active .modal-content {
            transform: translateX(0);
        }

        .modal-header {
            background: white;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .modal-back-btn {
            background: none;
            border: none;
            font-size: 20px;
            color: #333;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .modal-back-btn:hover {
            background: #f0f0f0;
        }

        .modal-title {
            flex: 1;
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin: 0;
        }

        .modal-action-btn {
            background: #2563EB;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s;
        }

        .modal-action-btn:hover {
            background: #1d4ed8;
        }

        .modal-body {
            flex: 1;
            padding: 20px;
            background: #f8f9fa;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .empty-state i {
            font-size: 48px;
            color: #ccc;
            margin-bottom: 20px;
        }

        .empty-state h3 {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin: 0 0 10px 0;
        }

        .empty-state p {
            font-size: 14px;
            color: #666;
            margin: 0;
            line-height: 1.5;
        }

        /* Orders Styles */
        .order-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .order-number {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .order-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
        }

        .order-status.delivered {
            background: #d1fae5;
            color: #065f46;
        }

        .order-status.processing {
            background: #fef3c7;
            color: #92400e;
        }

        .order-status.shipped {
            background: #dbeafe;
            color: #1e40af;
        }

        .order-details {
            display: flex;
            gap: 15px;
        }

        .order-image {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            background: #f3f4f6;
            background-size: cover;
            background-position: center;
        }

        .order-info {
            flex: 1;
        }

        .order-product-name {
            font-size: 14px;
            font-weight: 500;
            color: #333;
            margin-bottom: 5px;
        }

        .order-date {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .order-total {
            font-size: 16px;
            font-weight: 600;
            color: #2563EB;
        }

        /* Wishlist Styles */
        .wishlist-item {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            gap: 15px;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .wishlist-image {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            background: #f3f4f6;
            background-size: cover;
            background-position: center;
        }

        .wishlist-info {
            flex: 1;
        }

        .wishlist-product-name {
            font-size: 16px;
            font-weight: 500;
            color: #333;
            margin-bottom: 5px;
        }

        .wishlist-price {
            font-size: 14px;
            font-weight: 600;
            color: #2563EB;
            margin-bottom: 10px;
        }

        .wishlist-actions {
            display: flex;
            gap: 10px;
        }

        .wishlist-btn {
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .wishlist-btn.primary {
            background: #2563EB;
            color: white;
            border: none;
        }

        .wishlist-btn.secondary {
            background: none;
            color: #ef4444;
            border: 1px solid #ef4444;
        }

        .wishlist-btn:hover {
            transform: translateY(-1px);
        }

        /* Recipes Styles */
        .recipe-item {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .recipe-image {
            width: 100%;
            height: 150px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .recipe-content {
            padding: 15px;
        }

        .recipe-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .recipe-description {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .recipe-tags {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .recipe-tag {
            background: #f3f4f6;
            color: #374151;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        /* Address Styles */
        .address-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .address-item:hover {
            border-color: #2563EB;
        }

        .address-item.selected {
            border-color: #2563EB;
            background: #eff6ff;
        }

        .address-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .address-type {
            background: #2563EB;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
        }

        .address-actions {
            display: flex;
            gap: 10px;
        }

        .address-action-btn {
            background: none;
            border: none;
            color: #666;
            font-size: 14px;
            cursor: pointer;
            padding: 4px;
        }

        .address-action-btn:hover {
            color: #2563EB;
        }

        .address-name {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .address-details {
            font-size: 14px;
            color: #666;
            line-height: 1.4;
        }

        .address-phone {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        /* GST Form Styles */
        .gst-form {
            background: white;
            border-radius: 12px;
            padding: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #333;
            margin-bottom: 8px;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            color: #333;
            background: white;
            transition: border-color 0.2s;
            box-sizing: border-box;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #2563EB;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        /* Gift Cards Styles */
        .gift-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .gift-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        }

        .gift-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .gift-card-logo {
            font-size: 20px;
            font-weight: 700;
        }

        .gift-card-type {
            font-size: 12px;
            opacity: 0.8;
        }

        .gift-card-amount {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .gift-card-code {
            font-size: 14px;
            font-family: 'Courier New', monospace;
            background: rgba(255,255,255,0.2);
            padding: 8px 12px;
            border-radius: 6px;
            display: inline-block;
        }

        /* Appearance Settings Styles */
        .appearance-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* Cart Modal Styles */
        .cart-items {
            max-height: 60vh;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .cart-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
            gap: 15px;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item-image {
            flex-shrink: 0;
            width: 80px;
            height: 80px;
            border-radius: 8px;
            overflow: hidden;
            background: #f5f5f5;
        }

        .cart-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .cart-item-details {
            flex: 1;
            min-width: 0;
        }

        .cart-item-details h4 {
            margin: 0 0 8px 0;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .cart-item-price {
            margin: 0 0 12px 0;
            font-size: 18px;
            font-weight: 700;
            color: #e74c3c;
        }

        .cart-item-quantity {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .quantity-btn {
            width: 32px;
            height: 32px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            color: #666;
            transition: all 0.2s ease;
        }

        .quantity-btn:hover {
            background: #f8f9fa;
            border-color: #007bff;
            color: #007bff;
        }

        .quantity-btn:active {
            transform: scale(0.95);
        }

        .quantity {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            min-width: 20px;
            text-align: center;
        }

        .cart-item-actions {
            flex-shrink: 0;
        }

        .remove-item-btn {
            width: 40px;
            height: 40px;
            border: none;
            background: #fee;
            color: #e74c3c;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .remove-item-btn:hover {
            background: #fdd;
            transform: scale(1.05);
        }

        .cart-summary {
            border-top: 1px solid #eee;
            padding-top: 20px;
            margin-top: 20px;
        }

        .cart-total {
            margin-bottom: 20px;
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            font-size: 16px;
        }

        .total-final {
            border-top: 1px solid #eee;
            margin-top: 10px;
            padding-top: 15px;
            font-size: 18px;
        }

        .cart-actions {
            display: flex;
            gap: 12px;
            flex-direction: column;
        }

        .cart-actions .btn {
            padding: 15px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }

        .cart-actions .btn.primary {
            background: #007bff;
            color: white;
        }

        .cart-actions .btn.primary:hover {
            background: #0056b3;
            transform: translateY(-1px);
        }

        .cart-actions .btn.secondary {
            background: #f8f9fa;
            color: #333;
            border: 1px solid #ddd;
        }

        .cart-actions .btn.secondary:hover {
            background: #e9ecef;
        }

        @media (min-width: 480px) {
            .cart-actions {
                flex-direction: row;
            }
            
            .cart-actions .btn {
                flex: 1;
            }
        }

        /* Cool Close Button Design */
        .cart-close-btn {
            position: absolute;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
            z-index: 10;
        }

        .cart-close-btn:hover {
            transform: translateY(-50%) scale(1.1) rotate(90deg);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
            background: linear-gradient(135deg, #ff5252, #d32f2f);
        }

        .cart-close-btn:active {
            transform: translateY(-50%) scale(0.95) rotate(90deg);
        }

        .close-icon {
            position: relative;
            width: 18px;
            height: 18px;
        }

        .close-icon span {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 18px;
            height: 2px;
            background: white;
            border-radius: 1px;
            transition: all 0.3s ease;
        }

        .close-icon span:first-child {
            transform: translate(-50%, -50%) rotate(45deg);
        }

        .close-icon span:last-child {
            transform: translate(-50%, -50%) rotate(-45deg);
        }

        .cart-close-btn:hover .close-icon span {
            background: white;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
        }

        /* Update modal header to accommodate the new close button position */
        .modal-header {
            position: relative;
            padding-right: 35px;
        }

        .theme-option {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .theme-option:hover {
            border-color: #2563EB;
        }

        .theme-option.selected {
            border-color: #2563EB;
            background: #eff6ff;
        }

        .theme-preview {
            width: 60px;
            height: 40px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .light-preview {
            background: #ffffff;
        }

        .dark-preview {
            background: #1f2937;
        }

        .preview-header {
            height: 12px;
            background: #f3f4f6;
        }

        .dark-preview .preview-header {
            background: #374151;
        }

        .preview-content {
            height: 28px;
            background: #ffffff;
        }

        .dark-preview .preview-content {
            background: #111827;
        }

        .theme-info {
            flex: 1;
        }

        .theme-info h3 {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin: 0 0 5px 0;
        }

        .theme-info p {
            font-size: 14px;
            color: #666;
            margin: 0;
        }

        .theme-radio {
            position: relative;
        }

        .theme-radio input[type="radio"] {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
        }

        .theme-radio input[type="radio"]:checked {
            border-color: #2563EB;
            background: #2563EB;
        }

        .theme-radio input[type="radio"]:checked::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: white;
        }

        .loading-state {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }

        .loading-state i {
            font-size: 24px;
            color: #2563EB;
            margin-bottom: 15px;
        }

        .loading-state p {
            font-size: 16px;
            margin: 0;
        }

        @media (min-width: 768px) {
            .modal-content {
                width: 400px;
                right: 0;
                box-shadow: -4px 0 20px rgba(0, 0, 0, 0.15);
            }
        }

        /* Dark Theme Styles */
        .dark-theme {
            background-color: #1f2937;
            color: #f9fafb;
        }

        .dark-theme .mobile-container {
            background: #1f2937;
            color: #f9fafb;
            box-shadow: 0 0 20px rgba(255,255,255,0.1);
        }

        .dark-theme .header {
            background: #111827;
            border-bottom: 1px solid #374151;
        }

        .dark-theme .announcement-bar {
            background: #374151;
            color: #f9fafb;
        }

        .dark-theme .hero-slide {
            background-color: #374151;
        }

        .dark-theme .product-card {
            background: #374151;
            border: 1px solid #4b5563;
            color: #f9fafb;
        }

        .dark-theme .section-title {
            color: #f9fafb;
        }

        .dark-theme .footer {
            background: #111827;
            color: #f9fafb;
        }

        .dark-theme .bottom-nav {
            background: #111827;
            border-top: 1px solid #374151;
        }

        .dark-theme .nav-item {
            color: #9ca3af;
        }

        .dark-theme .nav-item.active {
            color: #60a5fa;
        }

        .dark-theme .profile-drawer-content {
            background: #374151;
            color: #f9fafb;
        }

        .dark-theme .profile-section {
            background: #4b5563;
            color: #f9fafb;
        }

        .dark-theme .modal-content {
            background: #374151;
            color: #f9fafb;
        }

        .dark-theme .modal-header {
            background: #4b5563;
            border-bottom: 1px solid #6b7280;
        }

        /* Dark theme for birthday modal */
        .dark-theme .birthday-input {
            background: #374151;
            border-color: #4b5563;
            color: #f9fafb;
        }

        .dark-theme .birthday-input:focus {
            border-color: #60a5fa;
            background: #4b5563;
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.1);
        }

        .dark-theme .birthday-input-group label {
            color: #f9fafb;
        }

        .dark-theme .birthday-description {
            color: #d1d5db;
        }

        .dark-theme .birthday-privacy {
            background: #1f2937;
            color: #d1d5db;
        }

        .dark-theme .birthday-privacy i {
            color: #60a5fa;
        }

        /* Thank You Modal Styles */
        .thank-you-content {
            max-width: 420px;
            text-align: center;
            padding: 30px 25px;
        }

        .thank-you-header {
            margin-bottom: 30px;
        }

        .success-animation {
            margin-bottom: 20px;
        }

        .checkmark-circle {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #10b981, #059669);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: checkmarkPop 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
        }

        .checkmark {
            width: 30px;
            height: 30px;
            position: relative;
        }

        .checkmark::after {
            content: '';
            position: absolute;
            left: 8px;
            top: 12px;
            width: 8px;
            height: 16px;
            border: solid white;
            border-width: 0 3px 3px 0;
            transform: rotate(45deg);
            animation: checkmarkDraw 0.3s ease-out 0.3s both;
        }

        @keyframes checkmarkPop {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes checkmarkDraw {
            0% {
                height: 0;
                width: 0;
                opacity: 0;
            }
            50% {
                height: 0;
                width: 8px;
                opacity: 1;
            }
            100% {
                height: 16px;
                width: 8px;
                opacity: 1;
            }
        }

        .thank-you-title {
            font-size: 28px;
            font-weight: 700;
            color: #111827;
            margin: 0 0 8px 0;
            animation: fadeInUp 0.6s ease-out 0.2s both;
        }

        .thank-you-subtitle {
            font-size: 16px;
            color: #6b7280;
            margin: 0;
            animation: fadeInUp 0.6s ease-out 0.4s both;
        }

        .order-details-card {
            background: #f9fafb;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            animation: fadeInUp 0.6s ease-out 0.6s both;
        }

        .order-info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .order-info-row:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .order-info-row:first-child {
            padding-top: 0;
        }

        .order-label {
            font-size: 14px;
            color: #6b7280;
            font-weight: 500;
        }

        .order-value {
            font-size: 14px;
            color: #111827;
            font-weight: 600;
        }

        .delivery-info {
            display: flex;
            align-items: center;
            background: #ecfdf5;
            border: 1px solid #d1fae5;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 30px;
            animation: fadeInUp 0.6s ease-out 0.8s both;
        }

        .delivery-icon {
            font-size: 32px;
            margin-right: 16px;
        }

        .delivery-text {
            text-align: left;
            flex: 1;
        }

        .delivery-text h4 {
            margin: 0 0 4px 0;
            font-size: 16px;
            font-weight: 600;
            color: #065f46;
        }

        .delivery-text p {
            margin: 0;
            font-size: 14px;
            color: #047857;
        }

        .thank-you-actions {
            display: flex;
            gap: 12px;
            animation: fadeInUp 0.6s ease-out 1s both;
        }

        .btn-primary {
            flex: 1;
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 14px 20px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4);
        }

        .btn-secondary {
            flex: 1;
            background: white;
            color: #374151;
            border: 2px solid #d1d5db;
            border-radius: 12px;
            padding: 14px 20px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: #f9fafb;
            border-color: #9ca3af;
            transform: translateY(-1px);
        }

        @keyframes fadeInUp {
            0% {
                opacity: 0;
                transform: translateY(30px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dark-theme .birthday-section {
            background: #374151;
        }

        .dark-theme .birthday-section:hover {
            background: #4b5563;
        }

        .dark-theme .birthday-text h4 {
            color: #f9fafb;
        }

        /* Dark theme for thank you modal */
        .dark-theme .thank-you-title {
            color: #f9fafb;
        }

        .dark-theme .thank-you-subtitle {
            color: #d1d5db;
        }

        .dark-theme .order-details-card {
            background: #374151;
        }

        .dark-theme .order-info-row {
            border-bottom-color: #4b5563;
        }

        .dark-theme .order-label {
            color: #d1d5db;
        }

        .dark-theme .order-value {
            color: #f9fafb;
        }

        .dark-theme .delivery-info {
            background: #064e3b;
            border-color: #065f46;
        }

        .dark-theme .delivery-text h4 {
            color: #10b981;
        }

        .dark-theme .delivery-text p {
            color: #6ee7b7;
        }

        .dark-theme .btn-secondary {
            background: #374151;
            color: #f9fafb;
            border-color: #4b5563;
        }

        .dark-theme .btn-secondary:hover {
            background: #4b5563;
            border-color: #6b7280;
        }

        /* Track Order Modal Styles */
        .track-order-form {
            text-align: center;
            padding: 20px 0;
        }

        .track-order-icon {
            font-size: 64px;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        .track-order-description {
            font-size: 16px;
            color: #6b7280;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .track-order-input {
            width: 100%;
            padding: 16px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 16px;
            text-align: center;
            font-weight: 600;
            color: #333;
            background: #f9fafb;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        .track-order-input:focus {
            outline: none;
            border-color: #2563eb;
            background: white;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .track-order-btn {
            width: 100%;
            margin-top: 20px;
            padding: 16px;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .tracking-results {
            margin-top: 30px;
            animation: fadeInUp 0.5s ease-out;
        }

        .tracking-item {
            background: #f9fafb;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #2563eb;
        }

        .tracking-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .tracking-order-number {
            font-size: 18px;
            font-weight: 700;
            color: #111827;
        }

        .tracking-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .tracking-status.processing {
            background: #fef3c7;
            color: #92400e;
        }

        .tracking-status.shipped {
            background: #dbeafe;
            color: #1e40af;
        }

        .tracking-status.delivered {
            background: #d1fae5;
            color: #065f46;
        }

        .tracking-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .tracking-detail-item {
            text-align: center;
        }

        .tracking-detail-label {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 4px;
            text-transform: uppercase;
            font-weight: 500;
        }

        .tracking-detail-value {
            font-size: 14px;
            color: #111827;
            font-weight: 600;
        }

        .tracking-timeline {
            margin-top: 20px;
        }

        .timeline-step {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-left: 0;
        }

        .timeline-step:last-child {
            margin-bottom: 0;
        }

        .timeline-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 12px;
            flex-shrink: 0;
        }

        .timeline-icon.completed {
            background: #10b981;
            color: white;
        }

        .timeline-icon.current {
            background: #2563eb;
            color: white;
        }

        .timeline-icon.pending {
            background: #e5e7eb;
            color: #6b7280;
        }

        .timeline-content {
            flex: 1;
        }

        .timeline-title {
            font-size: 14px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 2px;
        }

        .timeline-date {
            font-size: 12px;
            color: #6b7280;
        }

        /* Dark theme for track order modal */
        .dark-theme .track-order-description {
            color: #d1d5db;
        }

        .dark-theme .track-order-input {
            background: #374151;
            border-color: #4b5563;
            color: #f9fafb;
        }

        .dark-theme .track-order-input:focus {
            border-color: #3b82f6;
            background: #4b5563;
        }

        .dark-theme .tracking-item {
            background: #374151;
        }

        .dark-theme .tracking-order-number {
            color: #f9fafb;
        }

        .dark-theme .tracking-detail-value {
            color: #f9fafb;
        }

        .dark-theme .tracking-detail-label {
            color: #d1d5db;
        }

        .dark-theme .timeline-title {
            color: #f9fafb;
        }

        .dark-theme .timeline-date {
            color: #d1d5db;
        }

        .dark-theme .gst-form {
            background: #4b5563;
        }

        .dark-theme .form-group input,
        .dark-theme .form-group textarea {
            background: #374151;
            border: 1px solid #6b7280;
            color: #f9fafb;
        }

        .dark-theme .form-group input:focus,
        .dark-theme .form-group textarea:focus {
            border-color: #60a5fa;
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.1);
        }

        .dark-theme .empty-state {
            color: #9ca3af;
        }

        .dark-theme .empty-state h3 {
            color: #f9fafb;
        }

        /* Light Theme Explicit Styles */
        .light-theme {
            background-color: #ffffff;
            color: #1f2937;
        }

        .light-theme .mobile-container {
            background: #ffffff;
            color: #1f2937;
        }

        .mobile-container {
            max-width: 375px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            position: relative;
        }

        /* Announcement Bar */
        .announcement-bar {
            background: #ff6b35;
            color: white;
            text-align: center;
            padding: 15px 70px;
            font-size: 16px;
            font-weight: 500;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: slideDown 0.5s ease-out;
            min-height: 60px;
            box-sizing: border-box;
            overflow: hidden;
        }
        
        .announcement-bar * {
            color: inherit !important;
            font-size: inherit !important;
        }

        .announcement-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.4);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            z-index: 5;
            flex-shrink: 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .announcement-nav:hover {
            background: rgba(0, 0, 0, 0.6);
            transform: translateY(-50%) scale(1.05);
        }

        .announcement-nav:active {
            transform: translateY(-50%) scale(0.95);
        }

        .announcement-nav.prev {
            left: 12px;
        }

        .announcement-nav.next {
            right: 12px;
        }

        .announcement-text {
            transition: opacity 0.3s ease;
            flex: 1;
            text-align: center;
            line-height: 1.4;
            padding: 0;
            max-width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            color: inherit;
            font-size: inherit;
            z-index: 2;
        }

        .announcement-text-content {
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
            transition: transform 0.8s ease-in-out;
            white-space: nowrap;
            max-width: 100%;
            text-align: center;
            width: 100%;
            color: inherit !important;
            font-size: inherit !important;
            display: block;
            visibility: visible !important;
            opacity: 1 !important;
            margin: 0;
            z-index: 3;
            position: relative;
        }

        .announcement-text-content.multiline {
            white-space: normal;
            animation: textScroll 6s ease-in-out infinite;
            line-height: 1.4;
            display: block;
            width: 100%;
            visibility: visible !important;
            opacity: 1 !important;
        }

        /* Force text visibility */
        .announcement-bar .announcement-text .announcement-text-content {
            color: white !important;
            visibility: visible !important;
            opacity: 1 !important;
            display: block !important;
            text-align: center !important;
        }

        @keyframes textScroll {
            0%, 30% {
                transform: translateY(0);
                opacity: 1;
            }
            50%, 80% {
                transform: translateY(-25%);
                opacity: 1;
            }
            100% {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* Header */
        .header {
            background: rgba(128, 128, 128, 0.15);
            backdrop-filter: blur(1px);
            -webkit-backdrop-filter: blur(8px);
            padding: 12px 16px;
            background-color:  rgb(255 255 255 / 0%) !important;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: absolute;
            top: 60px;
            left: 0;
            right: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .header-center {
            flex: 1;
            text-align: center;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .header-right > * {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .hamburger-menu {
            color: white;
            cursor: pointer;
            padding: 4px;
            border-radius: 6px;
            transition: all 0.3s ease;
            display: inline-block;
            position: relative;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
            -webkit-tap-highlight-color: transparent;
            tap-highlight-color: transparent;
        }

        .hamburger-menu:hover {
            transform: scale(1.05);
        }

        .hamburger-menu:active,
        .hamburger-menu:focus {
            background: none !important;
            outline: none;
        }



        .hamburger-menu svg {
            width: 24px;
            height: 24px;
            display: block;
            stroke-width: 2.5;
            transition: all 0.3s ease;
        }

        .search-icon {
            color: white;
            cursor: pointer;
            padding: 4px;
            border-radius: 6px;
            transition: background-color 0.2s ease;
            display: inline-block;
            filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
            -webkit-tap-highlight-color: transparent;
            tap-highlight-color: transparent;
        }

        .search-icon:hover {
        }

        .search-icon:active,
        .search-icon:focus {
            background: none !important;
            outline: none;
        }



        .search-icon svg {
            width: 22px;
            height: 22px;
            display: block;
            stroke-width: 2.5;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 32px;
        }

        .logo img {
            height: 30px;
            width: auto;
            max-width: 120px;
            object-fit: contain;
        }

        .logo-text {
            font-size: 18px;
            font-weight: 600;
            color: white;
            letter-spacing: 0.5px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .profile-icon {
            color: white;
            cursor: pointer;
            padding: 4px;
            border-radius: 6px;
            transition: background-color 0.2s ease;
            display: inline-block;
            filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
            -webkit-tap-highlight-color: transparent;
            tap-highlight-color: transparent;
        }

        .profile-icon:hover {
        }

        .profile-icon:active,
        .profile-icon:focus {
            background: none !important;
            outline: none;
        }



        .profile-icon svg {
            width: 24px;
            height: 24px;
            display: block;
            stroke-width: 2.5;
        }

        .cart-container {
            position: relative;
            cursor: pointer;
            display: inline-block;
            padding: 4px;
            border-radius: 6px;
            transition: background-color 0.2s ease;
            filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
            -webkit-tap-highlight-color: transparent;
            tap-highlight-color: transparent;
        }

        .cart-container:hover {
        }

        .cart-container:active,
        .cart-container:focus {
            background: none !important;
            outline: none;
        }

        .cart-icon {
            width: 24px;
            height: 24px;
            color: rgb(255, 255, 255);
            display: block;
            stroke: currentColor;
            fill: none;
            stroke-width: 2.5;
        }

        .cart-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            min-width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
            z-index: 10;
            border: 2px solid white;
            line-height: 1;
            transition: all 0.3s ease;
            opacity: 1;
        }


        /* Modern Banner */
        .hero-slider {
            height: 500px;
            /* background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); */
            position: relative;
            overflow: hidden;
            margin-top: 0;
        }

        .hero-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }

        .hero-slide.active {
            opacity: 1;
        }

        .hero-content {
            text-align: center;
            color: white;
            z-index: 2;
            padding-top: 50px;
        }

        .hero-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .hero-subtitle {
            font-size: 16px;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .hero-btn {
            background: white;
            color: #2563EB;
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .hero-btn:hover {
            transform: translateY(-2px);
        }

        .slider-indicators {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
        }

        .indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255,255,255,0.5);
            cursor: pointer;
            transition: background 0.2s;
        }

        .indicator.active {
            background: white;
        }

        /* Section Headers */
        .section {
            padding: 20px;
            /* Ensure no overflow clipping for category hover effects */
            overflow: visible;
        }

        .section-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 19px;
            font-weight: 700;
            margin-bottom: 8px;
            color: #1f2937;
            text-align: left;
        }

        .section-subtitle {
            color: #6b7280;
            font-size: 12px;
            text-align: left;
        }

        /* Categories Grid - Elegant Circular Design */
        .categories-grid {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 25px;
            margin-bottom: 30px;
            padding: 15px 20px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            /* Ensure circles don't get cut off during hover */
            overflow-y: visible;
            /* Hide scrollbar while maintaining functionality */
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* Internet Explorer and Edge */
        }

        /* Hide scrollbar for WebKit browsers */
        .categories-grid::-webkit-scrollbar {
            display: none;
        }

        .category-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 100px;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            /* Add margin to prevent clipping during hover */
            margin: 10px 0;
        }

        .category-card:hover {
            transform: translateY(-8px);
        }

        .category-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .category-card:hover .category-circle {
            transform: scale(1.05);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }

        /* Elegant pastel backgrounds for different categories */
        .category-circle.rose {
            background: linear-gradient(135deg, #fce7f3 0%, #f3e8ff 100%);
        }

        .category-circle.citrus {
            background: linear-gradient(135deg, #fefce8 0%, #ecfdf5 100%);
        }

        .category-circle.floral {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }

        .category-circle.ocean {
            background: linear-gradient(135deg, #eff6ff 0%, #e0f2fe 100%);
        }

        .category-circle.earth {
            background: linear-gradient(135deg, #fef7ed 0%, #fdf4ff 100%);
        }

        .category-circle.sunset {
            background: linear-gradient(135deg, #fff7ed 0%, #fef3c7 100%);
        }

        .category-icon {
            font-size: 32px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
            transition: transform 0.2s ease;
        }

        .category-card:hover .category-icon {
            transform: scale(1.1);
        }

        .category-name {
            font-weight: 600;
            color: #374151;
            font-size: 14px;
            text-align: center;
            line-height: 1.2;
            letter-spacing: 0.025em;
        }

        /* Responsive adjustments */
        @media (max-width: 375px) {
            .categories-grid {
                gap: 20px;
                padding: 0 15px;
            }
            
            .category-circle {
                width: 70px;
                height: 70px;
            }
            
            .category-icon {
                font-size: 28px;
            }
            
            .category-name {
                font-size: 13px;
            }
        }

        /* Product Cards */
        .products-horizontal {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding-bottom: 10px;
            -webkit-overflow-scrolling: touch;
        }

        .products-horizontal::-webkit-scrollbar {
            display: none;
        }

        .product-card {
            flex: 0 0 115px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.2s;
            cursor: pointer;
        }

        /* Responsive product cards - show more on larger screens */
        @media (min-width: 480px) {
            .product-card {
                flex: 0 0 140px;
            }
            .product-image {
                height: 120px;
            }
        }

        @media (min-width: 768px) {
            .product-card {
                flex: 0 0 160px;
            }
            .product-image {
                height: 140px;
            }
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .product-image {
            width: 100%;
            height: 100px;
            background: #f3f4f6;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .sale-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: #ef4444;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .product-info {
            padding: 12px;
        }

        .product-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: #1f2937;
            font-size: 14px;
            line-height: 1.4;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 105px;
        }

        .product-vendor {
            color: #6b7280;
            font-size: 12px;
            margin-bottom: 8px;
        }

        .product-price {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .current-price {
            font-weight: 700;
            color: #2563EB;
        }

        .original-price {
            color: #9ca3af;
            text-decoration: line-through;
            font-size: 12px;
        }

        .add-to-cart-btn {
            width: 100%;
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            margin-top: 10px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .add-to-cart-btn:hover {
            background: #1d4ed8;
        }

        /* Enhanced Product Cards for New Arrivals */
        .enhanced-product-card {
            flex: 0 0 280px;
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            cursor: pointer;
            margin-right: 16px;
        }

        .enhanced-product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.12);
        }

        .enhanced-product-image-container {
            position: relative;
            height: 200px;
            overflow: hidden;
        }

        .enhanced-product-image {
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            transition: transform 0.3s ease;
        }

        .enhanced-product-card:hover .enhanced-product-image {
            transform: scale(1.05);
        }

        .image-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.9);
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            color: #1f2937;
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 3;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .enhanced-product-card:hover .image-nav {
            opacity: 1;
        }

        .image-nav:hover {
            background: white;
            transform: translateY(-50%) scale(1.1);
        }

        .image-nav.prev {
            left: 8px;
        }

        .image-nav.next {
            right: 8px;
        }

        .enhanced-sale-badge {
            position: absolute;
            top: 12px;
            left: 12px;
            background: #ef4444;
            color: white;
            padding: 6px 10px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            z-index: 2;
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
        }

        .image-dots {
            position: absolute;
            bottom: 12px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 6px;
            z-index: 2;
        }

        .image-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .image-dot.active {
            background: white;
            transform: scale(1.2);
        }

        .enhanced-product-info {
            padding: 20px;
        }

        .enhanced-product-title {
            font-weight: 600;
            margin-bottom: 6px;
            color: #1f2937;
            font-size: 16px;
            line-height: 1.4;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 120px;
        }

        .enhanced-product-description {
            color: #6b7280;
            font-size: 14px;
            margin-bottom: 12px;
            line-height: 1.4;
            word-wrap: break-word;
            overflow-wrap: break-word;
            white-space: normal;
            display: block;
            width: 100%;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 4px;
            margin-bottom: 12px;
        }

        .star-rating {
            display: flex;
            gap: 2px;
        }

        .star {
            color: #fbbf24;
            font-size: 14px;
        }

        .star.empty {
            color: #e5e7eb;
        }

        .rating-text {
            font-size: 12px;
            color: #6b7280;
            margin-left: 4px;
        }

        .enhanced-product-price {
            margin-bottom: 16px;
        }

        .price-label {
            color: #6b7280;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .enhanced-current-price {
            font-weight: 700;
            color: #1f2937;
            font-size: 18px;
        }

        .enhanced-original-price {
            color: #9ca3af;
            text-decoration: line-through;
            font-size: 14px;
            margin-left: 8px;
        }

        .enhanced-product-actions {
            display: flex;
            gap: 8px;
        }

        .enhanced-add-to-cart-btn {
            flex: 1;
            background: #1f2937;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .enhanced-add-to-cart-btn:hover {
            background: #111827;
            transform: translateY(-1px);
        }

        .select-size-btn {
            flex: 1;
            background: transparent;
            color: #1f2937;
            border: 2px solid #e5e7eb;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .select-size-btn:hover {
            border-color: #1f2937;
            background: #f9fafb;
        }

        /* Update products horizontal for enhanced cards */
        .products-horizontal.enhanced {
            gap: 0;
        }

        /* View All Button */
        .view-all-btn {
            display: block;
            width: 100%;
            background: transparent;
            color: #2563EB;
            border: 2px solid #2563EB;
            padding: 12px;
            border-radius: 8px;
            font-weight: 600;
            margin-top: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .view-all-btn:hover {
            background: #2563EB;
            color: white;
        }

        /* Best Sellers Grid Styles */
        .see-all-btn {
            background: none;
            border: none;
            color: #666;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            padding: 0;
            transition: color 0.2s;
        }

        .see-all-btn:hover {
            color: #333;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            padding: 0 15px;
            margin-bottom: 20px;
        }

        @media (max-width: 480px) {
            .products-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .grid-product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .grid-product-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        }

        .grid-product-image {
            width: 100%;
            height: 120px;
            background: #f3f4f6;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .grid-product-info {
            padding: 12px;
            text-align: center;
        }

        .grid-product-title {
            font-size: 14px;
            font-weight: 500;
            color: #333;
            margin: 0;
            line-height: 1.3;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 105px;
        }

        .grid-product-price {
            font-size: 14px;
            font-weight: 600;
            color: #667eea;
            margin: 4px 0 0 0;
        }

        /* Footer */
        .footer {
            background: #1f2937;
            color: white;
            padding: 30px 20px 100px 20px;
            margin-top: 40px;
        }

        .footer-content {
            text-align: center;
        }

        .footer-logo {
            margin-bottom: 15px;
            text-align: center;
        }

        .footer-logo img {
            height: 40px;
            width: auto;
            object-fit: contain;
        }

        .footer-description {
            color: #9ca3af;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .footer-link {
            color: #d1d5db;
            text-decoration: none;
            font-size: 14px;
            transition: color 0.2s;
        }

        .footer-link:hover {
            color: #2563EB;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .social-link {
            color: #9ca3af;
            font-size: 20px;
            transition: color 0.2s;
        }

        .social-link:hover {
            color: #2563EB;
        }

        .footer-copyright {
            color: #6b7280;
            font-size: 12px;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            z-index: 9999;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 375px;
            background: white;
            border-top: 1px solid #e5e7eb;
            display: flex;
            padding: 10px 0;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
        }

        .nav-item {
            flex: 1;
            text-align: center;
            padding: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .nav-item.active {
            color: #2563EB;
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .nav-label {
            font-size: 12px;
            font-weight: 500;
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #2563EB;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Animations */
        @keyframes slideDown {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes cartBadgePulse {
            0% { transform: scale(0.9); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }



        /* Responsive Design */
        @media (max-width: 375px) {
            .mobile-container {
                max-width: 100vw;
            }
            
            .bottom-nav {
                width: 100vw;
            }
            
            .announcement-bar {
                padding: 12px 60px;
                min-height: 55px;
            }
            
            .announcement-text-content {
                font-size: 14px !important;
            }
            
            .announcement-nav {
                width: 30px;
                height: 30px;
                font-size: 12px;
            }
            
            .announcement-nav.prev {
                left: 10px;
            }
            
            .announcement-nav.next {
                right: 10px;
            }
        }
        
                 @media (max-width: 320px) {
             .announcement-bar {
                 padding: 10px 50px;
                 min-height: 50px;
             }
             
             .announcement-text-content {
                 font-size: 13px !important;
             }
             
             .announcement-nav {
                 width: 26px;
                 height: 26px;
                 font-size: 11px;
             }
             
             .announcement-nav.prev {
                 left: 8px;
             }
             
             .announcement-nav.next {
                 right: 8px;
             }
         }

        /* Search Modal */
        .search-modal {
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 375px;
            height: 100vh;
            background: white;
            z-index: 1000;
            display: none;
            flex-direction: column;
            box-shadow: 0 0 50px rgba(0,0,0,0.3);
        }

        .search-modal.active {
            display: flex;
            animation: slideInFromTop 0.3s ease-out;
        }

        @keyframes slideInFromTop {
            from { transform: translateX(-50%) translateY(-100%); }
            to { transform: translateX(-50%) translateY(0); }
        }

        .search-header {
            background: #2563EB;
            color: white;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .search-close {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background 0.2s;
        }

        .search-close:hover {
            background: rgba(255,255,255,0.2);
        }

        .search-input-container {
            flex: 1;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 12px 40px 12px 15px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            background: rgba(255,255,255,0.9);
            color: #1f2937;
            outline: none;
        }

        .search-input::placeholder {
            color: #6b7280;
        }

        .search-clear {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #6b7280;
            font-size: 18px;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            display: none;
        }

        .search-clear.visible {
            display: block;
        }

        .search-content {
            flex: 1;
            overflow-y: auto;
            background: #f8fafc;
        }

        .search-suggestions {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            padding: 15px 20px;
            display: none;
        }

        .search-suggestions.visible {
            display: block;
        }

        .search-suggestion {
            padding: 10px 0;
            color: #6b7280;
            font-size: 14px;
            cursor: pointer;
            transition: color 0.2s;
            border-bottom: 1px solid #f3f4f6;
        }

        .search-suggestion:last-child {
            border-bottom: none;
        }

        .search-suggestion:hover {
            color: #2563EB;
        }

        .search-results {
            padding: 20px;
        }

        .search-results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e5e7eb;
        }

        .search-results-count {
            font-weight: 600;
            color: #1f2937;
        }

        .search-results-sort {
            padding: 6px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 12px;
            background: white;
            color: #6b7280;
            cursor: pointer;
        }

        .search-product-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            display: flex;
            gap: 15px;
        }

        .search-product-card:hover, .search-product-card:focus {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            outline: none;
        }

        .search-product-card:focus {
            border: 2px solid #2563EB;
        }

        .search-product-image {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            background: #f3f4f6;
            background-size: cover;
            background-position: center;
            flex-shrink: 0;
        }

        .search-product-info {
            flex: 1;
            min-width: 0;
        }

        .search-product-title {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 5px;
            font-size: 14px;
            line-height: 1.4;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 105px;
        }

        .search-product-vendor {
            color: #6b7280;
            font-size: 12px;
            margin-bottom: 8px;
        }

        .search-product-price {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        .search-product-current-price {
            font-weight: 700;
            color: #2563EB;
            font-size: 16px;
        }

        .search-product-original-price {
            color: #9ca3af;
            text-decoration: line-through;
            font-size: 12px;
        }

        .search-product-sale-badge {
            background: #ef4444;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
        }

        /* Product Detail Page Price Styles */
        .product-detail-price-container {
            display: flex;
            flex-direction: column;
            gap: 4px;
            margin: 16px 0;
        }

        .product-detail-current-price {
            font-size: 24px;
            font-weight: 700;
            color: #2563EB;
        }

        .product-detail-original-price {
            color: #9ca3af;
            text-decoration: line-through;
            font-size: 18px;
            font-weight: 500;
        }

        .product-detail-sale-badge {
            background: #ef4444;
            color: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            width: fit-content;
            margin-top: 4px;
        }

        .product-detail-price-row {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .search-product-add-cart {
            background: #2563EB;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }

        .search-product-add-cart:hover {
            background: #1d4ed8;
        }

        .search-empty {
            text-align: center;
            padding: 40px 20px;
            color: #6b7280;
        }

        .search-empty-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .search-loading {
            text-align: center;
            padding: 40px 20px;
            color: #6b7280;
        }

        .search-spinner {
            display: inline-block;
            width: 30px;
            height: 30px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #2563EB;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }

        /* Search Modal Responsive */
        @media (max-width: 375px) {
            .search-modal {
                width: 100vw;
            }
            
            .search-product-card {
                padding: 12px;
            }
            
            .search-product-image {
                width: 70px;
                height: 70px;
            }
            
            .search-product-title {
                font-size: 13px;
            }
        }

        @media (max-width: 320px) {
            .search-header {
                padding: 12px 15px;
            }
            
            .search-input {
                font-size: 14px;
                padding: 10px 35px 10px 12px;
            }
            
            .search-results {
                padding: 15px;
            }
            
            .search-product-image {
                width: 60px;
                height: 60px;
            }
        }

        /* Menu Overlay and Animations */
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0);
            z-index: 200;
            display: none;
            transition: background 0.3s ease;
        }

        .menu-overlay.active {
            display: block;
            background: rgba(0, 0, 0, 0.5);
            animation: overlayFadeIn 0.3s ease-out;
        }

        .slide-menu {
            position: fixed;
            top: 0;
            left: -300px;
            width: 280px;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 300;
            transition: left 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 2px 0 20px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
        }

        .slide-menu.active {
            left: 0;
        }

        .menu-header {
            background: rgba(255,255,255,0.1);
            padding: 25px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            position: relative;
        }

        .menu-header h3 {
            color: white;
            font-size: 22px;
            font-weight: 700;
            margin: 0;
            opacity: 0;
            transform: translateX(-20px);
            animation: menuHeaderSlide 0.6s ease-out 0.2s forwards;
        }

        .menu-header p {
            color: rgba(255,255,255,0.8);
            font-size: 14px;
            margin: 5px 0 0 0;
            opacity: 0;
            transform: translateX(-20px);
            animation: menuHeaderSlide 0.6s ease-out 0.3s forwards;
        }

        .menu-items {
            flex: 1;
            padding: 20px 0;
            overflow-y: auto;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 18px 25px;
            color: white;
            text-decoration: none;
            font-weight: 500;
            font-size: 16px;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            opacity: 0;
            transform: translateX(-30px);
            position: relative;
            overflow: hidden;
        }

        .menu-item:nth-child(1) { animation: menuItemSlide 0.5s ease-out 0.1s forwards; }
        .menu-item:nth-child(2) { animation: menuItemSlide 0.5s ease-out 0.2s forwards; }
        .menu-item:nth-child(3) { animation: menuItemSlide 0.5s ease-out 0.3s forwards; }
        .menu-item:nth-child(4) { animation: menuItemSlide 0.5s ease-out 0.4s forwards; }
        .menu-item:nth-child(5) { animation: menuItemSlide 0.5s ease-out 0.5s forwards; }
        .menu-item:nth-child(6) { animation: menuItemSlide 0.5s ease-out 0.6s forwards; }

        .menu-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 0;
            background: rgba(255,255,255,0.1);
            transition: width 0.3s ease;
            z-index: -1;
        }

        .menu-item:hover::before {
            width: 100%;
        }

        .menu-item:hover {
            background: rgba(255,255,255,0.1);
            border-left-color: rgba(255,255,255,0.8);
            transform: translateX(5px);
        }

        .menu-item-icon {
            font-size: 20px;
            margin-right: 15px;
            min-width: 25px;
            transition: transform 0.3s ease;
        }

        .menu-item:hover .menu-item-icon {
            transform: scale(1.2) rotate(5deg);
        }

        .menu-footer {
            padding: 20px 25px;
            border-top: 1px solid rgba(255,255,255,0.2);
            background: rgba(0,0,0,0.1);
        }

        .menu-footer-content {
            text-align: center;
            color: rgba(255,255,255,0.7);
            font-size: 12px;
            opacity: 0;
            transform: translateY(20px);
            animation: menuFooterSlide 0.6s ease-out 0.7s forwards;
        }

        /* Hamburger Animation */
        .hamburger-menu.active svg {
            transform: rotate(90deg);
            opacity: 0;
        }

        .hamburger-menu::after {
            content: '×';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-90deg);
            font-size: 24px;
            color: currentColor;
            opacity: 0;
            transition: all 0.3s ease;
            pointer-events: none;
            font-weight: 300;
        }

        .hamburger-menu.active::after {
            transform: translate(-50%, -50%) rotate(0deg);
            opacity: 1;
        }

        /* Keyframe Animations */
        @keyframes overlayFadeIn {
            from { 
                background: rgba(0, 0, 0, 0);
            }
            to { 
                background: rgba(0, 0, 0, 0.5);
            }
        }

        @keyframes menuHeaderSlide {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes menuItemSlide {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes menuFooterSlide {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes menuItemPulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        .menu-item:active {
            animation: menuItemPulse 0.2s ease;
        }

        /* Close button animation */
        .menu-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            opacity: 0;
            transform: rotate(-90deg) scale(0.5);
            animation: closeButtonAppear 0.5s ease-out 0.4s forwards;
        }

        .menu-close:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(0deg) scale(1.1);
        }

        @keyframes closeButtonAppear {
            to {
                opacity: 1;
                transform: rotate(0deg) scale(1);
            }
        }

        /* Menu item special effects */
        .menu-item-special {
            background: linear-gradient(45deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            border-radius: 8px;
            margin: 5px 15px;
            border-left: 3px solid #FFD700 !important;
        }

        .menu-item-special::after {
            content: '✨';
            margin-left: auto;
            font-size: 16px;
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            .mobile-container {
                background: #111827;
                color: #f9fafb;
            }
        }
    </style>
</head>
<body>
    <!-- Splash Screen -->
    <div id="splashScreen" class="splash-screen">
        <div class="splash-content">
            <div class="splash-logo">
                <img src="https://cdn.shopify.com/s/files/1/0583/8831/6208/files/logo_eyejack-min_c2486715-1e14-494b-b255-e3e66d994c5d.png?v=1704799849" alt="EyeJack" class="splash-logo-img" onerror="this.style.display='none'; this.parentElement.innerHTML='&lt;div style=&quot;color:white;font-size:24px;font-weight:700;&quot;&gt;EyeJack&lt;/div&gt;';">
            </div>
            <div class="splash-loading">
                <div class="loading-spinner"></div>
                <p class="loading-text">Loading your shopping experience...</p>
            </div>
        </div>
    </div>

    <div class="mobile-container">


        <!-- Announcement Bar -->
        <div class="announcement-bar" id="announcementBar">
            <button class="announcement-nav prev" onclick="event.stopPropagation(); event.preventDefault(); previousAnnouncement();">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="0.5">
                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                </svg>
            </button>
            <div class="announcement-text">
                <div class="announcement-text-content">Free shipping on orders ₹50+</div>
            </div>
            <button class="announcement-nav next" onclick="event.stopPropagation(); event.preventDefault(); nextAnnouncement();">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                </svg>
            </button>
        </div>

        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <div class="hamburger-menu" onclick="toggleMenu()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </div>
                <div class="search-icon" onclick="showSearch()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                </div>
            </div>
            
            <div class="header-center">
                <div class="logo">
                    <img src="https://cdn.shopify.com/s/files/1/0583/8831/6208/files/logo_eyejack-min_c2486715-1e14-494b-b255-e3e66d994c5d.png?v=1704799849" alt="EyeJack" id="logoImage" onerror="this.style.display='none'; this.parentElement.innerHTML='&lt;span class=&quot;logo-text&quot;&gt;EyeJack&lt;/span&gt;';">
                </div>
            </div>
            
            <div class="header-right">
                <div class="profile-icon" onclick="showProfile()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </div>
                <div class="cart-container" onclick="showCart()">
                    <svg class="cart-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M6 2L3 6V20C3 21.1 3.9 22 5 22H19C20.1 22 21 21.1 21 20V6L18 2H6Z" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M9 6V10C9 11.1 9.9 12 11 12H13C14.1 12 15 11.1 15 10V6" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <div class="cart-badge" id="cartBadge">0</div>
                </div>
            </div>
        </div>

        <!-- Hero Slider -->
        <div class="hero-slider" id="heroSlider">
            <div class="hero-slide active" style="background-image: url('https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=800&h=400&fit=crop')">
                <div class="hero-content">
                    <h2 class="hero-title">Live Rendering</h2>
                    <p class="hero-subtitle">Experience real-time app updates!</p>
                    <button class="hero-btn" onclick="exploreProducts()">Explore Now</button>
                </div>
            </div>
            <div class="hero-slide" style="background-image: url('https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=800&h=400&fit=crop')">
                <div class="hero-content">
                    <h2 class="hero-title">Shop Collections</h2>
                    <p class="hero-subtitle">Discover our curated selections</p>
                    <button class="hero-btn" onclick="showCollections()">Shop Now</button>
                </div>
            </div>
            <div class="hero-slide" style="background-image: url('https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=800&h=400&fit=crop')">
                <div class="hero-content">
                    <h2 class="hero-title">Best Sellers</h2>
                    <p class="hero-subtitle">Top-rated by customers</p>
                    <button class="hero-btn" onclick="showBestSellers()">View All</button>
                </div>
            </div>
            <div class="slider-indicators">
                <div class="indicator active" onclick="changeSlide(0)"></div>
                <div class="indicator" onclick="changeSlide(1)"></div>
                <div class="indicator" onclick="changeSlide(2)"></div>
            </div>
        </div>

        <!-- Best Sellers Horizontal -->
        <div class="section fade-in" id="bestSellersSection">
            <div class="section-header">
                <h2 class="section-title" id="bestSellersTitle">Best Sellers</h2>
                <button class="see-all-btn" id="bestSellersSeeAll" onclick="showAllBestSellers()">See all</button>
            </div>
            <div class="products-horizontal" id="bestSellersHorizontal">
                <div class="loading" id="bestSellersHorizontalLoading">Loading best sellers...</div>
            </div>
        </div>

        <!-- Shop by Category -->
        <div class="section fade-in">
            <div class="section-header">
                <h2 class="section-title">Shop by Category</h2>
                <p class="section-subtitle">Explore our collection</p>
            </div>
            <div class="categories-grid" id="categoriesGrid">
                <div class="category-card" onclick="showCategory('beauty')">
                    <div class="category-circle rose">
                        <div class="category-icon">🌹</div>
                </div>
                    <div class="category-name">Beauty</div>
                </div>
                <div class="category-card" onclick="showCategory('wellness')">
                    <div class="category-circle citrus">
                        <div class="category-icon">🍋</div>
                </div>
                    <div class="category-name">Wellness</div>
                </div>
                <div class="category-card" onclick="showCategory('lifestyle')">
                    <div class="category-circle floral">
                        <div class="category-icon">🌸</div>
                    </div>
                    <div class="category-name">Lifestyle</div>
                </div>
                <div class="category-card" onclick="showCategory('skincare')">
                    <div class="category-circle ocean">
                        <div class="category-icon">💧</div>
                    </div>
                    <div class="category-name">Skincare</div>
                </div>
            </div>
            <button class="view-all-btn" onclick="showAllCategories()">View All Categories</button>
        </div>

        <!-- New Arrivals -->
        <div class="section fade-in">
            <div class="section-header">
                <h2 class="section-title">✨ New Arrivals</h2>
                <p class="section-subtitle">Check out our latest products</p>
            </div>
            <div class="products-horizontal enhanced" id="newArrivals">
                <div class="loading" id="newArrivalsLoading"></div>
            </div>
            <button class="view-all-btn" onclick="showAllNewArrivals()">View All New Arrivals</button>
        </div>



        <!-- Footer -->
        <div class="footer">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="https://cdn.shopify.com/s/files/1/0583/8831/6208/files/logo_eyejack-min_c2486715-1e14-494b-b255-e3e66d994c5d.png?v=1704799849" alt="EyeJack Logo" />
                </div>
                <p class="footer-description">
                    Your premier mobile shopping experience with live rendering technology. 
                    Shop the latest trends with real-time app updates.
                </p>
                <div class="footer-links">
                    <a href="#" class="footer-link">About Us</a>
                    <a href="#" class="footer-link">Contact</a>
                    <a href="#" class="footer-link">Privacy</a>
                    <a href="#" class="footer-link">Terms</a>
                </div>
                <div class="social-links">
                    <a href="#" class="social-link"><i class="fab fa-facebook"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-linkedin"></i></a>
                </div>
                <p class="footer-copyright">© 2024 Eyejack. All rights reserved.</p>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <div class="nav-item active" onclick="setActiveNav(0, 'home')">
                <div class="nav-icon"><i class="fas fa-home"></i></div>
                <div class="nav-label">Home</div>
            </div>
            <div class="nav-item" onclick="setActiveNav(1, 'search')">
                <div class="nav-icon"><i class="fas fa-search"></i></div>
                <div class="nav-label">Search</div>
            </div>
            <div class="nav-item" onclick="setActiveNav(2, 'cart')">
                <div class="nav-icon"><i class="fas fa-shopping-cart"></i></div>
                <div class="nav-label">Cart</div>
            </div>
            <div class="nav-item" onclick="setActiveNav(3, 'profile')">
                <div class="nav-icon"><i class="fas fa-user"></i></div>
                <div class="nav-label">Profile</div>
            </div>
        </div>
    </div>

    <!-- Menu Overlay -->
    <div class="menu-overlay" id="menuOverlay" onclick="closeMenu()"></div>

    <!-- Slide Menu -->
    <div class="slide-menu" id="slideMenu">
        <div class="menu-header">
            <button class="menu-close" onclick="closeMenu()">×</button>
            <h3>🚀 EyeJack Menu</h3>
            <p>Discover amazing AR shopping experiences</p>
        </div>
        
        <div class="menu-items">
            <a href="#" class="menu-item" onclick="menuItemClick('home')">
                <span class="menu-item-icon">🏠</span>
                Home
            </a>
            <a href="#" class="menu-item menu-item-special" onclick="menuItemClick('collections')">
                <span class="menu-item-icon">📂</span>
                Collections
            </a>
            <a href="#" class="menu-item" onclick="menuItemClick('products')">
                <span class="menu-item-icon">🛍️</span>
                All Products
            </a>
            <a href="#" class="menu-item" onclick="menuItemClick('categories')">
                <span class="menu-item-icon">📱</span>
                Categories
            </a>
            <a href="#" class="menu-item" onclick="menuItemClick('deals')">
                <span class="menu-item-icon">🎯</span>
                Deals & Offers
            </a>
            <a href="#" class="menu-item" onclick="menuItemClick('support')">
                <span class="menu-item-icon">💬</span>
                Customer Support
            </a>
        </div>
        
        <div class="menu-footer">
            <div class="menu-footer-content">
                <div style="font-weight: 600; margin-bottom: 5px;">EyeJack AR Shopping</div>
                <div>Experience the future of retail</div>
                <div style="margin-top: 10px; font-size: 10px;">Version 1.0.0</div>
            </div>
        </div>
    </div>

    <!-- Search Modal -->
    <div class="search-modal" id="searchModal">
        <div class="search-header">
            <button class="search-close" onclick="closeSearchModal()">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            <div class="search-input-container">
                <input 
                    type="text" 
                    class="search-input" 
                    id="searchInput"
                    placeholder="Search products..." 
                    autocomplete="off"
                />
                <button class="search-clear" id="searchClear" onclick="clearSearch()">×</button>
            </div>
        </div>
        
        <div class="search-content">
            <!-- Search Suggestions -->
            <div class="search-suggestions" id="searchSuggestions">
                <div class="search-suggestion" onclick="performSearch('sunglasses')">🕶️ Sunglasses</div>
                <div class="search-suggestion" onclick="performSearch('sonic')">🎵 Sonic</div>
                <div class="search-suggestion" onclick="performSearch('brown')">🤎 Brown</div>
                <div class="search-suggestion" onclick="performSearch('round')">⭕ Round</div>
            </div>
            
            <!-- Search Results -->
            <div class="search-results" id="searchResults" style="display: none;">
                <div class="search-results-header">
                    <div class="search-results-count" id="searchResultsCount">0 results</div>
                    <select class="search-results-sort" id="searchSort" onchange="sortSearchResults()">
                        <option value="relevance">Most Relevant</option>
                        <option value="price_low">Price: Low to High</option>
                        <option value="price_high">Price: High to Low</option>
                        <option value="title">A-Z</option>
                    </select>
                </div>
                <div id="searchResultsList"></div>
            </div>
            
            <!-- Search Loading -->
            <div class="search-loading" id="searchLoading" style="display: none;">
                <div class="search-spinner"></div>
                <div>Searching products...</div>
            </div>
            
            <!-- Search Empty State -->
            <div class="search-empty" id="searchEmpty" style="display: none;">
                <div class="search-empty-icon">🔍</div>
                <div style="font-weight: 600; margin-bottom: 8px;">No products found</div>
                <div>Try different keywords or check the spelling</div>
            </div>
        </div>
    </div>

    <!-- Authentication Modal -->
    <div id="authModal" class="auth-modal">
        <div class="auth-modal-content">
            <div class="auth-header">
                <h2 class="auth-title">Welcome to EyeJack</h2>
                <button class="auth-close" onclick="closeAuthModal()">&times;</button>
            </div>
            
            <div class="auth-body">
                <!-- Login Options -->
                <div id="authOptions" class="auth-screen">
                    <div class="auth-welcome">
                        <p>Sign in to access your account, orders, and personalized shopping experience.</p>
                    </div>
                    
                    <!-- Social Login Buttons -->
                    <div class="social-login-buttons">
                        <button class="social-btn google-btn" onclick="signInWithGoogle()">
                            <i class="fab fa-google"></i>
                            Continue with Google
                        </button>
                        
                        <button class="social-btn facebook-btn" onclick="signInWithFacebook()">
                            <i class="fab fa-facebook-f"></i>
                            Continue with Facebook
                        </button>
                        
                        <button class="social-btn apple-btn" onclick="signInWithApple()">
                            <i class="fab fa-apple"></i>
                            Continue with Apple
                        </button>
                    </div>
                    
                    <div class="auth-divider">
                        <span>or</span>
                    </div>
                    
                    <!-- Phone Login -->
                    <button class="phone-login-btn" onclick="showPhoneLogin()">
                        <i class="fas fa-phone"></i>
                        Continue with Phone
                    </button>
                </div>
                
                <!-- Phone Login Screen -->
                <div id="phoneLoginScreen" class="auth-screen" style="display: none;">
                    <div class="phone-login">
                        <h3>Enter your phone number</h3>
                        <p>We'll send you a verification code</p>
                        
                        <div class="phone-input-group">
                            <select id="countryCode" class="country-code">
                                <option value="+1">🇺🇸 +1</option>
                                <option value="+91">🇮🇳 +91</option>
                                <option value="+44">🇬🇧 +44</option>
                                <option value="+86">🇨🇳 +86</option>
                                <option value="+81">🇯🇵 +81</option>
                                <option value="+49">🇩🇪 +49</option>
                                <option value="+33">🇫🇷 +33</option>
                            </select>
                            <input type="tel" id="phoneNumber" placeholder="Phone number" class="phone-input">
                        </div>
                        
                        <button class="auth-submit-btn" onclick="sendOTP()">
                            <span id="otpBtnText">Send Code</span>
                            <div id="otpBtnLoader" class="btn-loader" style="display: none;"></div>
                        </button>
                        
                        <button class="auth-back-btn" onclick="showAuthOptions()">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                    </div>
                </div>
                
                <!-- OTP Verification Screen -->
                <div id="otpVerificationScreen" class="auth-screen" style="display: none;">
                    <div class="otp-verification">
                        <h3>Enter verification code</h3>
                        <p id="otpSentMessage">Code sent to your phone number</p>
                        
                        <div class="otp-input-group">
                            <input type="text" maxlength="1" class="otp-digit" oninput="moveToNext(this, 0)">
                            <input type="text" maxlength="1" class="otp-digit" oninput="moveToNext(this, 1)">
                            <input type="text" maxlength="1" class="otp-digit" oninput="moveToNext(this, 2)">
                            <input type="text" maxlength="1" class="otp-digit" oninput="moveToNext(this, 3)">
                            <input type="text" maxlength="1" class="otp-digit" oninput="moveToNext(this, 4)">
                            <input type="text" maxlength="1" class="otp-digit" oninput="moveToNext(this, 5)">
                        </div>
                        
                        <button class="auth-submit-btn" onclick="verifyOTP()">
                            <span id="verifyBtnText">Verify</span>
                            <div id="verifyBtnLoader" class="btn-loader" style="display: none;"></div>
                        </button>
                        
                        <button class="resend-btn" onclick="resendOTP()">
                            Didn't receive code? <span class="resend-text">Resend</span>
                        </button>
                        
                        <button class="auth-back-btn" onclick="showPhoneLogin()">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                    </div>
                </div>
                
                <!-- Loading Screen -->
                <div id="authLoadingScreen" class="auth-screen" style="display: none;">
                    <div class="auth-loading">
                        <div class="loading-spinner-large"></div>
                        <h3>Setting up your account...</h3>
                        <p>Please wait while we create your shopping profile</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Modal -->
    <div id="cartModal" class="feature-modal">
        <div class="modal-backdrop" onclick="closeCartModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-shopping-cart"></i> Shopping Cart</h3>
                <button class="cart-close-btn" onclick="closeCartModal()">
                    <div class="close-icon">
                        <span></span>
                        <span></span>
                    </div>
                </button>
            </div>
            <div class="modal-body">
                <div id="cartContent">
                    <!-- Cart items will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Drawer -->
    <div id="profileDrawer" class="profile-drawer">
        <div class="profile-drawer-content">
            <!-- Header -->
            <div class="profile-header">
                <button class="profile-back-btn" onclick="closeProfileDrawer()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="profile-title">Profile</h2>
            </div>

            <!-- Profile Content -->
            <div class="profile-body">
                <!-- Your Account Section -->
                <div class="profile-section">
                    <h3 class="profile-section-title">Your account</h3>
                    <div class="account-info">
                        <i class="fas fa-phone profile-phone-icon"></i>
                        <span class="account-email" id="userEmail">aceoptical@eyejack.in</span>
                    </div>
                </div>

                <!-- Birthday Section -->
                <div class="birthday-section" onclick="openBirthdayModal()" style="cursor: pointer;">
                    <div class="birthday-content">
                        <div class="birthday-text">
                            <h4 id="birthdayTitle">Your birthday</h4>
                            <span class="birthday-subtitle" id="birthdaySubtitle">July 30</span>
                        </div>
                        <div class="birthday-icon">🎂</div>
                    </div>
                </div>

                <!-- Action Cards -->
                <div class="action-cards">
                    <div class="action-card" onclick="showEyeJackMoney()">
                        <div class="action-card-icon wallet">
                            <i class="fas fa-wallet"></i>
                        </div>
                        <div class="action-card-content">
                            <h4 class="action-card-title">EyeJack Money</h4>
                        </div>
                    </div>
                    
                    <div class="action-card" onclick="showSupport()">
                        <div class="action-card-icon support">
                            <i class="fas fa-headset"></i>
                        </div>
                        <div class="action-card-content">
                            <h4 class="action-card-title">Support</h4>
                        </div>
                    </div>
                    
                    <div class="action-card" onclick="showPayments()">
                        <div class="action-card-icon payments">
                            <i class="fas fa-credit-card"></i>
                        </div>
                        <div class="action-card-content">
                            <h4 class="action-card-title">Payments</h4>
                        </div>
                    </div>
                </div>

                <!-- App Update Notification -->
                <div class="update-notification">
                    <div class="update-content">
                        <i class="fas fa-sync-alt"></i>
                        <div class="update-text">
                            <span>App update available</span>
                        </div>
                        <div class="update-version">v1.0.0</div>
                        <i class="fas fa-chevron-right"></i>
                    </div>
                </div>

                <!-- Appearance Setting -->
                <div class="appearance-setting" onclick="openAppearanceModal()" style="cursor: pointer;">
                    <div class="appearance-content">
                        <i class="fas fa-palette"></i>
                        <span>Appearance</span>
                        <div class="appearance-toggle">
                            <span class="toggle-label" id="currentThemeLabel">LIGHT</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                    </div>
                </div>

                <!-- Your Information Section -->
                <div class="profile-section">
                    <h4 class="section-subtitle">YOUR INFORMATION</h4>
                    
                    <div class="info-menu">
                        <div class="info-item" onclick="showUserOrders()">
                            <i class="fas fa-shopping-bag"></i>
                            <span>Your orders</span>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                        
                        <div class="info-item" onclick="showUserWishlist()">
                            <i class="fas fa-heart"></i>
                            <span>Your wishlist</span>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                        
                        <div class="info-item" onclick="showBookmarkedRecipes()">
                            <i class="fas fa-bookmark"></i>
                            <span>Bookmarked recipes</span>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                        
                        <div class="info-item" onclick="showAddressBook()">
                            <i class="fas fa-address-book"></i>
                            <span>Address book</span>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                        
                        <div class="info-item" onclick="showGSTDetails()">
                            <i class="fas fa-file-invoice"></i>
                            <span>GST details</span>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                        
                        <div class="info-item" onclick="showGiftCards()">
                            <i class="fas fa-gift"></i>
                            <span>E-Gift Cards</span>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </div>
                </div>

                <!-- Sign Out Button -->
                <div class="profile-actions">
                    <button class="sign-out-btn" onclick="signOutUser()">
                        <i class="fas fa-sign-out-alt"></i>
                        Sign Out
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Birthday Modal -->
    <div id="birthdayModal" class="feature-modal">
        <div class="modal-backdrop" onclick="closeBirthdayModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-back-btn" onclick="closeBirthdayModal()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="modal-title">Add your birthday</h2>
                <button class="modal-action-btn" onclick="saveBirthday()">Save</button>
            </div>
            <div class="modal-body">
                <div class="birthday-form">
                    <div class="birthday-icon-large">🎂</div>
                    <p class="birthday-description">Help us celebrate your special day! Add your birthday to receive special offers.</p>
                    
                    <div class="birthday-input-group">
                        <label for="birthdayDate">Select your birthday</label>
                        <input type="date" id="birthdayDate" class="birthday-input">
                    </div>
                    
                    <div class="birthday-privacy">
                        <i class="fas fa-lock"></i>
                        <span>Your birthday information is kept private and secure</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Thank You Modal -->
    <div id="thankYouModal" class="feature-modal">
        <div class="modal-backdrop"></div>
        <div class="modal-content thank-you-content">
            <div class="thank-you-header">
                <div class="success-animation">
                    <div class="checkmark-circle">
                        <div class="checkmark"></div>
                    </div>
                </div>
                <h2 class="thank-you-title">Thank You!</h2>
                <p class="thank-you-subtitle">Your order has been placed successfully</p>
            </div>
            
            <div class="order-details-card">
                <div class="order-info-row">
                    <span class="order-label">Order Number:</span>
                    <span class="order-value" id="thankYouOrderNumber">#1003</span>
                </div>
                <div class="order-info-row">
                    <span class="order-label">Total Amount:</span>
                    <span class="order-value" id="thankYouOrderTotal">₹447.22</span>
                </div>
                <div class="order-info-row">
                    <span class="order-label">Email:</span>
                    <span class="order-value" id="thankYouOrderEmail">aceoptical@eyejack.in</span>
                </div>
                <div class="order-info-row">
                    <span class="order-label">Order Date:</span>
                    <span class="order-value" id="thankYouOrderDate">30 Jul 2025</span>
                </div>
            </div>

            <div class="delivery-info">
                <div class="delivery-icon">🚚</div>
                <div class="delivery-text">
                    <h4>Estimated Delivery</h4>
                    <p>Your order will be delivered within 5-7 business days</p>
                </div>
            </div>

            <div class="thank-you-actions">
                <button class="btn-secondary" onclick="closeThankYouModal()">Continue Shopping</button>
                <button class="btn-primary" onclick="viewOrderDetails()">View Order Details</button>
            </div>
        </div>
    </div>

    <!-- Track Order Modal -->
    <div id="trackOrderModal" class="feature-modal">
        <div class="modal-backdrop" onclick="closeTrackOrderModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-back-btn" onclick="closeTrackOrderModal()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="modal-title">Track Order</h2>
                <div style="width: 24px;"></div>
            </div>
            <div class="modal-body">
                <div class="track-order-form">
                    <div class="track-order-icon">
                        🚚
                    </div>
                    <p class="track-order-description">Enter your order number to track your shipment</p>
                    
                    <div class="form-group">
                        <label for="trackOrderNumber">Order Number</label>
                        <input type="text" id="trackOrderNumber" placeholder="e.g., #1004" class="track-order-input">
                    </div>
                    
                    <button class="btn-primary track-order-btn" onclick="trackOrderByNumber()">
                        <i class="fas fa-search"></i>
                        Track Order
                    </button>
                </div>
                
                <div id="trackingResults" class="tracking-results" style="display: none;">
                    <!-- Tracking results will be displayed here -->
                </div>
            </div>
        </div>
    </div>

    <!-- reCAPTCHA container for phone auth -->
    <div id="recaptcha-container"></div>

    <!-- Your Orders Modal -->
    <div id="ordersModal" class="feature-modal">
        <div class="modal-backdrop" onclick="closeOrdersModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-back-btn" onclick="closeOrdersModal()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="modal-title">Your Orders</h2>
            </div>
            <div class="modal-body">
                <div id="ordersContent" class="orders-content">
                    <div class="loading-state">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading your orders...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Your Wishlist Modal -->
    <div id="wishlistModal" class="feature-modal">
        <div class="modal-backdrop" onclick="closeWishlistModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-back-btn" onclick="closeWishlistModal()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="modal-title">Your Wishlist</h2>
                <button class="modal-action-btn" onclick="clearWishlist()">Clear All</button>
            </div>
            <div class="modal-body">
                <div id="wishlistContent" class="wishlist-content">
                    <div class="empty-state">
                        <i class="fas fa-heart"></i>
                        <h3>Your wishlist is empty</h3>
                        <p>Browse our products and add items to your wishlist</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bookmarked Recipes Modal -->
    <div id="recipesModal" class="feature-modal">
        <div class="modal-backdrop" onclick="closeRecipesModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-back-btn" onclick="closeRecipesModal()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="modal-title">Bookmarked Recipes</h2>
                <button class="modal-action-btn" onclick="addNewRecipe()">+ Add Recipe</button>
            </div>
            <div class="modal-body">
                <div id="recipesContent" class="recipes-content">
                    <div class="empty-state">
                        <i class="fas fa-bookmark"></i>
                        <h3>No bookmarked recipes</h3>
                        <p>Save your favorite beauty and skincare recipes here</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Address Book Modal -->
    <div id="addressModal" class="feature-modal">
        <div class="modal-backdrop" onclick="closeAddressModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-back-btn" onclick="closeAddressModal()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="modal-title">Address Book</h2>
                <button class="modal-action-btn" onclick="addNewAddress()">+ Add Address</button>
            </div>
            <div class="modal-body">
                <div id="addressContent" class="address-content">
                    <div class="empty-state">
                        <i class="fas fa-map-marker-alt"></i>
                        <h3>No saved addresses</h3>
                        <p>Add your delivery addresses for faster checkout</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- GST Details Modal -->
    <div id="gstModal" class="feature-modal">
        <div class="modal-backdrop" onclick="closeGSTModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-back-btn" onclick="closeGSTModal()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="modal-title">GST Details</h2>
                <button class="modal-action-btn" onclick="saveGSTDetails()">Save</button>
            </div>
            <div class="modal-body">
                <div id="gstContent" class="gst-content">
                    <form id="gstForm" class="gst-form">
                        <div class="form-group">
                            <label for="gstNumber">GST Number</label>
                            <input type="text" id="gstNumber" placeholder="Enter GST Number">
                        </div>
                        <div class="form-group">
                            <label for="businessName">Business Name</label>
                            <input type="text" id="businessName" placeholder="Enter Business Name">
                        </div>
                        <div class="form-group">
                            <label for="businessAddress">Business Address</label>
                            <textarea id="businessAddress" placeholder="Enter Complete Business Address"></textarea>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- E-Gift Cards Modal -->
    <div id="giftCardsModal" class="feature-modal">
        <div class="modal-backdrop" onclick="closeGiftCardsModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-back-btn" onclick="closeGiftCardsModal()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="modal-title">E-Gift Cards</h2>
                <button class="modal-action-btn" onclick="buyGiftCard()">Buy Gift Card</button>
            </div>
            <div class="modal-body">
                <div id="giftCardsContent" class="gift-cards-content">
                    <div class="empty-state">
                        <i class="fas fa-gift"></i>
                        <h3>No gift cards</h3>
                        <p>Purchase gift cards for yourself or loved ones</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Appearance Settings Modal -->
    <div id="appearanceModal" class="feature-modal">
        <div class="modal-backdrop" onclick="closeAppearanceModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-back-btn" onclick="closeAppearanceModal()">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h2 class="modal-title">Appearance</h2>
            </div>
            <div class="modal-body">
                <div class="appearance-options">
                    <div class="theme-option" onclick="setTheme('light')">
                        <div class="theme-preview light-preview">
                            <div class="preview-header"></div>
                            <div class="preview-content"></div>
                        </div>
                        <div class="theme-info">
                            <h3>Light Mode</h3>
                            <p>Clean and bright interface</p>
                        </div>
                        <div class="theme-radio">
                            <input type="radio" name="theme" value="light" id="lightTheme" checked>
                            <label for="lightTheme"></label>
                        </div>
                    </div>
                    <div class="theme-option" onclick="setTheme('dark')">
                        <div class="theme-preview dark-preview">
                            <div class="preview-header"></div>
                            <div class="preview-content"></div>
                        </div>
                        <div class="theme-info">
                            <h3>Dark Mode</h3>
                            <p>Easy on the eyes in low light</p>
                        </div>
                        <div class="theme-radio">
                            <input type="radio" name="theme" value="dark" id="darkTheme">
                            <label for="darkTheme"></label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Product Detail Modal -->
    <div id="productDetailModal" class="product-detail-overlay">
        <div class="product-detail-header">
            <button class="product-detail-back" onclick="closeProductDetail()">←</button>
            <button class="product-detail-share" onclick="shareProduct()">⊗</button>
        </div>
        
        <div class="product-detail-content">
            <div class="product-detail-image-container">
                <div id="productDetailImage" class="product-detail-image"></div>
                <div id="productDetailPlaceholder" class="product-detail-placeholder">📷</div>
            </div>
            
            <div class="product-detail-info">
                <div id="productDetailBrand" class="product-detail-brand">Olivesk</div>
                <h1 id="productDetailTitle" class="product-detail-title">Beauty Flower Dress</h1>
                <div id="productDetailPriceContainer" class="product-detail-price-container">
                    <div class="product-detail-price-row">
                        <div id="productDetailPrice" class="product-detail-current-price">₹299,00</div>
                        <div id="productDetailOriginalPrice" class="product-detail-original-price" style="display: none;"></div>
                    </div>
                    <div id="productDetailSaleBadge" class="product-detail-sale-badge" style="display: none;">SALE</div>
                </div>
                
                <div class="product-detail-rating">
                    <div class="rating-stars">
                        <span class="rating-star filled">★</span>
                        <span class="rating-star filled">★</span>
                        <span class="rating-star filled">★</span>
                        <span class="rating-star filled">★</span>
                        <span class="rating-star filled">★</span>
                        <span class="rating-value">5.0</span>
                    </div>
                    <div class="rating-details">
                        <span class="rating-count">3,2K Reviews</span>
                        <span class="sold-count">5,3K Sold</span>
                    </div>
                </div>
                
                <div class="product-detail-color">
                    <label class="color-label">Color</label>
                    <div class="color-options" id="productDetailColors">
                        <!-- Colors will be dynamically generated from product description -->
                    </div>
                </div>
                
                <div class="product-detail-description">
                    <h3>Description</h3>
                    <div id="productDetailDescription" class="description-text">
                        Very beautiful Dress with flared cut Using textured chiffon material, There is frilling on the sleeves and around the bottom of the dress.
                    </div>
                </div>
            </div>
        </div>
        
        <div class="product-detail-actions">
            <div class="cart-icon-container" onclick="showCart()">
                <div class="cart-icon-wrapper">
                    <svg class="cart-icon" style="color: black;" viewBox="0 0 24 24" fill="none">
                        <path d="M6 2L3 6V20C3 21.1 3.9 22 5 22H19C20.1 22 21 21.1 21 20V6L18 2H6Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M9 6V10C9 11.1 9.9 12 11 12H13C14.1 12 15 11.1 15 10V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="cart-badge" id="cartBadgeDetail">0</span>
                </div>
            </div>
            <button class="action-btn buy-now-btn" onclick="buyNowFromDetail()">
                Buy Now
            </button>
            <button class="action-btn add-to-cart-btn" style="margin-top: 0px !important;" onclick="addToCartFromDetail()">
                Add to Cart
            </button>
        </div>
    </div>

    <script>
        // Configuration
        const CONFIG = {
            apiUrl: 'http://localhost:3000/api',
            shopifyDomain: 'eyejackapp.myshopify.com',
            storefrontToken: '' // Token will be handled by backend APIs
        };

        // State
        let currentSlide = 0;
        let products = [];
        let collections = [];
        let appConfig = {};

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Initializing Eyejack Mobile App...');
            
            // Show splash screen for a moment, then start app initialization
            setTimeout(() => {
                // Hide splash screen after app initialization
                hideSplashScreen();
            
            // Initialize cart badge and load real cart data
            updateCartBadge(0);
            loadCartContent();
            
            // Ensure text content is visible immediately
            setTimeout(() => {
                const announcementTextContent = document.querySelector('.announcement-text-content');
                if (announcementTextContent) {
                    if (!announcementTextContent.textContent || announcementTextContent.textContent.trim() === '') {
                        announcementTextContent.textContent = announcements[0];
                        console.log('Set emergency fallback text:', announcements[0]);
                    }
                    // Force visibility with multiple methods
                    announcementTextContent.style.visibility = 'visible';
                    announcementTextContent.style.opacity = '1';
                    announcementTextContent.style.display = 'block';
                    announcementTextContent.style.color = 'white';
                    announcementTextContent.style.fontSize = '16px';
                    announcementTextContent.style.textAlign = 'center';
                    console.log('Final text check:', announcementTextContent.textContent);
                    console.log('Text styles applied - color:', announcementTextContent.style.color);
                }
            }, 50);
            
            initializeApp();
            setupSlider();
            initializeAnnouncementSlider();
            
            // 🚨 FORCE REFRESH: Clear all cached data and load real Shopify prices
            setTimeout(async () => {
                console.log('🔄 FORCE CLEARING ALL CACHED DATA...');
                
                // Clear all cached data
                window.cachedProducts = null;
                products = [];
                localStorage.removeItem('cachedProducts');
                sessionStorage.clear();
                
                // Force reload from API
                console.log('📡 FETCHING REAL SHOPIFY PRICES...');
                await loadProducts();
                
                // Force re-render all product displays
                updateNewArrivals();
                updateBestSellers();
                
                console.log('✅ REAL SHOPIFY PRICES LOADED!');
            }, 2000);
            
            // Force load real Shopify products and prices
            setTimeout(async () => {
                console.log('🛍️ Force loading real Shopify products...');
                await window.forceRefreshProducts();
                console.log('✅ Real Shopify products loaded!');
            }, 1000);
            
            // Initialize slider from config if available
            if (appConfig && appConfig.slider) {
                updateSliderFromConfig();
            }
            
            // Load real data from Shopify
            console.log('📊 Loading real data from Shopify store...');
            loadProducts();
            loadCollections();
            
            // Initialize Best Sellers (with delay to ensure DOM is ready)
            setTimeout(() => {
                if (appConfig && appConfig.bestSeller && appConfig.bestSeller.enabled !== false) {
                    loadBestSellersProducts();
                }
            }, 100);
            
            connectWebSocket();
            
            // Initialize saved cart
            loadSavedCart();
            
            // Show loading status
            console.log('🔄 Loading real products from your Shopify store...');
            
            }, 100); // Close the setTimeout for splash screen delay
        });

        // Handle responsive font size adjustments on window resize
        window.addEventListener('resize', function() {
            if (appConfig.announcementBar && appConfig.announcementBar.fontSize) {
                updateUIFromConfig();
            }
            // Also recheck text overflow on resize
            setTimeout(() => {
                checkTextOverflow();
            }, 200);
        });

        async function initializeApp() {
            try {
                const response = await fetch(`${CONFIG.apiUrl}/app-config`);
                const data = await response.json();
                if (data.success) {
                    appConfig = data.config;
                    updateUIFromConfig();
                    console.log('✅ App configuration loaded:', appConfig);
                } else {
                    // Fallback to test config
                    const fallbackResponse = await fetch(`${CONFIG.apiUrl}/test-config`);
                    const fallbackData = await fallbackResponse.json();
                    if (fallbackData.success) {
                        appConfig = fallbackData.config;
                        updateUIFromConfig();
                        console.log('✅ Fallback configuration loaded:', appConfig);
                    }
                }
            } catch (error) {
                console.error('Failed to load app config:', error);
                // Set default config if all fails
                appConfig = {
                    header: {
                        title: 'EyeJack',
                        logoUrl: '',
                        backgroundColor: '#FFFFFF',
                        textColor: '#1F2937',
                        iconColor: '#FFFFFF'
                    },
                    slider: {
                        enabled: true,
                        autoplay: true,
                        showIndicators: true,
                        showNavigation: false,
                        showText: true,
                        showButton: true,
                        interval: 5000,
                        slides: []
                    },
                    bestSeller: {
                        enabled: true,
                        title: 'Best Sellers',
                        showViewAll: true,
                        itemsToShow: 10,
                        layout: 'horizontal'
                    }
                };
                updateUIFromConfig();
            }
        }

        function updateUIFromConfig() {
            console.log('🔄 Updating UI from config:', appConfig);
            
            // Update announcement bar
            if (appConfig.announcementBar) {
                const announcementBar = document.getElementById('announcementBar');
                const announcementText = document.querySelector('.announcement-text');
                
                if (announcementBar) {
                    announcementBar.style.backgroundColor = appConfig.announcementBar.backgroundColor || '#FF6B35';
                    announcementBar.style.color = appConfig.announcementBar.textColor || '#FFFFFF';
                    announcementBar.style.display = appConfig.announcementBar.enabled ? 'flex' : 'none';
                    
                    // Update minimum height if specified, but allow dynamic growth
                    if (appConfig.announcementBar.height) {
                        announcementBar.style.minHeight = appConfig.announcementBar.height + 'px';
                    }
                    
                    // Update font size if specified (with responsive adjustments)
                    if (appConfig.announcementBar.fontSize) {
                        const announcementTextContent = document.querySelector('.announcement-text-content');
                        if (announcementTextContent) {
                            const baseFontSize = appConfig.announcementBar.fontSize;
                            const screenWidth = window.innerWidth;
                            
                            let adjustedFontSize = baseFontSize;
                            if (screenWidth <= 320) {
                                adjustedFontSize = Math.max(baseFontSize - 3, 12); // Minimum 12px
                            } else if (screenWidth <= 375) {
                                adjustedFontSize = Math.max(baseFontSize - 2, 13); // Minimum 13px
                            }
                            
                            announcementTextContent.style.fontSize = adjustedFontSize + 'px';
                            announcementTextContent.style.setProperty('font-size', adjustedFontSize + 'px', 'important');
                            
                            // Recheck text overflow after font size change
                            setTimeout(() => {
                                checkTextOverflow();
                            }, 150);
                        }
                    }
                }
                
                // Handle multiple announcements or single text
                if (appConfig.announcementBar.announcements && Array.isArray(appConfig.announcementBar.announcements)) {
                    updateAnnouncementsFromConfig(appConfig);
                } else if (appConfig.announcementBar.text) {
                    // Fallback to single text mode
                    announcements = [appConfig.announcementBar.text];
                    currentAnnouncementIndex = 0;
                    const announcementTextContent = document.querySelector('.announcement-text-content');
                    if (announcementTextContent) {
                        announcementTextContent.textContent = appConfig.announcementBar.text;
                        // Force visibility with multiple styles
                        announcementTextContent.style.visibility = 'visible';
                        announcementTextContent.style.opacity = '1';
                        announcementTextContent.style.display = 'block';
                        announcementTextContent.style.color = 'white';
                        announcementTextContent.style.textAlign = 'center';
                        console.log('Set fallback text to:', appConfig.announcementBar.text);
                        setTimeout(() => {
                            checkTextOverflow();
                        }, 100);
                    }
                    updateAnnouncementDisplay();
                }
                
                // Trigger height adjustment after text update
                setTimeout(() => {
                    adjustAnnouncementBarHeight();
                }, 100);
            }
            
            // Update header
            if (appConfig.header) {
                const logoContainer = document.querySelector('.logo');
                const logoImage = document.getElementById('logoImage');
                const header = document.querySelector('.header');
                
                if (logoContainer && logoImage) {
                    // Update logo based on configuration
                    if (appConfig.header.logoUrl && appConfig.header.logoUrl.trim() !== '') {
                        // Show image logo
                        logoImage.src = appConfig.header.logoUrl;
                        logoImage.alt = appConfig.header.title || 'EyeJack';
                        logoImage.style.display = 'block';
                        console.log('✅ Logo updated:', appConfig.header.logoUrl);
                    } else {
                        // Fallback to text logo
                        logoImage.style.display = 'none';
                        logoContainer.innerHTML = `<span class="logo-text">${appConfig.header.title || 'EyeJack'}</span>`;
                        console.log('📝 Using text logo:', appConfig.header.title || 'EyeJack');
                    }
                }
                
                if (header) {
                    header.style.backgroundColor = appConfig.header.backgroundColor || 'white';
                }
                
                // Update icon colors
                if (appConfig.header.iconColor) {
                    updateIconColors(appConfig.header.iconColor);
                }
                
                // Update menu visibility
                updateHeaderMenu();
            }

        // Update slider
        if (appConfig.slider) {
            updateSliderFromConfig();
            }
            
        // Update Best Sellers
        if (appConfig.bestSeller) {
            updateBestSellersFromConfig();
        }
            
                    console.log('✨ App updated with new configuration!');
        }
        
        function updateBestSellersFromConfig() {
            console.log('🛍️ Updating Best Sellers from configuration...', appConfig.bestSeller);
            
            const bestSellersSection = document.getElementById('bestSellersSection');
            const bestSellersTitle = document.getElementById('bestSellersTitle');
            const bestSellersSeeAll = document.getElementById('bestSellersSeeAll');
            
            if (!bestSellersSection) return;
            
            // Show/hide section
            if (appConfig.bestSeller.enabled === false) {
                bestSellersSection.style.display = 'none';
                return;
            } else {
                bestSellersSection.style.display = 'block';
            }
            
            // Update title
            if (bestSellersTitle && appConfig.bestSeller.title) {
                bestSellersTitle.textContent = appConfig.bestSeller.title;
            }
            
            // Show/hide "See all" button
            if (bestSellersSeeAll) {
                bestSellersSeeAll.style.display = appConfig.bestSeller.showViewAll !== false ? 'block' : 'none';
            }
            
            // Load and display products
            loadBestSellersProducts();
        }

        function updateNewArrivals() {
            console.log('✨ Updating New Arrivals section...');
            
            // Re-render the new arrivals with current products data
            if (window.products && Array.isArray(window.products)) {
                renderProducts('newArrivals', window.products);
                console.log('✅ New Arrivals section updated with current products');
            } else {
                console.log('🔄 No products data available, triggering product reload...');
                loadProducts();
            }
        }

        function updateBestSellers() {
            console.log('⭐ Updating Best Sellers section...');
            
            // Re-load and render best sellers products
            loadBestSellersProducts();
            console.log('✅ Best Sellers section updated');
        }
        
        async function loadBestSellersProducts() {
            try {
                const response = await fetch(`${CONFIG.apiUrl}/shopify-products?type=products&limit=${appConfig.bestSeller?.itemsToShow || 6}`);
                const data = await response.json();
                
                if (data.success && data.products) {
                    console.log('🛍️ Raw Best Sellers data:', data.products);
                    
                    // Transform Shopify products to our format (same as loadProducts)
                    const transformedProducts = data.products.map(product => {
                        const transformedProduct = {
                            id: product.id,
                            title: product.title,
                            vendor: product.vendor || 'Shopify Store',
                            price: product.variant ? `₹${product.variant.price.amount}` : 'Price not available',
                            compareAtPrice: product.variant?.compareAtPrice ? `₹${product.variant.compareAtPrice.amount}` : null,
                            image: product.image?.url || (product.images && product.images[0] ? product.images[0].url : 'https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=300&h=300&fit=crop'),
                            onSale: product.variant?.onSale || false,
                            handle: product.handle,
                            description: product.description
                        };
                        
                        console.log('🔄 Transformed product:', transformedProduct.title, 'Image:', transformedProduct.image);
                        return transformedProduct;
                    });
                    
                    console.log('✅ All transformed Best Sellers:', transformedProducts);
                    renderProducts('bestSellersHorizontal', transformedProducts);
                } else {
                    console.error('Failed to load best sellers products:', data.error);
                }
            } catch (error) {
                console.error('Error loading best sellers products:', error);
            }
        }
        
        function updateIconColors(iconColor) {
            // Update hamburger menu icon
            const hamburgerMenu = document.querySelector('.hamburger-menu');
            if (hamburgerMenu) {
                hamburgerMenu.style.color = iconColor;
            }
            
            // Update search icon
            const searchIcon = document.querySelector('.search-icon');
            if (searchIcon) {
                searchIcon.style.color = iconColor;
            }
            
            // Update profile icon
            const profileIcon = document.querySelector('.profile-icon');
            if (profileIcon) {
                profileIcon.style.color = iconColor;
            }
            
            // Update cart icon
            const cartIcon = document.querySelector('.cart-icon');
            if (cartIcon) {
                cartIcon.style.color = iconColor;
            }
            
            // Update logo text color (if no logo image is used)
            const logoText = document.querySelector('.logo-text');
            if (logoText) {
                logoText.style.color = iconColor;
            }
            
            console.log('🎨 Icon colors updated to:', iconColor);
        }
        
        function updateHeaderMenu() {
            const headerRight = document.querySelector('.header-right');
            if (!headerRight || !appConfig.header) return;
            
            // Remove existing menu if any
            const existingMenu = document.getElementById('headerMenu');
            if (existingMenu) existingMenu.remove();
            
            // Add menu based on selection
            if (appConfig.header.selectedMenu === 'collections') {
                addShopifyDrawerMenu();
            } else if (appConfig.header.selectedMenu === 'main') {
                addMainNavigationMenu();
            }
        }
        
        function addShopifyDrawerMenu() {
            const existingDrawer = document.getElementById('collectionsDrawer');
            if (existingDrawer) existingDrawer.remove();
            
            // Create full drawer overlay
            const drawerOverlay = document.createElement('div');
            drawerOverlay.id = 'collectionsDrawer';
            drawerOverlay.innerHTML = `
                <!-- Backdrop -->
                <div class="drawer-backdrop" style="
                    position: fixed;
                    top: 0;
                left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.5);
                    z-index: 998;
                    opacity: 0;
                    transition: opacity 0.3s ease;
                display: none;
                " onclick="closeCollectionsDrawer()"></div>
                
                <!-- Drawer Content -->
                <div class="drawer-content" style="
                    position: fixed;
                    top: 0;
                    left: -100%;
                    width: 90%;
                    max-width: 420px;
                    height: 100%;
                    background: white;
                    z-index: 999;
                    transition: left 0.3s ease;
                    overflow-y: auto;
                    box-shadow: 4px 0 20px rgba(0, 0, 0, 0.15);
                ">
                    <!-- Header with Close Button -->
                    <div style="
                        position: relative;
                        padding: 15px 20px;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        border-bottom: 1px solid #f0f0f0;
                    ">
                        <img src="https://cdn.shopify.com/s/files/1/0583/8831/6208/files/logo_eyejack-min_c2486715-1e14-494b-b255-e3e66d994c5d.png?v=1704799849" 
                             alt="EyeJack Logo" style="height: 35px; width: auto; object-fit: contain;" />
                        <button onclick="closeCollectionsDrawer()" style="
                            background: none;
                            border: none;
                            color: #666;
                            width: 30px;
                            height: 30px;
                            cursor: pointer;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-size: 18px;
                            -webkit-tap-highlight-color: transparent;
                            tap-highlight-color: transparent;
                        ">✕</button>
                    </div>
                    
                    <!-- Login/Account Section -->
                    <div style="
                        padding: 20px;
                        background: #f8f9fa;
                        margin: 10px 15px;
                        border-radius: 12px;
                        border: 1px solid #e9ecef;
                    ">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                            <div style="
                                width: 45px;
                                height: 45px;
                                border-radius: 50%;
                                border: 2px solid #666;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                background: white;
                            ">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2">
                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="12" cy="7" r="4"></circle>
                                </svg>
                            </div>
                            <div style="flex: 1;">
                                <div style="font-size: 14px; color: #666; margin-bottom: 2px;">
                                    Use <span style="color: #ff6b35; font-weight: bold;">99%</span> of your <span style="font-weight: bold;">Cashback</span>
                                </div>
                                <div style="color: #333; font-size: 13px;">To Redeem</div>
                            </div>
                            <button onclick="console.log('📱 App download coming soon!');" style="
                                background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
                                color: white;
                                border: none;
                                padding: 8px 16px;
                                border-radius: 20px;
                                font-size: 12px;
                                font-weight: 500;
                                cursor: pointer;
                                -webkit-tap-highlight-color: transparent;
                            ">Download App</button>
                        </div>
                    </div>
                    
                    <!-- Quick Actions -->
                    <div style="
                        padding: 0 15px;
                        margin-bottom: 20px;
                    ">
                        <div style="display: flex; gap: 10px;">
                            <button onclick="showUserOrders();" style="
                                flex: 1;
                                background: #f8f9fa;
                                border: 1px solid #e9ecef;
                                border-radius: 8px;
                                padding: 12px;
                                display: flex;
                                align-items: center;
                                gap: 8px;
                                font-size: 14px;
                                font-weight: 500;
                                color: #333;
                                cursor: pointer;
                                -webkit-tap-highlight-color: transparent;
                            ">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/>
                                    <path d="m3.3 7 8.7 5 8.7-5"/>
                                    <path d="M12 22V12"/>
                                </svg>
                                MY ORDERS
                            </button>
                            <button onclick="showTrackOrder();" style="
                                flex: 1;
                                background: #f8f9fa;
                                border: 1px solid #e9ecef;
                                border-radius: 8px;
                                padding: 12px;
                                display: flex;
                                align-items: center;
                                gap: 8px;
                                font-size: 14px;
                                font-weight: 500;
                                color: #333;
                                cursor: pointer;
                                -webkit-tap-highlight-color: transparent;
                            ">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2"/>
                                    <path d="M15 18H9"/>
                                    <path d="M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14"/>
                                    <circle cx="17" cy="18" r="2"/>
                                    <circle cx="7" cy="18" r="2"/>
                                </svg>
                                TRACK ORDER
                            </button>
                        </div>
                    </div>
                    

                    
                    <!-- Promotional Banner -->
                    <div style="
                        margin: 0 15px 20px;
                        background: linear-gradient(135deg, #2c1810 0%, #8b4513 100%);
                        border-radius: 12px;
                        padding: 15px;
                        color: white;
                        position: relative;
                        overflow: hidden;
                        cursor: pointer;
                        -webkit-tap-highlight-color: transparent;
                    " onclick="console.log('🌟 Zodiac Collection coming soon!');">
                        <div style="position: relative; z-index: 2;">
                            <div style="font-size: 20px; font-weight: 700; color: #d4af37; margin-bottom: 5px;">Zodiac Collection</div>
                            <div style="font-size: 13px; opacity: 0.9;">Your Zodiac Fragrance Match Is Here</div>
                        </div>
                        <div style="
                            position: absolute;
                            right: 10px;
                            top: 50%;
                            transform: translateY(-50%);
                            font-size: 24px;
                        ">⟩</div>
                        <div style="
                            position: absolute;
                            left: -20px;
                            top: -20px;
                            width: 60px;
                            height: 60px;
                            background: radial-gradient(circle, rgba(212, 175, 55, 0.3) 0%, transparent 70%);
                            border-radius: 50%;
                        "></div>
                    </div>
                    
                    <!-- Menu Items -->
                    <div style="padding: 0 15px;">
                        <!-- Crazy Deals -->
                        <div onclick="console.log('🔥 Crazy Deals coming soon!');" style="
                            display: flex;
                            align-items: center;
                            padding: 15px 0;
                            border-bottom: 1px solid #f0f0f0;
                            cursor: pointer;
                            -webkit-tap-highlight-color: transparent;
                        ">
                            <div style="
                                width: 40px;
                                height: 40px;
                                background: #ff6b35;
                                border-radius: 50%;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                margin-right: 15px;
                                font-size: 18px;
                            ">%</div>
                            <div style="flex: 1; font-size: 16px; font-weight: 500; color: #333;">CRAZY DEALS</div>
                            <div style="font-size: 18px; color: #ff6b35;">🔥</div>
                        </div>
                        
                        <!-- Shop All -->
                        <div onclick="console.log('🛍️ Shop All coming soon!');" style="
                            display: flex;
                            align-items: center;
                            padding: 15px 0;
                            border-bottom: 1px solid #f0f0f0;
                            cursor: pointer;
                            -webkit-tap-highlight-color: transparent;
                        ">
                            <div style="
                                width: 40px;
                                height: 40px;
                                background: #6c757d;
                                border-radius: 50%;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                margin-right: 15px;
                            ">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="2">
                                    <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
                                    <line x1="3" y1="6" x2="21" y2="6"/>
                                    <path d="M16 10a4 4 0 0 1-8 0"/>
                                </svg>
                            </div>
                            <div style="flex: 1; font-size: 16px; font-weight: 500; color: #333;">SHOP ALL</div>
                        </div>
                        
                        <!-- Bestsellers -->
                        <div onclick="console.log('👑 Bestsellers coming soon!');" style="
                            display: flex;
                            align-items: center;
                            padding: 15px 0;
                            border-bottom: 1px solid #f0f0f0;
                            cursor: pointer;
                            -webkit-tap-highlight-color: transparent;
                        ">
                            <div style="
                                width: 40px;
                                height: 40px;
                                background: #28a745;
                                border-radius: 50%;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                margin-right: 15px;
                            ">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="2">
                                    <path d="M14 9V5a3 3 0 0 0-6 0v4"/>
                                    <path d="M3 9h18l-1 11H4L3 9z"/>
                                    <path d="M16 14a4 4 0 0 1-8 0"/>
                                </svg>
                            </div>
                            <div style="flex: 1; font-size: 16px; font-weight: 500; color: #333;">BESTSELLERS</div>
                        </div>
                        
                        <!-- Collections with arrows -->
                        <div id="menuCollections">
                            <!-- This will be populated with real collections -->
                        </div>
                    </div>
                    
                    <!-- Footer Padding -->
                    <div style="height: 100px;"></div>
                </div>
            `;
            
            // Add drawer to body
            document.body.appendChild(drawerOverlay);
            
            // Add toggle button to hamburger menu
            const hamburgerMenu = document.querySelector('.hamburger-menu');
            if (hamburgerMenu) {
                hamburgerMenu.onclick = () => toggleCollectionsDrawer();
            }
            
            loadCollectionsMenu();
        }
        
        function toggleCollectionsDrawer() {
            const drawer = document.getElementById('collectionsDrawer');
            if (!drawer) return;
            
            const backdrop = drawer.querySelector('.drawer-backdrop');
            const content = drawer.querySelector('.drawer-content');
            
            const isOpen = backdrop.style.display === 'block';
            
            if (isOpen) {
                closeCollectionsDrawer();
            } else {
                openCollectionsDrawer();
            }
        }
        
        function openCollectionsDrawer() {
            const drawer = document.getElementById('collectionsDrawer');
            if (!drawer) return;
            
            const backdrop = drawer.querySelector('.drawer-backdrop');
            const content = drawer.querySelector('.drawer-content');
            
            // Show backdrop
            backdrop.style.display = 'block';
            setTimeout(() => backdrop.style.opacity = '1', 10);
            
            // Slide in drawer
            content.style.left = '0';
            
            // Prevent body scroll
            document.body.style.overflow = 'hidden';
            
            // Add keyboard support for ESC key
            document.addEventListener('keydown', handleDrawerKeydown);
            
            // Add touch swipe support
            addDrawerSwipeSupport(content);
        }
        
        function addDrawerSwipeSupport(drawerElement) {
            let startX = 0;
            let currentX = 0;
            let isDragging = false;
            
            drawerElement.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
                isDragging = true;
            });
            
            drawerElement.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                currentX = e.touches[0].clientX;
                const diffX = startX - currentX;
                
                // Only allow swiping left (closing)
                if (diffX > 0) {
                    const translateX = Math.min(diffX, drawerElement.offsetWidth);
                    drawerElement.style.transform = `translateX(-${translateX}px)`;
                }
            });
            
            drawerElement.addEventListener('touchend', (e) => {
                if (!isDragging) return;
                isDragging = false;
                
                const diffX = startX - currentX;
                const threshold = drawerElement.offsetWidth * 0.3; // 30% of drawer width
                
                if (diffX > threshold) {
                    // Close drawer
                    closeCollectionsDrawer();
                } else {
                    // Snap back to open position
                    drawerElement.style.transform = 'translateX(0)';
                }
            });
        }
        
        function handleDrawerKeydown(event) {
            if (event.key === 'Escape') {
                closeCollectionsDrawer();
            }
        }
        
        function closeCollectionsDrawer() {
            const drawer = document.getElementById('collectionsDrawer');
            if (!drawer) return;
            
            const backdrop = drawer.querySelector('.drawer-backdrop');
            const content = drawer.querySelector('.drawer-content');
            
            // Hide backdrop
            backdrop.style.opacity = '0';
            
            // Slide out drawer
            content.style.left = '-100%';
            content.style.transform = 'translateX(0)'; // Reset any transform from swipe
            
            // Restore body scroll
            document.body.style.overflow = '';
            
            // Remove keyboard event listener
            document.removeEventListener('keydown', handleDrawerKeydown);
            
            // Hide after animation
            setTimeout(() => {
                backdrop.style.display = 'none';
            }, 300);
        }

        function toggleMainNavigationMenu() {
            addMainNavigationMenu();
            const menu = document.getElementById('main-nav-menu');
            if (menu) {
                menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
            }
        }

        function addMainNavigationMenu() {
            const existingMenu = document.getElementById('main-nav-menu');
            if (existingMenu) {
                existingMenu.remove();
            }

            const menuHtml = `
                <div id="main-nav-menu" style="
                    position: fixed;
                    top: 60px;
                    left: 0;
                    right: 0;
                    background: white;
                    border-bottom: 1px solid #e5e7eb;
                    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                    z-index: 50;
                    padding: 10px 0;
                    display: none;
                ">
                    <div style="max-width: 400px; margin: 0 auto; padding: 0 16px;">
                        <a href="#" onclick="scrollToSection('heroSlider')" style="display: block; padding: 12px 0; border-bottom: 1px solid #f3f4f6; text-decoration: none; color: #1f2937;">🏠 Home</a>
                        <a href="#" onclick="scrollToSection('categoriesGrid')" style="display: block; padding: 12px 0; border-bottom: 1px solid #f3f4f6; text-decoration: none; color: #1f2937;">📱 Categories</a>
                        <a href="#" onclick="scrollToSection('newArrivals')" style="display: block; padding: 12px 0; border-bottom: 1px solid #f3f4f6; text-decoration: none; color: #1f2937;">✨ New Arrivals</a>
                        <a href="#" onclick="scrollToSection('bestSellers')" style="display: block; padding: 12px 0; text-decoration: none; color: #1f2937;">🔥 Best Sellers</a>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', menuHtml);
        }

        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
                // Hide menu after navigation
                const menu = document.getElementById('main-nav-menu');
                if (menu) menu.style.display = 'none';
                console.log('📍 Navigated to ' + sectionId.replace('-', ' '));
            }
        }
        
        async function loadCollectionsMenu() {
            const menuCollections = document.getElementById('menuCollections');
            if (!menuCollections) return;
            
            try {
                const response = await fetch(`${CONFIG.apiUrl}/shopify-products?type=collections&limit=10`);
                const data = await response.json();
                
                if (data.success && data.collections) {
                    menuCollections.innerHTML = '';
                    
                    console.log('🖼️ Collections with images:', data.collections.map(c => ({
                        title: c.title,
                        handle: c.handle,
                        hasImage: !!c.image?.url,
                        imageUrl: c.image?.url
                    })));
                    
                    // Filter out common collections that should appear as main menu items
                    const filteredCollections = data.collections.filter(collection => 
                        !['frontpage', 'home-page'].includes(collection.handle.toLowerCase())
                    );
                    
                    filteredCollections.forEach((collection, index) => {
                        // Get appropriate icon based on collection
                        const getCollectionIcon = (handle, title) => {
                            const lowerTitle = title.toLowerCase();
                            const lowerHandle = handle.toLowerCase();
                            
                            if (lowerTitle.includes('perfume') || lowerHandle.includes('perfume')) {
                                return `<svg width="20" height="20" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="2">
                                    <path d="M12 2L8 6v12l4 4 4-4V6l-4-4z"/>
                                    <path d="M8 6h8"/>
                                    <path d="M12 2v4"/>
                                </svg>`;
                            } else if (lowerTitle.includes('bath') || lowerTitle.includes('body') || lowerHandle.includes('bath')) {
                                return `<svg width="20" height="20" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="2">
                                    <path d="M2 12h20l-2 8H4l-2-8z"/>
                                    <path d="M7 12V6a3 3 0 0 1 6 0v6"/>
                                    <path d="M10 3h4"/>
                                </svg>`;
                            } else if (lowerTitle.includes('cosmetic') || lowerHandle.includes('cosmetic')) {
                                return `<svg width="20" height="20" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="2">
                                    <path d="M3 12h18l-2 8H5l-2-8z"/>
                                    <path d="M12 1v3"/>
                                    <path d="M9 4h6"/>
                                </svg>`;
                            } else if (lowerTitle.includes('skincare') || lowerTitle.includes('skin') || lowerHandle.includes('skincare')) {
                                return `<svg width="20" height="20" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="2">
                                    <path d="M4 8h16v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V8z"/>
                                    <path d="M8 8V6a2 2 0 0 1 4 0v2"/>
                                    <path d="M16 8V6a2 2 0 0 1-4 0v2"/>
                                </svg>`;
                            } else if (lowerTitle.includes('sunglass') || lowerHandle.includes('sunglass') || lowerTitle.includes('eyewear')) {
                                return `<svg width="20" height="20" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="2">
                                    <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/>
                                    <circle cx="12" cy="12" r="3"/>
                                </svg>`;
                            } else {
                                return `<svg width="20" height="20" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="2">
                                    <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
                                    <line x1="3" y1="6" x2="21" y2="6"/>
                                    <path d="M16 10a4 4 0 0 1-8 0"/>
                                </svg>`;
                            }
                        };
                        
                        const item = document.createElement('div');
                        item.onclick = () => {
                            showCollection(collection.handle);
                            closeCollectionsDrawer();
                        };
                        
                        item.innerHTML = `
                            <div style="
                                display: flex;
                                align-items: center;
                                padding: 15px 0;
                                border-bottom: 1px solid #f0f0f0;
                                cursor: pointer;
                                -webkit-tap-highlight-color: transparent;
                            ">
                                <div style="
                                    width: 40px;
                                    height: 40px;
                                    background: #6366f1;
                                    border-radius: 50%;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    margin-right: 15px;
                                ">
                                    ${getCollectionIcon(collection.handle, collection.title)}
                                </div>
                                <div style="flex: 1; font-size: 16px; font-weight: 500; color: #333; text-transform: uppercase;">
                                    ${collection.title}
                                </div>
                                <div style="font-size: 18px; color: #666;">→</div>
                            </div>
                        `;
                        
                        menuCollections.appendChild(item);
                    });
                }
            } catch (error) {
                console.error('Failed to load collections menu:', error);
                menuCollections.innerHTML = `
                    <div style="text-align: center; color: #ef4444; padding: 40px 20px;">
                        <div style="font-size: 2rem; margin-bottom: 10px;">❌</div>
                        <div>Failed to load collections</div>
                        <button onclick="loadCollectionsMenu()" style="
                            background: #ef4444;
                            color: white;
                            border: none;
                            padding: 8px 16px;
                            border-radius: 6px;
                            margin-top: 10px;
                            cursor: pointer;
                        ">Retry</button>
                    </div>
                `;
            }
        }
        
        function addMainNavigationMenu() {
            // Add main navigation menu implementation if needed
            console.log('Main navigation menu selected');
        }
        
        function showCollection(handle) {
            console.log(`📂 Browsing ${handle} collection`);
            // Here you would navigate to the collection page
        }

        // Slider functionality
        function setupSlider() {
            // Clear any existing interval
            if (window.sliderInterval) {
                clearInterval(window.sliderInterval);
                window.sliderInterval = null;
            }

            // Get slide count from current DOM
            const slides = document.querySelectorAll('.hero-slide');
            const slideCount = slides.length;
            
            if (slideCount <= 1) {
                console.log('🔒 Auto-slider disabled: Only one slide available');
                return;
            }

            // Use configuration if available, otherwise use defaults
            const autoplay = appConfig?.slider?.autoplay !== false;
            const interval = appConfig?.slider?.interval || 5000;
            
            if (autoplay) {
                console.log(`⏰ Starting auto-slider with ${interval}ms interval for ${slideCount} slides`);
                window.sliderInterval = setInterval(() => {
                    currentSlide = (currentSlide + 1) % slideCount;
                updateSlider();
                }, interval);
            } else {
                console.log('🔒 Auto-slider disabled in configuration');
            }
        }

        function changeSlide(index) {
            currentSlide = index;
            updateSlider();
        }

        function updateSlider() {
            const slides = document.querySelectorAll('.hero-slide');
            const indicators = document.querySelectorAll('.indicator');
            
            // Ensure currentSlide is within bounds
            if (slides.length > 0) {
                currentSlide = Math.max(0, Math.min(currentSlide, slides.length - 1));
            }
            
            slides.forEach((slide, index) => {
                slide.classList.toggle('active', index === currentSlide);
            });
            
            indicators.forEach((indicator, index) => {
                indicator.classList.toggle('active', index === currentSlide);
            });
        }

        // Update slider from live configuration
        function updateSliderFromConfig() {
            console.log('🎨 Updating hero slider from configuration...', appConfig.slider);
            
            if (!appConfig.slider) {
                console.log('⚠️ No slider configuration found');
                return;
            }

            const sliderContainer = document.getElementById('heroSlider');
            if (!sliderContainer) {
                console.log('⚠️ Hero slider container not found');
                return;
            }

            // Hide slider if disabled
            if (appConfig.slider.enabled === false) {
                sliderContainer.style.display = 'none';
                console.log('🔒 Hero slider disabled');
                return;
            } else {
                sliderContainer.style.display = 'block';
                console.log('✅ Hero slider enabled');
            }

            // Clear existing slides
            sliderContainer.innerHTML = '';

            // Get only enabled slides
            const enabledSlides = appConfig.slider.slides ? appConfig.slider.slides.filter(slide => slide.enabled !== false) : [];
            
            if (enabledSlides.length === 0) {
                console.log('⚠️ No enabled slides found');
                sliderContainer.innerHTML = '<div class="hero-slide active" style="display: flex; align-items: center; justify-content: center; background: #f3f4f6; color: #6b7280; height: 250px;">No slides configured</div>';
                return;
            }

            console.log(`🎯 Creating ${enabledSlides.length} slides`);

            // Create slides from configuration
            enabledSlides.forEach((slideConfig, index) => {
                const slide = document.createElement('div');
                slide.className = `hero-slide ${index === 0 ? 'active' : ''}`;
                
                // Apply background image
                slide.style.backgroundImage = `url('${slideConfig.backgroundImage}')`;
                
                // Create slide content
                const content = document.createElement('div');
                content.className = 'hero-content';
                
                // Check if text should be shown (default: true)
                const showText = appConfig.slider.showText !== false;
                
                // Title
                if (slideConfig.title && showText) {
                    const title = document.createElement('h2');
                    title.className = 'hero-title';
                    title.textContent = slideConfig.title;
                    title.style.color = slideConfig.textColor || '#FFFFFF';
                    content.appendChild(title);
                }
                
                // Subtitle
                if (slideConfig.subtitle && showText) {
                    const subtitle = document.createElement('p');
                    subtitle.className = 'hero-subtitle';
                    subtitle.textContent = slideConfig.subtitle;
                    subtitle.style.color = slideConfig.textColor || '#FFFFFF';
                    content.appendChild(subtitle);
                }
                
                // Check if button should be shown (default: true)
                const showButton = appConfig.slider.showButton !== false;
                
                // Button
                if (slideConfig.buttonText && showButton) {
                    const button = document.createElement('button');
                    button.className = 'hero-btn';
                    button.textContent = slideConfig.buttonText;
                    button.onclick = () => handleSlideAction(slideConfig.buttonAction, slideConfig.title);
                    content.appendChild(button);
                }
                
                slide.appendChild(content);
                sliderContainer.appendChild(slide);
            });

            // Create indicators if enabled and multiple slides
            if (appConfig.slider.showIndicators !== false && enabledSlides.length > 1) {
                const indicatorsContainer = document.createElement('div');
                indicatorsContainer.className = 'slider-indicators';
                
                enabledSlides.forEach((_, index) => {
                    const indicator = document.createElement('div');
                    indicator.className = `indicator ${index === 0 ? 'active' : ''}`;
                    indicator.onclick = () => changeSlide(index);
                    indicatorsContainer.appendChild(indicator);
                });
                
                sliderContainer.appendChild(indicatorsContainer);
            }

            // Reset current slide
            currentSlide = 0;
            
            // Clear any existing interval
            if (window.sliderInterval) {
                clearInterval(window.sliderInterval);
                window.sliderInterval = null;
            }

            // Setup auto-play if enabled and multiple slides
            if (appConfig.slider.autoplay !== false && enabledSlides.length > 1) {
                const interval = appConfig.slider.interval || 5000;
                console.log(`⏰ Setting up auto-play with ${interval}ms interval`);
                
                window.sliderInterval = setInterval(() => {
                    currentSlide = (currentSlide + 1) % enabledSlides.length;
                    updateSlider();
                }, interval);
            }

            console.log('✅ Hero slider updated successfully');
        }

        // Handle slide button actions
        function handleSlideAction(action, slideTitle) {
            console.log(`🎬 Slide action: ${action} from "${slideTitle}"`);
            
            switch (action) {
                case 'explore':
                    console.log(`🔍 Exploring products from "${slideTitle}"`);
                    scrollToSection('newArrivals');
                    break;
                case 'collections':
                    console.log(`📂 Viewing collections from "${slideTitle}"`);
                    showCollections();
                    break;
                case 'bestsellers':
                    console.log(`⭐ Viewing best sellers from "${slideTitle}"`);
                    scrollToSection('bestSellers');
                    break;
                case 'deals':
                                    console.log(`💰 Viewing deals from "${slideTitle}"`);
                console.log('🎉 Flash Sale - 50% OFF selected items!');
                    break;
                case 'custom':
                default:
                    console.log(`🎯 Action triggered from "${slideTitle}"`);
                    break;
            }
        }

        // Force refresh all data (call this to get real Shopify prices)
        window.forceRefreshProducts = async function() {
            console.log('🔄 FORCE REFRESHING ALL PRODUCT DATA...');
            
            // Clear all cached data
            window.cachedProducts = null;
            products = [];
            
            // Clear displayed products
            const containers = ['newArrivals', 'bestSellersHorizontal'];
            containers.forEach(containerId => {
                const container = document.getElementById(containerId);
                if (container) {
                    container.innerHTML = '<div class="loading">Loading real Shopify prices...</div>';
                }
            });
            
            // Force reload from API
            await loadProducts();
            console.log('✅ FORCE REFRESH COMPLETE - You should now see real Shopify prices!');
        };

        // Product loading with real Shopify API
        async function loadProducts() {
            try {
                console.log('🛍️ Loading real products from Shopify...');
                
                // Fetch real products from your Shopify store (with aggressive cache busting)
                const cacheBuster = Date.now();
                const response = await fetch(`${CONFIG.apiUrl}/shopify-products?type=products&limit=10&_=${cacheBuster}`, {
                    headers: {
                        'Cache-Control': 'no-cache, no-store, must-revalidate',
                        'Pragma': 'no-cache',
                        'Expires': '0'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`Failed to fetch products: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.success && data.products) {
                    console.log(`✅ Loaded ${data.products.length} real products from Shopify`);
                    
                    // Debug: Show each product and its image data
                    data.products.forEach((product, index) => {
                        console.log(`📦 Product ${index + 1}:`, {
                            id: product.id,
                            title: product.title,
                            hasImages: !!product.images,
                            imageEdgesCount: product.images?.edges?.length || 0,
                            firstImageUrl: product.images?.edges?.[0]?.node?.url,
                            allImageData: product.images
                        });
                    });
                    
                    // Clear any old cache and store fresh products data
                    window.cachedProducts = null;
                    window.cachedProducts = data.products;
                    console.log('💾 Cached fresh product data with images:', window.cachedProducts.length, 'products');
                    
                    // Transform Shopify products to our display format with debugging
                    console.log('🔍 Raw Shopify product data:', data.products[0]);
                    products = data.products.map(product => {
                        const transformedProduct = {
                            id: product.id,
                            title: product.title,
                            vendor: product.vendor || 'Shopify Store',
                            price: product.variant ? `₹${product.variant.price.amount}` : 'Price not available',
                            compareAtPrice: product.variant?.compareAtPrice ? `₹${product.variant.compareAtPrice.amount}` : null,
                            image: product.images?.edges?.[0]?.node?.url || product.image?.url || 'https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=300&h=300&fit=crop',
                            onSale: product.variant?.onSale || false,
                            handle: product.handle,
                            description: product.description
                        };
                        console.log('✅ Transformed product:', transformedProduct);
                        return transformedProduct;
                    });
                    
                    // Store products globally
                    window.products = products;
                    
                    renderProducts('newArrivals', products);
                    renderProducts('bestSellersHorizontal', products);
                    
                    console.log(`🎉 Loaded ${products.length} real products from your Shopify store!`);
                } else {
                    throw new Error('No products found in response');
                }
                
            } catch (error) {
                console.error('❌ Failed to load real products:', error);
                console.warn('⚠️ Failed to load real products, showing sample data');
                
                // Fallback to sample products if API fails
                loadSampleProducts();
            }
        }
        
        // Fallback sample products
        function loadSampleProducts() {
            const sampleProducts = [
                {
                    id: 'sample-1',
                    title: 'Sample Product (API Error)',
                    vendor: 'Demo Store',
                                            price: '₹99.99',
                        compareAtPrice: '₹129.99',
                    image: 'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=300&h=300&fit=crop',
                    onSale: true
                },
                {
                    id: 'sample-2',
                    title: 'Demo Item (Fallback)',
                    vendor: 'Sample Store',
                                            price: '₹149.99',
                    compareAtPrice: null,
                    image: 'https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=300&h=300&fit=crop',
                    onSale: false
                }
            ];
            
            products = sampleProducts;
            window.products = products;
            renderProducts('newArrivals', products);
            renderProducts('bestSellersHorizontal', products);
        }

        function renderProducts(containerId, productsData) {
            const container = document.getElementById(containerId);
            const loading = document.getElementById(containerId + 'Loading');
            
            // Guard against null container
            if (!container) {
                console.error(`❌ Container with ID '${containerId}' not found`);
                return;
            }
            
            if (loading) loading.style.display = 'none';
            
            container.innerHTML = '';
            
            // Special handling for horizontal best sellers
            if (containerId === 'bestSellersHorizontal') {
                renderBestSellersHorizontal(containerId, productsData);
                return;
            }
            
            productsData.forEach(product => {
                // Use enhanced cards for new arrivals and best sellers, regular cards for other sections
                const productCard = (containerId === 'newArrivals' || containerId === 'bestSellers') 
                    ? createEnhancedProductCard(product)
                    : createProductCard(product);
                container.appendChild(productCard);
            });
        }

        function renderBestSellersHorizontal(containerId, productsData) {
            const container = document.getElementById(containerId);
            const loading = document.getElementById(containerId + 'Loading');
            
            // Guard against null container
            if (!container) {
                console.error(`❌ Horizontal container with ID '${containerId}' not found`);
                return;
            }
            
            if (loading) loading.style.display = 'none';
            
            container.innerHTML = '';
            
            // Limit products based on configuration
            const itemsToShow = appConfig.bestSeller?.itemsToShow || 10;
            const limitedProducts = productsData.slice(0, itemsToShow);
            
            limitedProducts.forEach(product => {
                const productCard = createBestSellerCard(product);
                container.appendChild(productCard);
            });
        }

        function createBestSellerCard(product) {
            const card = document.createElement('div');
            card.className = 'product-card';
            card.onclick = () => showProduct(product.id);
            
            // Better image fallback handling
            let imageUrl = 'https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=300&h=300&fit=crop';
            
            if (product.image) {
                imageUrl = product.image;
            } else if (product.images && product.images.length > 0) {
                imageUrl = product.images[0].url || product.images[0];
            } else if (product.featuredImage) {
                imageUrl = product.featuredImage.url || product.featuredImage;
            }
            
            console.log('🖼️ Best Seller Image URL:', imageUrl, 'for product:', product.title);
            
            const price = product.variant?.price?.amount ? `₹${product.variant.price.amount}` : product.price || 'Price not available';
            
            card.innerHTML = `
                <div class="product-image" style="background-image: url('${imageUrl}')">
                    <!-- No badges for best sellers -->
                </div>
                <div class="product-info">
                    <div class="product-title">${product.title}</div>
                    <div class="product-vendor">${product.vendor || 'EyeJack'}</div>
                    <div class="product-price">
                        <span class="current-price">${price}</span>
                    </div>
                    <button class="add-to-cart-btn" onclick="event.stopPropagation(); addToCartAndUpdate('${product.id}')">
                        Add to Cart
                    </button>
                </div>
            `;
            
            return card;
        }



        function createProductCard(product) {
            const card = document.createElement('div');
            card.className = 'product-card';
            card.onclick = () => showProduct(product.id);
            
            card.innerHTML = `
                <div class="product-image" style="background-image: url('${product.image}')">
                    ${product.onSale ? '<div class="sale-badge">SALE</div>' : ''}
                </div>
                <div class="product-info">
                    <div class="product-title">${product.title}</div>
                    <div class="product-vendor">${product.vendor}</div>
                    <div class="product-price">
                        <span class="current-price">${product.price}</span>
                        ${product.compareAtPrice ? `<span class="original-price">${product.compareAtPrice}</span>` : ''}
                    </div>
                    <button class="add-to-cart-btn" onclick="event.stopPropagation(); addToCartAndUpdate('${product.id}')">
                        Add to Cart
                    </button>
                </div>
            `;
            
            return card;
        }

        function createEnhancedProductCard(product) {
            const card = document.createElement('div');
            card.className = 'enhanced-product-card';
            card.onclick = () => showProduct(product.id);
            
            // Generate multiple images (using the main image + variations for demo)
            const images = [
                product.image,
                product.image, // In real implementation, you'd have multiple product images
                product.image
            ].filter(Boolean);
            
            // Generate star rating (4-5 stars for demo)
            const rating = 4 + Math.random(); // Random rating between 4-5
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
            
            let starsHTML = '';
            for (let i = 0; i < fullStars; i++) {
                starsHTML += '<span class="star">★</span>';
            }
            if (hasHalfStar) {
                starsHTML += '<span class="star">☆</span>';
            }
            for (let i = 0; i < emptyStars; i++) {
                starsHTML += '<span class="star empty">☆</span>';
            }
            
            // Generate image navigation and dots
            const imageNavHTML = images.length > 1 ? `
                <button class="image-nav prev" onclick="event.stopPropagation(); changeProductImage('${product.id}', -1)">‹</button>
                <button class="image-nav next" onclick="event.stopPropagation(); changeProductImage('${product.id}', 1)">›</button>
                <div class="image-dots">
                    ${images.map((_, index) => `<div class="image-dot ${index === 0 ? 'active' : ''}" onclick="event.stopPropagation(); setProductImage('${product.id}', ${index})"></div>`).join('')}
                </div>
            ` : '';
            

            card.innerHTML = `
                <div class="enhanced-product-image-container">
                    <div class="enhanced-product-image" 
                         style="background-image: url('${images[0]}')"
                         data-product-id="${product.id}"
                         data-current-image="0">
                    </div>
                    ${product.onSale ? '<div class="enhanced-sale-badge">SALE</div>' : ''}
                    ${imageNavHTML}
                </div>
                <div class="enhanced-product-info">
                    <div class="enhanced-product-title">${product.title}</div>
                    <div class="product-rating">
                        <div class="star-rating">
                            ${starsHTML}
                        </div>
                        <span class="rating-text">(${Math.floor(rating * 10) / 10})</span>
                    </div>
                    <div class="enhanced-product-price">
                        <div class="price-label">On Sale from</div>
                        <span class="enhanced-current-price">${product.price}</span>
                        ${product.compareAtPrice ? `<span class="enhanced-original-price">${product.compareAtPrice}</span>` : ''}
                    </div>
                    <div class="enhanced-product-actions">
                        <button class="enhanced-add-to-cart-btn" onclick="event.stopPropagation(); addToCartAndUpdate('${product.id}')">
                            Add to Cart
                        </button>
                        <button class="select-size-btn" onclick="event.stopPropagation(); selectSize('${product.id}')">
                            Select Size
                        </button>
                    </div>
                </div>
            `;
            
            return card;
        }

        async function loadCollections() {
            try {
                console.log('📂 Loading real collections from Shopify...');
                
                // Fetch real collections from your Shopify store
                const response = await fetch(`${CONFIG.apiUrl}/shopify-products?type=collections&limit=8`);
                
                if (!response.ok) {
                    throw new Error(`Failed to fetch collections: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.success && data.collections) {
                    console.log(`✅ Loaded ${data.collections.length} real collections from Shopify`);
                    
                    // Transform Shopify collections to our format
                    collections = data.collections.map(collection => ({
                        id: collection.id,
                        title: collection.title,
                        handle: collection.handle,
                        description: collection.description,
                        image: collection.image?.url
                    }));
                    
                    // Update categories grid with real collections
                    updateCategoriesWithRealCollections();
                    
                    console.log(`📂 Loaded ${collections.length} real collections!`);
                } else {
                    throw new Error('No collections found in response');
                }
                
            } catch (error) {
                console.error('❌ Failed to load real collections:', error);
                
                // Fallback to sample collections
                collections = [
                    { id: 'sample-1', title: 'Sample Category', handle: 'sample' },
                    { id: 'sample-2', title: 'Demo Collection', handle: 'demo' }
                ];
            }
        }
        
        function updateCategoriesWithRealCollections() {
            const categoriesGrid = document.getElementById('categoriesGrid');
            if (!categoriesGrid || collections.length === 0) return;
            
            // Clear existing categories
            categoriesGrid.innerHTML = '';
            
            // Elegant category configuration with beautiful icons and colors
            const categoryStyles = [
                { 
                    icon: '🌹', 
                    circleClass: 'rose',
                    keywords: ['beauty', 'cosmetic', 'makeup', 'skincare', 'face']
                },
                { 
                    icon: '🍋', 
                    circleClass: 'citrus',
                    keywords: ['wellness', 'health', 'vitamin', 'natural', 'organic']
                },
                { 
                    icon: '🌸', 
                    circleClass: 'floral',
                    keywords: ['lifestyle', 'home', 'decor', 'living', 'style']
                },
                { 
                    icon: '💧', 
                    circleClass: 'ocean',
                    keywords: ['water', 'hydration', 'blue', 'fresh', 'clean']
                },
                { 
                    icon: '✨', 
                    circleClass: 'earth',
                    keywords: ['luxury', 'premium', 'gold', 'special', 'exclusive']
                },
                { 
                    icon: '🌿', 
                    circleClass: 'sunset',
                    keywords: ['green', 'eco', 'nature', 'plant', 'sustainable']
                }
            ];
            
            // Add real collections as categories (limit to 4 for optimal layout)
            const displayCollections = collections.slice(0, 4);
            
            displayCollections.forEach((collection, index) => {
                const categoryCard = document.createElement('div');
                categoryCard.className = 'category-card';
                categoryCard.onclick = () => showCategory(collection.handle);
                
                // Smart icon selection based on collection title/handle
                let selectedStyle = categoryStyles[index % categoryStyles.length];
                
                // Try to match collection name with appropriate style
                const collectionText = (collection.title + ' ' + collection.handle).toLowerCase();
                for (const style of categoryStyles) {
                    if (style.keywords.some(keyword => collectionText.includes(keyword))) {
                        selectedStyle = style;
                        break;
                    }
                }
                
                categoryCard.innerHTML = `
                    <div class="category-circle ${selectedStyle.circleClass}">
                        <div class="category-icon">${selectedStyle.icon}</div>
                    </div>
                    <div class="category-name">${collection.title}</div>
                `;
                
                categoriesGrid.appendChild(categoryCard);
            });
            
            console.log('✅ Updated categories with beautiful circular design from Shopify collections');
        }

        // WebSocket connection for live updates
        function connectWebSocket() {
            try {
                const ws = new WebSocket('ws://localhost:8081');
                
                ws.onopen = function() {
                    console.log('🔗 Connected to live rendering system');
                    
                    // Send authentication (simple for development)
                    ws.send(JSON.stringify({
                        type: 'auth',
                        payload: {
                            shop: 'development',
                            token: 'dev_token'
                        }
                    }));
                };
                
                ws.onmessage = function(event) {
                    try {
                        const data = JSON.parse(event.data);
                        console.log('📡 WebSocket message received:', data);
                        
                        if (data.type === 'config_update') {
                            console.log('🔄 Configuration update received');
                            appConfig = { ...appConfig, ...data.payload };
                            updateUIFromConfig();
                        } else if (data.type === 'auth_success') {
                            console.log('✅ WebSocket authenticated');
                        } else if (data.type === 'ping') {
                            // Respond to ping
                            ws.send(JSON.stringify({ type: 'pong' }));
                        }
                    } catch (error) {
                        console.error('Error processing WebSocket message:', error);
                    }
                };
                
                ws.onclose = function() {
                    console.log('❌ Disconnected from live rendering system');
                    
                    // Attempt to reconnect after 3 seconds
                    setTimeout(() => {
                        console.log('🔄 Attempting to reconnect...');
                        connectWebSocket();
                    }, 3000);
                };
                
                ws.onerror = function(error) {
                    console.error('WebSocket error:', error);
                };
                
            } catch (error) {
                console.error('WebSocket connection failed:', error);
            }
        }





        // Menu state
        let isMenuOpen = false;

        // Header functions
        function toggleMenu() {
            if (isMenuOpen) {
                closeMenu();
            } else {
                openMenu();
            }
        }

        function openMenu() {
            const overlay = document.getElementById('menuOverlay');
            const menu = document.getElementById('slideMenu');
            const hamburger = document.querySelector('.hamburger-menu');
            
            if (overlay && menu && hamburger) {
                isMenuOpen = true;
                
                // Show overlay
                overlay.classList.add('active');
                
                // Show menu with slide animation
                menu.classList.add('active');
                
                // Transform hamburger to X
                hamburger.classList.add('active');
                
                // Prevent background scrolling
                document.body.style.overflow = 'hidden';
                
                console.log('🎉 Menu opened with cool animations!');
            }
        }

        function closeMenu() {
            const overlay = document.getElementById('menuOverlay');
            const menu = document.getElementById('slideMenu');
            const hamburger = document.querySelector('.hamburger-menu');
            
            if (overlay && menu && hamburger) {
                isMenuOpen = false;
                
                // Hide overlay
                overlay.classList.remove('active');
                
                // Hide menu with slide animation
                menu.classList.remove('active');
                
                // Transform X back to hamburger
                hamburger.classList.remove('active');
                
                // Restore background scrolling
                document.body.style.overflow = 'auto';
                
                console.log('✨ Menu closed smoothly!');
            }
        }

        function menuItemClick(section) {
            // Add a small delay to show the click animation
            setTimeout(() => {
                closeMenu();
                
                // Handle navigation based on section
                switch(section) {
                    case 'home':
                        scrollToTop();
                        console.log('🏠 Welcome to EyeJack Home!');
                        break;
                    case 'collections':
                        if (appConfig.header?.selectedMenu === 'collections') {
                            loadCollectionsMenu();
                        }
                        console.log('📂 Browsing Collections...');
                        break;
                    case 'products':
                        console.log('🛍️ Exploring All Products...');
                        break;
                    case 'categories':
                        const categoriesSection = document.getElementById('categoriesGrid');
                        if (categoriesSection) {
                            categoriesSection.scrollIntoView({ behavior: 'smooth' });
                        }
                        console.log('📱 Categories Section');
                        break;
                    case 'deals':
                        console.log('🎯 Special Deals & Offers!');
                        break;
                    case 'support':
                        console.log('💬 Customer Support - Coming Soon!');
                        break;
                    default:
                        console.log('🚀 Navigation: ' + section);
                }
            }, 150);
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Close menu when pressing Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && isMenuOpen) {
                closeMenu();
            }
        });

        // Close menu when clicking outside (handled by overlay click)

        // Touch gesture support for menu
        let touchStartX = 0;
        let touchStartY = 0;
        let isSwiping = false;

        document.addEventListener('touchstart', function(e) {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
            isSwiping = false;
        });

        document.addEventListener('touchmove', function(e) {
            if (!touchStartX || !touchStartY) return;
            
            const touchEndX = e.touches[0].clientX;
            const touchEndY = e.touches[0].clientY;
            
            const deltaX = touchEndX - touchStartX;
            const deltaY = touchEndY - touchStartY;
            
            // Check if it's a horizontal swipe (not vertical scroll)
            if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
                isSwiping = true;
                
                // Swipe from left edge to open menu
                if (deltaX > 100 && touchStartX < 50 && !isMenuOpen) {
                    openMenu();
                    e.preventDefault();
            }
                
                // Swipe left to close menu when menu is open
                if (deltaX < -100 && isMenuOpen) {
                    closeMenu();
                    e.preventDefault();
                }
            }
        });

        document.addEventListener('touchend', function() {
            touchStartX = 0;
            touchStartY = 0;
            isSwiping = false;
        });

        function showSearch() {
            openSearchModal();
        }

        function showProfile() {
            console.log('👤 Profile page coming soon!');
        }

        function showCart() {
            showCartModal();
        }

        // Cart Modal Functions
        function showCartModal() {
            const modal = document.getElementById('cartModal');
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            setTimeout(() => {
                modal.classList.add('active');
            }, 10);
            
            loadCartContent();
        }

        function closeCartModal() {
            const modal = document.getElementById('cartModal');
            modal.classList.remove('active');
            
            setTimeout(() => {
                modal.style.display = 'none';
                document.body.style.overflow = '';
            }, 300);
        }

        function loadCartContent() {
            const cartContent = document.getElementById('cartContent');
            
            if (!currentCart || !cartItems || cartItems.length === 0) {
                cartContent.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-shopping-cart" style="font-size: 48px; color: #ccc; margin-bottom: 16px;"></i>
                        <h3>Your cart is empty</h3>
                        <p>Add some products to get started!</p>
                    </div>
                `;
                updateCartBadge(0);
                return;
            }

            let cartHTML = `
                <div class="cart-items">
                    ${cartItems.map(item => `
                        <div class="cart-item" data-variant-id="${item.variantId}">
                            <div class="cart-item-image">
                                <img src="${item.image || 'https://via.placeholder.com/80x80/f5f5f5/999?text=No+Image'}" alt="${item.title}" onerror="this.src='https://via.placeholder.com/80x80/f5f5f5/999?text=No+Image'">
                            </div>
                            <div class="cart-item-details">
                                <h4>${item.title}</h4>
                                <p class="cart-item-price">₹${parseFloat(item.price).toFixed(2)}</p>
                                <div class="cart-item-quantity">
                                    <button class="quantity-btn" onclick="updateCartQuantity('${item.variantId}', ${item.quantity - 1})">
                                        <i class="fas fa-minus"></i>
                                    </button>
                                    <span class="quantity">${item.quantity}</span>
                                    <button class="quantity-btn" onclick="updateCartQuantity('${item.variantId}', ${item.quantity + 1})">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="cart-item-actions">
                                <button class="remove-item-btn" onclick="removeFromCart('${item.variantId}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `).join('')}
                </div>
                <div class="cart-summary">
                    <div class="cart-total">
                        <div class="total-row">
                            <span>Subtotal:</span>
                            <span>₹${parseFloat(currentCart.subtotalAmount.amount).toFixed(2)}</span>
                        </div>
                        ${currentCart.taxes && currentCart.taxes.length > 0 && parseFloat(currentCart.taxes[0].amount) > 0 ? `
                        <div class="total-row">
                            <span>Tax:</span>
                            <span>₹${parseFloat(currentCart.taxes[0].amount).toFixed(2)}</span>
                        </div>
                        ` : ''}
                        <div class="total-row total-final">
                            <span><strong>Total:</strong></span>
                            <span><strong>₹${parseFloat(currentCart.totalAmount.amount).toFixed(2)}</strong></span>
                        </div>
                    </div>
                    <div class="cart-actions">
                        <button class="btn secondary" onclick="closeCartModal()">Continue Shopping</button>
                        <button class="btn primary" onclick="checkout()">Proceed to Checkout</button>
                    </div>
                </div>
            `;

            cartContent.innerHTML = cartHTML;
            
            // Update cart badge with total quantity
            const totalQuantity = cartItems.reduce((total, item) => total + item.quantity, 0);
            updateCartBadge(totalQuantity);
        }

        // Update cart badge
        function updateCartBadge(count) {
            // Update main cart badge
            const badge = document.getElementById('cartBadge');
            if (badge) {
                badge.textContent = count;
                badge.style.display = 'flex';
                if (count > 0) {
                    badge.style.background = '#ef4444';
                    badge.style.opacity = '1';
                    badge.style.transform = 'scale(1)';
                    badge.style.animation = 'cartBadgePulse 0.3s ease-out';
                } else {
                    badge.style.background = '#6b7280';
                    badge.style.opacity = '0.8';
                    badge.style.transform = 'scale(0.9)';
                    badge.style.animation = 'none';
                }
            }
            
            // Update product detail cart badge
            const detailBadge = document.getElementById('cartBadgeDetail');
            if (detailBadge) {
                detailBadge.textContent = count;
                detailBadge.style.display = 'flex';
                if (count > 0) {
                    detailBadge.style.background = '#ef4444';
                    detailBadge.style.opacity = '1';
                    detailBadge.style.transform = 'scale(1)';
                    detailBadge.style.animation = 'cartBadgePulse 0.3s ease-out';
                } else {
                    detailBadge.style.background = '#6b7280';
                    detailBadge.style.opacity = '0.8';
                    detailBadge.style.transform = 'scale(0.9)';
                    detailBadge.style.animation = 'none';
                }
            }
        }

        // Splash Screen Functions
        let splashScreenHidden = false;
        function hideSplashScreen() {
            if (splashScreenHidden) return; // Prevent multiple calls
            
            const splashScreen = document.getElementById('splashScreen');
            if (splashScreen) {
                splashScreenHidden = true;
                console.log('🎨 Hiding splash screen...');
                // Add fade-out class after a minimum delay to show the splash screen
                setTimeout(() => {
                    splashScreen.classList.add('fade-out');
                    // Remove splash screen from DOM after animation completes
                    setTimeout(() => {
                        splashScreen.remove();
                        document.body.classList.remove('splash-active');
                        console.log('✅ Splash screen removed');
                    }, 500);
                }, 1500); // Show splash for at least 1.5 seconds
            }
        }

        // Add splash-active class to body initially
        document.body.classList.add('splash-active');

        // Also hide splash screen when everything is fully loaded
        window.addEventListener('load', function() {
            setTimeout(() => {
                hideSplashScreen();
            }, 500);
        });

        // Announcement bar navigation with auto-slider
        let announcements = [
            "Free shipping on orders ₹50+",
            "🎉 Flash Sale - 50% OFF!",
            "✨ Get 20% off - WELCOME20",
            "🚚 Same-day delivery"
        ];
        let currentAnnouncementIndex = 0;
        let announcementInterval = null;
        let announcementConfig = {
            autoSlide: true,
            slideInterval: 4000, // 4 seconds
            showNavigation: true
        };

        function initializeAnnouncementSlider() {
            console.log('Initializing announcement slider...');
            console.log('Announcements:', announcements);
            
            // Set initial text content
            const announcementTextContent = document.querySelector('.announcement-text-content');
            if (announcementTextContent && announcements.length > 0) {
                announcementTextContent.textContent = announcements[currentAnnouncementIndex];
                announcementTextContent.style.visibility = 'visible';
                announcementTextContent.style.opacity = '1';
                console.log('Set initial text to:', announcements[currentAnnouncementIndex]);
            }
            
            if (announcementConfig.autoSlide && announcements.length > 1) {
                startAnnouncementAutoSlide();
            }
            updateAnnouncementDisplay();
            
            // Initial setup
            setTimeout(() => {
                adjustAnnouncementBarHeight();
                checkTextOverflow();
            }, 200);
        }

        function startAnnouncementAutoSlide() {
            if (announcementInterval) {
                clearInterval(announcementInterval);
            }
            
            announcementInterval = setInterval(() => {
                nextAnnouncement();
            }, announcementConfig.slideInterval);
        }

        function stopAnnouncementAutoSlide() {
            if (announcementInterval) {
                clearInterval(announcementInterval);
                announcementInterval = null;
            }
        }

        function previousAnnouncement() {
            // Stop auto-slide temporarily when user manually navigates
            stopAnnouncementAutoSlide();
            currentAnnouncementIndex = (currentAnnouncementIndex - 1 + announcements.length) % announcements.length;
            updateAnnouncementText();
            
            // Restart auto-slide after a delay
            if (announcementConfig.autoSlide && announcements.length > 1) {
                setTimeout(() => {
                    startAnnouncementAutoSlide();
                }, 3000);
            }
        }

        function nextAnnouncement() {
            currentAnnouncementIndex = (currentAnnouncementIndex + 1) % announcements.length;
            updateAnnouncementText();
        }

        function updateAnnouncementText() {
            const announcementText = document.querySelector('.announcement-text');
            const announcementTextContent = document.querySelector('.announcement-text-content');
            
            console.log('Updating announcement text...');
            console.log('Current index:', currentAnnouncementIndex);
            console.log('Announcements array:', announcements);
            
            if (announcementText && announcementTextContent) {
                announcementText.style.opacity = '0';
                setTimeout(() => {
                    if (announcements.length > 0) {
                        const textToShow = announcements[currentAnnouncementIndex];
                        console.log('Setting text to:', textToShow);
                        announcementTextContent.textContent = textToShow;
                        announcementTextContent.style.visibility = 'visible';
                        announcementTextContent.style.opacity = '1';
                        
                        // Check if text needs multiline animation
                        setTimeout(() => {
                            checkTextOverflow();
                        }, 50);
                    }
                    announcementText.style.opacity = '1';
                    
                    // Adjust height after text change
                    setTimeout(() => {
                        adjustAnnouncementBarHeight();
                    }, 100);
                }, 200);
            } else {
                console.log('Could not find announcement text elements');
            }
        }

        function checkTextOverflow() {
            const announcementTextContent = document.querySelector('.announcement-text-content');
            const announcementText = document.querySelector('.announcement-text');
            const announcementBar = document.querySelector('.announcement-bar');
            
            if (!announcementTextContent || !announcementText || !announcementBar) {
                console.log('Text elements not found');
                return;
        }

            // Remove any existing multiline class and reset styles
            announcementTextContent.classList.remove('multiline');
            announcementTextContent.style.whiteSpace = 'nowrap';
            announcementTextContent.style.animation = 'none';
            announcementTextContent.style.visibility = 'visible';
            announcementTextContent.style.opacity = '1';
            
            // Force reflow to get accurate measurements
            announcementTextContent.offsetHeight;
            
            // Get the available width (bar width minus arrow space and padding)
            const barWidth = announcementBar.clientWidth;
            const textWidth = announcementTextContent.scrollWidth;
            
            // Account for arrow width and safe margins
            const screenWidth = window.innerWidth;
            let arrowSpace = 120; // Space for both arrows and margins
            
            if (screenWidth <= 320) {
                arrowSpace = 100; // Smaller screens
            } else if (screenWidth <= 375) {
                arrowSpace = 110; // Medium screens
            }
            
            const availableWidth = barWidth - arrowSpace;
            
            console.log(`Bar width: ${barWidth}px, Available width: ${availableWidth}px, Text width: ${textWidth}px, Text: "${announcementTextContent.textContent}"`);
            
            // If text overflows the available space
            if (textWidth > availableWidth && availableWidth > 0) {
                // Enable multiline with scrolling animation
                announcementTextContent.style.whiteSpace = 'normal';
                announcementTextContent.classList.add('multiline');
                
                console.log(`Text overflow detected: ${textWidth}px > ${availableWidth}px - enabling multiline`);
            } else {
                // Text fits in one line
                console.log(`Text fits: ${textWidth}px <= ${availableWidth}px - single line`);
            }
        }

        function adjustAnnouncementBarHeight() {
            const announcementBar = document.getElementById('announcementBar');
            
            if (announcementBar) {
                // Ensure adequate height for text visibility
                const minHeight = Math.max(parseInt(announcementBar.style.minHeight) || 60, 60);
                announcementBar.style.height = minHeight + 'px';
                announcementBar.style.minHeight = minHeight + 'px';
                
                // Force proper display
                announcementBar.style.display = 'flex';
                announcementBar.style.alignItems = 'center';
                announcementBar.style.justifyContent = 'center';
            }
        }

        function updateAnnouncementDisplay() {
            const announcementBar = document.getElementById('announcementBar');
            const navButtons = document.querySelectorAll('.announcement-nav');
            
            if (announcementBar) {
                announcementBar.style.display = announcements.length > 0 ? 'flex' : 'none';
            }
            
            // Show/hide navigation arrows based on configuration
            navButtons.forEach(button => {
                button.style.display = (announcementConfig.showNavigation && announcements.length > 1) ? 'flex' : 'none';
            });
        }

        function updateAnnouncementsFromConfig(config) {
            if (config.announcementBar && config.announcementBar.announcements) {
                announcements = config.announcementBar.announcements;
                announcementConfig.autoSlide = config.announcementBar.autoSlide !== false;
                announcementConfig.slideInterval = config.announcementBar.slideInterval || 4000;
                announcementConfig.showNavigation = config.announcementBar.showNavigation !== false;
                
                // Reset to first announcement
                currentAnnouncementIndex = 0;
                
                                // Update current text immediately
                const announcementTextContent = document.querySelector('.announcement-text-content');
                if (announcementTextContent && announcements.length > 0) {
                    announcementTextContent.textContent = announcements[0];
                    announcementTextContent.style.visibility = 'visible';
                    announcementTextContent.style.opacity = '1';
                    console.log('Updated text from config to:', announcements[0]);
                    setTimeout(() => {
                        checkTextOverflow();
                    }, 100);
                }
                
                // Restart slider with new configuration
                stopAnnouncementAutoSlide();
                initializeAnnouncementSlider();
            }
        }

        // Logo error handling
        function handleLogoError(img) {
            console.warn('❌ Logo failed to load, switching to text logo');
            const logoContainer = img.parentElement;
            const title = appConfig.header?.title || 'EyeJack';
            logoContainer.innerHTML = `<span class="logo-text">${title}</span>`;
        }

        // Navigation functions (moved to end with search functionality)

        function exploreProducts() {
            console.log('🛍️ Exploring products...');
        }

        function showCollections() {
            console.log('📂 Collections page coming soon!');
        }

        function showBestSellers() {
            console.log('⭐ Best sellers section highlighted!');
        }

        function showCategory(category) {
            console.log(`📱 ${category.charAt(0).toUpperCase() + category.slice(1)} category selected!`);
        }

        function showAllCategories() {
            console.log('📂 All categories page coming soon!');
        }

        function showAllNewArrivals() {
            console.log('✨ All new arrivals page coming soon!');
        }

        function showAllBestSellers() {
            console.log('⭐ All best sellers page coming soon!');
        }

        // Removed duplicate showProduct function - using the async version below

        // Cart state management
        let currentCart = null;
        let cartItems = [];

        async function addToCart(productId, quantity = 1) {
            try {
                console.log(`🛒 Adding product ${productId} to cart...`);
                
                // Find the product to get variant ID
                const product = await getProductDetails(productId);
                if (!product || !product.variants || product.variants.length === 0) {
                    console.error('Product or variants not found');
                    return;
                }

                const variantId = product.variants[0].id; // Use first variant for now
                const customerAccessToken = JSON.parse(localStorage.getItem('customerAccessToken') || 'null');
                const currentUser = JSON.parse(localStorage.getItem('firebaseUser') || 'null');

                const formData = new FormData();
                formData.append('action', currentCart ? 'update' : 'create');
                formData.append('variantId', variantId);
                formData.append('quantity', quantity.toString());
                
                if (currentCart) {
                    formData.append('cartId', currentCart.id);
                    formData.append('updateAction', 'add');
                }

                if (customerAccessToken?.accessToken) {
                    formData.append('customerAccessToken', customerAccessToken.accessToken);
                } else if (currentUser?.email) {
                    formData.append('customerEmail', currentUser.email);
                }

                const response = await fetch(`${CONFIG.apiUrl}/cart`, {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (data.success) {
                    currentCart = data.cart;
                    updateCartFromStorefront(data.cart);
                    console.log('✅ Product added to cart successfully');
                    
                    // Show cart badge update
                    const totalItems = data.cart.lines.reduce((sum, line) => sum + line.quantity, 0);
                    updateCartBadge(totalItems);
                } else {
                    console.error('Failed to add to cart:', data.error);
                }
            } catch (error) {
                console.error('Error adding to cart:', error);
            }
        }

        // Get product details for cart functionality - ALWAYS fetch fresh data for real-time prices
        async function getProductDetails(productId) {
            try {
                console.log(`🔍 Fetching FRESH product details for ID: "${productId}"`);
                
                // ALWAYS fetch fresh data from API to ensure real-time prices (same as homepage)
                const cacheBuster = Date.now();
                const response = await fetch(`${CONFIG.apiUrl}/shopify-products?type=products&limit=20&_=${cacheBuster}`, {
                    headers: {
                        'Cache-Control': 'no-cache, no-store, must-revalidate',
                        'Pragma': 'no-cache',
                        'Expires': '0'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`Failed to fetch fresh product data: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.success && data.products) {
                    const product = data.products.find(p => p.id === productId);
                    if (product) {
                        // Check if product has proper variants data
                        if (product.variants?.edges?.length > 0) {
                            return {
                                id: product.id,
                                title: product.title,
                                handle: product.handle,
                                description: product.description,
                                images: product.images,
                                priceRangeV2: product.priceRangeV2,
                                variants: product.variants.edges.map(edge => edge.node)
                            };
                        } else {
                            console.warn('Product found but no variants available:', productId);
                            return null;
                        }
                    }
                }
                
                console.warn('Product not found:', productId);
                return null;
            } catch (error) {
                console.error('Error fetching product details:', error);
                return null;
            }
        }

        // Update cart state from Storefront cart
        function updateCartFromStorefront(cart) {
            cartItems = cart.lines.map(line => {
                // Get image from product
                const productImage = line.merchandise.product.images?.edges?.[0]?.node?.url;
                const fallbackImage = 'https://via.placeholder.com/80x80/f5f5f5/999?text=No+Image';
                
                return {
                    id: line.id,
                    variantId: line.merchandise.id,
                    productId: line.merchandise.product.id,
                    title: line.merchandise.title,
                    quantity: line.quantity,
                    price: line.merchandise.price.amount,
                    image: productImage || fallbackImage,
                    product: line.merchandise.product
                };
            });

            // Save to localStorage for persistence
            localStorage.setItem('currentCart', JSON.stringify(cart));
            localStorage.setItem('cartItems', JSON.stringify(cartItems));
        }

        // Load cart from localStorage on page load
        function loadSavedCart() {
            try {
                const savedCart = localStorage.getItem('currentCart');
                const savedCartItems = localStorage.getItem('cartItems');
                
                if (savedCart && savedCartItems) {
                    currentCart = JSON.parse(savedCart);
                    cartItems = JSON.parse(savedCartItems);
                    
                    // Update cart badge
                    const totalItems = cartItems.reduce((sum, item) => sum + item.quantity, 0);
                    updateCartBadge(totalItems);
                    
                    console.log('📦 Cart loaded from storage:', totalItems, 'items');
                }
            } catch (error) {
                console.error('Error loading saved cart:', error);
                clearCart();
            }
        }

        // Remove item from cart
        async function removeFromCart(variantId) {
            if (!currentCart) return;

            try {
                const formData = new FormData();
                formData.append('action', 'update');
                formData.append('cartId', currentCart.id);
                formData.append('variantId', variantId);
                formData.append('updateAction', 'remove');

                const response = await fetch(`${CONFIG.apiUrl}/cart`, {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (data.success) {
                    if (data.cart === null || data.cart.lines.length === 0) {
                        // Cart was completely cleared
                        clearCart();
                        console.log('✅ Cart cleared - last item removed');
                    } else {
                        currentCart = data.cart;
                        updateCartFromStorefront(data.cart);
                        
                        const totalItems = data.cart.lines.reduce((sum, line) => sum + line.quantity, 0);
                        updateCartBadge(totalItems);
                        
                        console.log('✅ Item removed from cart');
                    }
                    
                    // Refresh cart display if open
                    if (document.getElementById('cartModal')?.classList.contains('active')) {
                        showCartModal();
                    }
                } else {
                    console.error('Failed to remove from cart:', data.error);
                }
            } catch (error) {
                console.error('Error removing from cart:', error);
            }
        }

        // Update item quantity in cart
        async function updateCartQuantity(variantId, newQuantity) {
            if (!currentCart) return;

            try {
                const formData = new FormData();
                formData.append('action', 'update');
                formData.append('cartId', currentCart.id);
                formData.append('variantId', variantId);
                formData.append('quantity', newQuantity.toString());
                formData.append('updateAction', 'update_quantity');

                const response = await fetch(`${CONFIG.apiUrl}/cart`, {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();

                if (data.success) {
                    if (data.cart === null || data.cart.lines.length === 0) {
                        // Cart was completely cleared
                        clearCart();
                        console.log('✅ Cart cleared - quantity set to 0');
                    } else {
                        currentCart = data.cart;
                        updateCartFromStorefront(data.cart);
                        
                        const totalItems = data.cart.lines.reduce((sum, line) => sum + line.quantity, 0);
                        updateCartBadge(totalItems);
                        
                        console.log('✅ Cart quantity updated');
                    }
                    
                    // Refresh cart display if open
                    if (document.getElementById('cartModal')?.classList.contains('active')) {
                        showCartModal();
                    }
                } else {
                    console.error('Failed to update cart quantity:', data.error);
                }
            } catch (error) {
                console.error('Error updating cart quantity:', error);
            }
        }

        // Clear cart
        function clearCart() {
            currentCart = null;
            cartItems = [];
            updateCartBadge(0);
            localStorage.removeItem('currentCart');
            localStorage.removeItem('cartItems');
            
            // Close cart modal if it's open
            const cartModal = document.getElementById('cartModal');
            if (cartModal && cartModal.classList.contains('active')) {
                closeCartModal();
            }
            
            console.log('🗑️ Cart cleared');
        }

        // Complete checkout (redirect to Shopify checkout)
        async function checkout() {
            if (!currentCart) {
                console.warn('No cart to checkout');
                return;
            }

            try {
                // For Storefront API, we redirect to the checkout URL
                if (currentCart.checkoutUrl) {
                    console.log('🛒 Redirecting to checkout:', currentCart.checkoutUrl);
                    window.location.href = currentCart.checkoutUrl;
                } else {
                    console.error('No checkout URL available');
                    alert('Checkout URL not available. Please try again.');
                }
            } catch (error) {
                console.error('Error during checkout:', error);
                alert('Checkout error: ' + error.message);
            }
        }

        // Enhanced product card functions
        function changeProductImage(productId, direction) {
            const imageElement = document.querySelector(`[data-product-id="${productId}"]`);
            if (!imageElement) return;
            
            const currentIndex = parseInt(imageElement.dataset.currentImage);
            const totalImages = 3; // For demo purposes
            
            let newIndex;
            if (direction > 0) {
                newIndex = (currentIndex + 1) % totalImages;
            } else {
                newIndex = (currentIndex - 1 + totalImages) % totalImages;
            }
            
            setProductImage(productId, newIndex);
        }

        function setProductImage(productId, imageIndex) {
            const imageElement = document.querySelector(`[data-product-id="${productId}"]`);
            const dotsContainer = imageElement.parentElement.querySelector('.image-dots');
            
            if (!imageElement || !dotsContainer) return;
            
            // Update image (for demo, we'll just change opacity to show transition)
            imageElement.style.opacity = '0.7';
            setTimeout(() => {
                imageElement.dataset.currentImage = imageIndex;
                imageElement.style.opacity = '1';
            }, 150);
            
            // Update dots
            const dots = dotsContainer.querySelectorAll('.image-dot');
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === imageIndex);
            });
        }

        function selectSize(productId) {
            console.log('📏 Size selection coming soon! This feature will let you choose product variants.');
        }

        function showError(containerId) {
            const container = document.getElementById(containerId);
            container.innerHTML = '<div style="text-align: center; color: #ef4444; padding: 20px;">Failed to load products</div>';
        }

        // Touch gestures for mobile - specific to hero slider only
        let startX = 0;
        let currentX = 0;
        let isScrolling = false;

        // Get the hero slider element and only attach swipe handlers to it
        const heroSliderElement = document.getElementById('heroSlider');
        
        if (heroSliderElement) {
            heroSliderElement.addEventListener('touchstart', function(e) {
            startX = e.touches[0].clientX;
        });

            heroSliderElement.addEventListener('touchmove', function(e) {
            if (!isScrolling) {
                currentX = e.touches[0].clientX;
            }
        });

            heroSliderElement.addEventListener('touchend', function(e) {
            if (!isScrolling) {
                const diffX = startX - currentX;
                if (Math.abs(diffX) > 50) { // Minimum swipe distance
                        const slides = document.querySelectorAll('.hero-slide');
                        const slideCount = slides.length;
                        if (slideCount > 0) {
                    if (diffX > 0) {
                        // Swipe left - next slide
                                currentSlide = (currentSlide + 1) % slideCount;
                    } else {
                        // Swipe right - previous slide
                                currentSlide = (currentSlide - 1 + slideCount) % slideCount;
                    }
                    updateSlider();
                        }
                }
            }
        });
        }

        // Add scroll detection for horizontal product lists
        document.querySelectorAll('.products-horizontal').forEach(container => {
            container.addEventListener('touchstart', () => isScrolling = true);
            container.addEventListener('touchend', () => isScrolling = false);
        });

        // Search functionality
        let searchResults = [];
        let searchDebounceTimer = null;

        function openSearchModal() {
            const modal = document.getElementById('searchModal');
            const input = document.getElementById('searchInput');
            
            modal.classList.add('active');
            setTimeout(() => {
                input.focus();
            }, 300);
            
            // Show suggestions initially
            showSearchSuggestions();
            
            // Setup search input handlers
            if (!input.hasSearchListeners) {
                input.addEventListener('input', handleSearchInput);
                input.addEventListener('keydown', handleSearchKeydown);
                input.hasSearchListeners = true;
            }
        }

        function closeSearchModal() {
            const modal = document.getElementById('searchModal');
            modal.classList.remove('active');
            
            // Clear search
            clearSearch();
        }

        function clearSearch() {
            const input = document.getElementById('searchInput');
            const clearBtn = document.getElementById('searchClear');
            
            input.value = '';
            clearBtn.classList.remove('visible');
            
            // Show suggestions again
            showSearchSuggestions();
            hideSearchResults();
        }

        function handleSearchInput(e) {
            const query = e.target.value.trim();
            const clearBtn = document.getElementById('searchClear');
            
            // Show/hide clear button
            if (query.length > 0) {
                clearBtn.classList.add('visible');
            } else {
                clearBtn.classList.remove('visible');
                showSearchSuggestions();
                hideSearchResults();
                return;
            }
            
            // Debounce search
            if (searchDebounceTimer) {
                clearTimeout(searchDebounceTimer);
            }
            
            searchDebounceTimer = setTimeout(() => {
                if (query.length >= 2) {
                    performSearch(query);
                }
            }, 500);
        }

        function handleSearchKeydown(e) {
            if (e.key === 'Enter') {
                const query = e.target.value.trim();
                if (query.length >= 2) {
                    performSearch(query);
                }
            } else if (e.key === 'Escape') {
                closeSearchModal();
            } else if (e.key === 'ArrowDown') {
                e.preventDefault();
                // Focus first search result if any
                const firstResult = document.querySelector('.search-product-card');
                if (firstResult) {
                    firstResult.focus();
                }
            }
        }

        async function performSearch(query) {
            console.log('🔍 Performing search for:', query);
            
            // Update input if search was triggered by suggestion
            const input = document.getElementById('searchInput');
            if (input.value.trim() !== query) {
                input.value = query;
                document.getElementById('searchClear').classList.add('visible');
            }
            
            // Hide suggestions and show loading
            hideSearchSuggestions();
            showSearchLoading();
            
            try {
                const response = await fetch(`${CONFIG.apiUrl}/search-products?q=${encodeURIComponent(query)}&limit=20`);
                const data = await response.json();
                
                hideSearchLoading();
                
                if (data.success && data.products) {
                    searchResults = data.products;
                    displaySearchResults(data.products, query);
                    console.log(`🔍 Found ${data.products.length} products for "${query}"`);
                } else {
                    searchResults = [];
                    showSearchEmpty();
                    console.error(`❌ ${data.error || 'Search failed'}`);
                }
                
            } catch (error) {
                console.error('Search error:', error);
                hideSearchLoading();
                showSearchEmpty();
                console.error('❌ Search failed. Please try again.');
            }
        }

        function displaySearchResults(products, query) {
            const resultsList = document.getElementById('searchResultsList');
            const resultsCount = document.getElementById('searchResultsCount');
            const resultsContainer = document.getElementById('searchResults');
            
            // Update count
            resultsCount.textContent = `${products.length} result${products.length !== 1 ? 's' : ''} for "${query}"`;
            
            // Clear previous results
            resultsList.innerHTML = '';
            
            if (products.length === 0) {
                showSearchEmpty();
                return;
            }
            
            // Create product cards
            products.forEach(product => {
                const productCard = createSearchProductCard(product);
                resultsList.appendChild(productCard);
            });
            
            // Show results container
            resultsContainer.style.display = 'block';
        }

        function createSearchProductCard(product) {
            const card = document.createElement('div');
            card.className = 'search-product-card';
            card.tabIndex = 0; // Make focusable
            card.onclick = () => {
                showProduct(product.id);
                closeSearchModal();
            };
            
            // Keyboard navigation
            card.onkeydown = (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    showProduct(product.id);
                    closeSearchModal();
                } else if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    const nextCard = card.nextElementSibling;
                    if (nextCard && nextCard.classList.contains('search-product-card')) {
                        nextCard.focus();
                    }
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    const prevCard = card.previousElementSibling;
                    if (prevCard && prevCard.classList.contains('search-product-card')) {
                        prevCard.focus();
                    } else {
                        // Go back to search input
                        document.getElementById('searchInput').focus();
                    }
                } else if (e.key === 'Escape') {
                    closeSearchModal();
                }
            };
            
            const imageUrl = product.image?.url || 'https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=300&h=300&fit=crop';
            const price = product.variant?.price ? `₹${product.variant.price.amount}` : 'Price not available';
            const compareAtPrice = product.variant?.compareAtPrice ? `₹${product.variant.compareAtPrice.amount}` : null;
            const onSale = product.variant?.onSale || false;
            
            card.innerHTML = `
                <div class="search-product-image" style="background-image: url('${imageUrl}')"></div>
                <div class="search-product-info">
                    <div class="search-product-title">${product.title}</div>
                    <div class="search-product-vendor">${product.vendor}</div>
                    <div class="search-product-price">
                        <span class="search-product-current-price">${price}</span>
                        ${compareAtPrice ? `<span class="search-product-original-price">${compareAtPrice}</span>` : ''}
                        ${onSale ? '<span class="search-product-sale-badge">SALE</span>' : ''}
                    </div>
                    <button class="search-product-add-cart" onclick="event.stopPropagation(); addToCartFromSearch('${product.id}')">
                        Add to Cart
                    </button>
                </div>
            `;
            
            return card;
        }

        async function addToCartFromSearch(productId) {
            // Use the same cart functionality
            await addToCart(productId, 1);
            // Update cart content and badge
            loadCartContent();
        }

        // Wrapper function for general add to cart with badge update
        async function addToCartAndUpdate(productId, quantity = 1) {
            await addToCart(productId, quantity);
            loadCartContent();
        }

        function sortSearchResults() {
            const sortValue = document.getElementById('searchSort').value;
            
            if (searchResults.length === 0) return;
            
            let sortedResults = [...searchResults];
            
            switch (sortValue) {
                case 'price_low':
                    sortedResults.sort((a, b) => {
                        const priceA = parseFloat(a.variant?.price?.amount || 0);
                        const priceB = parseFloat(b.variant?.price?.amount || 0);
                        return priceA - priceB;
                    });
                    break;
                case 'price_high':
                    sortedResults.sort((a, b) => {
                        const priceA = parseFloat(a.variant?.price?.amount || 0);
                        const priceB = parseFloat(b.variant?.price?.amount || 0);
                        return priceB - priceA;
                    });
                    break;
                case 'title':
                    sortedResults.sort((a, b) => a.title.localeCompare(b.title));
                    break;
                default: // relevance
                    // Keep original order
                    break;
            }
            
            const resultsList = document.getElementById('searchResultsList');
            resultsList.innerHTML = '';
            
            sortedResults.forEach(product => {
                const productCard = createSearchProductCard(product);
                resultsList.appendChild(productCard);
            });
            
            console.log(`📊 Results sorted by ${sortValue === 'price_low' ? 'price (low to high)' : sortValue === 'price_high' ? 'price (high to low)' : sortValue}`);
        }

        function showSearchSuggestions() {
            document.getElementById('searchSuggestions').classList.add('visible');
            hideSearchResults();
        }

        function hideSearchSuggestions() {
            document.getElementById('searchSuggestions').classList.remove('visible');
        }

        function showSearchLoading() {
            document.getElementById('searchLoading').style.display = 'block';
            hideSearchResults();
            document.getElementById('searchEmpty').style.display = 'none';
        }

        function hideSearchLoading() {
            document.getElementById('searchLoading').style.display = 'none';
        }

        function showSearchEmpty() {
            document.getElementById('searchEmpty').style.display = 'block';
            hideSearchResults();
        }

        function hideSearchResults() {
            document.getElementById('searchResults').style.display = 'none';
            document.getElementById('searchEmpty').style.display = 'none';
        }

        // Navigation function to trigger search from bottom nav
        function setActiveNav(index, page) {
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach((item, i) => {
                item.classList.toggle('active', i === index);
            });
            
            if (page === 'search') {
                openSearchModal();
            } else {
                console.log(`Navigating to ${page} page`);
                console.log(`Navigated to ${page.charAt(0).toUpperCase() + page.slice(1)} page`);
            }
        }

        // ===== FIREBASE AUTHENTICATION SYSTEM =====
        
        // Firebase Configuration ✅ CONFIGURED
        const firebaseConfig = {
            apiKey: "AIzaSyCd9O3gJOoD7HvoMzgIKTOi1nPIi-z_Cds",
            authDomain: "eyejack-mobileapp.firebaseapp.com",
            projectId: "eyejack-mobileapp",
            storageBucket: "eyejack-mobileapp.firebasestorage.app",
            messagingSenderId: "43495560741",
            appId: "1:43495560741:web:6101cca71fd1c8e6e451cc",
            measurementId: "G-W7E03MV4TD"
        };

        // Initialize Firebase (with error handling)
        let auth = null;
        let firebaseInitialized = false;
        
        try {
            firebase.initializeApp(firebaseConfig);
            auth = firebase.auth();
            firebaseInitialized = true;
            console.log('✅ Firebase initialized successfully');
        } catch (error) {
            console.log('⚠️ Firebase not configured properly:', error.message);
            console.log('📝 Please follow FIREBASE_QUICK_SETUP.md to configure Firebase');
            firebaseInitialized = false;
        }

        // Global authentication variables
        let currentConfirmationResult = null;
        let currentUser = null;
        let recaptchaVerifier = null;

        // Authentication state management
        if (firebaseInitialized && auth) {
            auth.onAuthStateChanged((user) => {
                if (user) {
                    console.log('🔐 User signed in:', user.uid);
                    currentUser = user;
                    handleAuthSuccess(user);
                } else {
                    console.log('👋 User signed out');
                    currentUser = null;
                    updateHeaderForLoggedOutUser();
                }
            });

            // Handle redirect results
            auth.getRedirectResult().then((result) => {
                if (result && result.user) {
                    console.log('✅ Authentication successful (redirect)');
                    processFirebaseUser(result.user);
                }
            }).catch((error) => {
                console.error('❌ Redirect authentication error:', error);
                if (error.code === 'auth/popup-closed-by-user') {
                    console.log('Sign in cancelled');
                } else if (!error.code || error.code === 'auth/network-request-failed') {
                    // Don't show error for network issues that might resolve
                    console.log('ℹ️ Network issue during redirect, will retry on next user action');
                } else {
                    console.error('Authentication failed. Please try again.');
                }
            });

            // Log helpful info about CORS warnings
            console.log('ℹ️ Note: CORS popup warnings are normal and don\'t affect functionality');
            console.log('ℹ️ If popups are blocked, the system will automatically use redirect method');
        } else {
            console.log('⚠️ Firebase authentication not available - please configure Firebase');
        }

        // Authentication Modal Functions
        function openAuthModal() {
            if (!firebaseInitialized) {
                console.warn('Firebase is loading, please try again in a moment.');
                return;
            }
            
            const modal = document.getElementById('authModal');
            modal.classList.add('active');
            showAuthOptions();
            document.body.style.overflow = 'hidden';
        }

        function closeAuthModal() {
            const modal = document.getElementById('authModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
            resetAuthModal();
        }

        function resetAuthModal() {
            showAuthOptions();
            resetPhoneForm();
            resetOTPForm();
        }

        function showAuthOptions() {
            hideAllAuthScreens();
            document.getElementById('authOptions').style.display = 'block';
        }

        function showPhoneLogin() {
            hideAllAuthScreens();
            document.getElementById('phoneLoginScreen').style.display = 'block';
            document.getElementById('phoneNumber').focus();
        }

        function showOTPVerification() {
            hideAllAuthScreens();
            document.getElementById('otpVerificationScreen').style.display = 'block';
            document.querySelector('.otp-digit').focus();
        }

        function showAuthLoading() {
            hideAllAuthScreens();
            document.getElementById('authLoadingScreen').style.display = 'block';
        }

        function hideAllAuthScreens() {
            const screens = document.querySelectorAll('.auth-screen');
            screens.forEach(screen => screen.style.display = 'none');
        }

        // Social Login Functions
        async function signInWithGoogle() {
            try {
                console.log('🔐 Google Sign In initiated');
                showAuthLoading();
                
                const provider = new firebase.auth.GoogleAuthProvider();
                provider.addScope('email');
                provider.addScope('profile');
                
                // Try popup first, fallback to redirect
                try {
                    const result = await auth.signInWithPopup(provider);
                    console.log('✅ Google authentication successful (popup)');
                    await processFirebaseUser(result.user);
                } catch (popupError) {
                    console.log('📱 Popup blocked, trying redirect method');
                    await auth.signInWithRedirect(provider);
                }
                
            } catch (error) {
                console.error('❌ Google Sign In error:', error);
                showAuthOptions();
                
                if (error.code === 'auth/popup-blocked') {
                    console.warn('Popup blocked. Please allow popups or try again.');
                } else if (error.code === 'auth/cancelled-popup-request') {
                    console.log('Sign in cancelled');
                } else {
                    console.error('Google sign in failed. Please try again.');
                }
            }
        }

        async function signInWithFacebook() {
            try {
                console.log('🔐 Facebook Sign In initiated');
                showAuthLoading();
                
                const provider = new firebase.auth.FacebookAuthProvider();
                provider.addScope('email');
                
                // Try popup first, fallback to redirect
                try {
                    const result = await auth.signInWithPopup(provider);
                    console.log('✅ Facebook authentication successful (popup)');
                    await processFirebaseUser(result.user);
                } catch (popupError) {
                    console.log('📱 Popup blocked, trying redirect method');
                    await auth.signInWithRedirect(provider);
                }
                
            } catch (error) {
                console.error('❌ Facebook Sign In error:', error);
                showAuthOptions();
                
                if (error.code === 'auth/popup-blocked') {
                    console.warn('Popup blocked. Please allow popups or try again.');
                } else if (error.code === 'auth/cancelled-popup-request') {
                    console.log('Sign in cancelled');
                } else {
                    console.error('Facebook sign in failed. Please try again.');
                }
            }
        }

        async function signInWithApple() {
            try {
                console.log('🔐 Apple Sign In initiated');
                showAuthLoading();
                
                const provider = new firebase.auth.OAuthProvider('apple.com');
                provider.addScope('email');
                provider.addScope('name');
                
                // Try popup first, fallback to redirect
                try {
                    const result = await auth.signInWithPopup(provider);
                    console.log('✅ Apple authentication successful (popup)');
                    await processFirebaseUser(result.user);
                } catch (popupError) {
                    console.log('📱 Popup blocked, trying redirect method');
                    await auth.signInWithRedirect(provider);
                }
                
            } catch (error) {
                console.error('❌ Apple Sign In error:', error);
                showAuthOptions();
                
                if (error.code === 'auth/popup-blocked') {
                    console.warn('Popup blocked. Please allow popups or try again.');
                } else if (error.code === 'auth/cancelled-popup-request') {
                    console.log('Sign in cancelled');
                } else {
                    console.error('Apple sign in failed. Please try again.');
                }
            }
        }

        // Phone Authentication Functions
        function initRecaptcha() {
            if (!recaptchaVerifier) {
                recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
                    size: 'invisible',
                    callback: (response) => {
                        console.log('reCAPTCHA solved');
                    },
                    'expired-callback': () => {
                        console.log('reCAPTCHA expired');
                        recaptchaVerifier = null;
                    }
                });
            }
            return recaptchaVerifier;
        }

        async function sendOTP() {
            const phoneNumber = document.getElementById('phoneNumber').value.trim();
            const countryCode = document.getElementById('countryCode').value;
            
            if (!phoneNumber) {
                console.warn('Please enter your phone number');
                return;
            }

            const fullPhoneNumber = countryCode + phoneNumber;
            console.log('📱 Sending OTP to:', fullPhoneNumber);

            // Show loading state
            const btn = document.querySelector('#phoneLoginScreen .auth-submit-btn');
            const btnText = document.getElementById('otpBtnText');
            const btnLoader = document.getElementById('otpBtnLoader');
            
            btn.disabled = true;
            btnText.style.display = 'none';
            btnLoader.style.display = 'block';

            try {
                const appVerifier = initRecaptcha();
                currentConfirmationResult = await auth.signInWithPhoneNumber(fullPhoneNumber, appVerifier);
                
                console.log('✅ OTP sent successfully');
                
                // Update UI for OTP verification
                document.getElementById('otpSentMessage').textContent = `Code sent to ${fullPhoneNumber}`;
                showOTPVerification();
                
            } catch (error) {
                console.error('❌ Error sending OTP:', error);
                
                // Reset reCAPTCHA on error
                if (recaptchaVerifier) {
                    recaptchaVerifier.clear();
                    recaptchaVerifier = null;
                }
                
                console.error('Failed to send OTP. Please try again.');
            } finally {
                // Reset button state
                btn.disabled = false;
                btnText.style.display = 'block';
                btnLoader.style.display = 'none';
            }
        }

        async function verifyOTP() {
            const otpInputs = document.querySelectorAll('.otp-digit');
            const otp = Array.from(otpInputs).map(input => input.value).join('');
            
            if (otp.length !== 6) {
                console.warn('Please enter the complete 6-digit code');
                return;
            }

            console.log('🔐 Verifying OTP:', otp);

            // Show loading state
            const btn = document.querySelector('#otpVerificationScreen .auth-submit-btn');
            const btnText = document.getElementById('verifyBtnText');
            const btnLoader = document.getElementById('verifyBtnLoader');
            
            btn.disabled = true;
            btnText.style.display = 'none';
            btnLoader.style.display = 'block';

            try {
                const result = await currentConfirmationResult.confirm(otp);
                console.log('✅ Phone authentication successful');
                
                showAuthLoading();
                await processFirebaseUser(result.user);
                
            } catch (error) {
                console.error('❌ Error verifying OTP:', error);
                console.error('Invalid code. Please try again.');
                
                // Reset button state
                btn.disabled = false;
                btnText.style.display = 'block';
                btnLoader.style.display = 'none';
            }
        }

        async function resendOTP() {
            await sendOTP();
            console.log('New code sent!');
        }

        // Process Firebase user and create/login Shopify customer
        async function processFirebaseUser(firebaseUser) {
            try {
                console.log('🔄 Processing Firebase user for Shopify integration');
                
                const userData = {
                    uid: firebaseUser.uid,
                    email: firebaseUser.email,
                    displayName: firebaseUser.displayName,
                    phoneNumber: firebaseUser.phoneNumber,
                    photoURL: firebaseUser.photoURL
                };

                // Call your API to create/login Shopify customer
                const response = await fetch('/api/auth/firebase', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        firebaseUser: userData,
                        action: 'createOrLoginCustomer'
                    })
                });

                const result = await response.json();
                
                if (result.success) {
                    console.log('✅ Shopify customer integration successful');
                    
                    // Store customer data
                    localStorage.setItem('shopifyCustomer', JSON.stringify(result.customer));
                    localStorage.setItem('customerAccessToken', JSON.stringify(result.customerAccessToken));
                    localStorage.setItem('firebaseUser', JSON.stringify(userData));
                    
                    await handleAuthSuccess(firebaseUser, result);
                } else {
                    throw new Error(result.error || 'Failed to create Shopify customer');
                }
                
            } catch (error) {
                console.error('❌ Error processing Firebase user:', error);
                
                // Log specific error messages
                if (error.message.includes('Email has already been taken')) {
                    console.log('Account already exists. Signing you in...');
                    // Try to continue with Firebase user anyway
                    try {
                        await handleAuthSuccess(firebaseUser, { isNewCustomer: false });
                        return;
                    } catch (fallbackError) {
                        console.error('Fallback failed:', fallbackError);
                    }
                } else if (error.message.includes('Network')) {
                    console.warn('Network error. Please check your connection and try again.');
                } else if (error.message.includes('Failed to fetch')) {
                    console.warn('Connection error. Please try again.');
                } else {
                    console.error('Account setup failed. Please try again.');
                }
                
                showAuthOptions();
            }
        }

        // Handle successful authentication
        async function handleAuthSuccess(firebaseUser, shopifyResult = null) {
            console.log('🎉 Authentication successful!');
            
            // Update header to show logged in state
            updateHeaderForLoggedInUser(firebaseUser);
            
            // Close modal
            closeAuthModal();
            
            // Update profile info if drawer is open
            const drawer = document.getElementById('profileDrawer');
            if (drawer && drawer.classList.contains('active')) {
                updateProfileInfo();
            }
            
            // Log success message
            if (shopifyResult?.isNewCustomer) {
                console.log('Welcome to EyeJack! Your account has been created.');
            } else {
                console.log('Welcome back!');
            }
        }

        // Update header icons for logged in user
        function updateHeaderForLoggedInUser(user) {
            const profileIcon = document.querySelector('.header-icon[onclick="showProfile()"]');
            if (profileIcon && user) {
                // Change profile icon to show user avatar or initials
                if (user.photoURL) {
                    profileIcon.innerHTML = `<img src="${user.photoURL}" alt="Profile" style="width: 24px; height: 24px; border-radius: 50%; object-fit: cover;">`;
                } else {
                    const initials = (user.displayName || user.email || 'U').substring(0, 1).toUpperCase();
                    profileIcon.innerHTML = `<div style="width: 24px; height: 24px; background: #2563eb; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600;">${initials}</div>`;
                }
                
                // Update onclick to show profile instead of auth modal
                profileIcon.setAttribute('onclick', 'showUserProfile()');
            }
        }

        // Update header for logged out user
        function updateHeaderForLoggedOutUser() {
            const profileIcon = document.querySelector('.header-icon[onclick*="Profile"]');
            if (profileIcon) {
                profileIcon.innerHTML = '<i class="fas fa-user"></i>';
                profileIcon.setAttribute('onclick', 'openAuthModal()');
            }
        }

        // Profile Drawer Functions
        function showUserProfile() {
            openProfileDrawer();
        }

        function openProfileDrawer() {
            const drawer = document.getElementById('profileDrawer');
            drawer.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Update user info
            updateProfileInfo();
            
            // Add click outside to close
            setTimeout(() => {
                drawer.addEventListener('click', (e) => {
                    if (e.target === drawer) {
                        closeProfileDrawer();
                    }
                });
            }, 100);
        }

        function closeProfileDrawer() {
            const drawer = document.getElementById('profileDrawer');
            const drawerContent = drawer?.querySelector('.profile-drawer-content');
            
            drawer.classList.remove('active');
            document.body.style.overflow = '';
            
            // Reset transform for next opening
            if (drawerContent) {
                drawerContent.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    drawerContent.style.transform = '';
                }, 300);
            }
        }

        // Add keyboard support for profile drawer and modals
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const drawer = document.getElementById('profileDrawer');
                const thankYouModal = document.getElementById('thankYouModal');
                const trackOrderModal = document.getElementById('trackOrderModal');
                
                if (thankYouModal && thankYouModal.classList.contains('active')) {
                    closeThankYouModal();
                } else if (trackOrderModal && trackOrderModal.classList.contains('active')) {
                    closeTrackOrderModal();
                } else if (drawer && drawer.classList.contains('active')) {
                    closeProfileDrawer();
                }
            }
            
            // Allow Enter key to submit track order form
            if (e.key === 'Enter') {
                const trackOrderModal = document.getElementById('trackOrderModal');
                const trackOrderInput = document.getElementById('trackOrderNumber');
                
                if (trackOrderModal && trackOrderModal.classList.contains('active') && 
                    document.activeElement === trackOrderInput) {
                    trackOrderByNumber();
                }
            }
        });

        // Add swipe gesture support for profile drawer
        let profileStartX = 0;
        let profileCurrentX = 0;
        let isProfileDragging = false;

        document.addEventListener('touchstart', (e) => {
            const drawer = document.getElementById('profileDrawer');
            const drawerContent = drawer?.querySelector('.profile-drawer-content');
            
            if (drawer?.classList.contains('active') && drawerContent?.contains(e.target)) {
                profileStartX = e.touches[0].clientX;
                isProfileDragging = true;
            }
        });

        document.addEventListener('touchmove', (e) => {
            if (!isProfileDragging) return;
            
            profileCurrentX = e.touches[0].clientX;
            const diffX = profileCurrentX - profileStartX;
            
            // Only allow right swipe (to close)
            if (diffX > 0) {
                const drawer = document.getElementById('profileDrawer');
                const drawerContent = drawer?.querySelector('.profile-drawer-content');
                if (drawerContent) {
                    drawerContent.style.transform = `translateX(${Math.min(diffX, 300)}px)`;
                }
            }
        });

        document.addEventListener('touchend', (e) => {
            if (!isProfileDragging) return;
            isProfileDragging = false;
            
            const diffX = profileCurrentX - profileStartX;
            const drawer = document.getElementById('profileDrawer');
            const drawerContent = drawer?.querySelector('.profile-drawer-content');
            
            if (drawerContent) {
                if (diffX > 100) { // Swipe threshold
                    closeProfileDrawer();
                } else {
                    // Snap back
                    drawerContent.style.transform = 'translateX(0)';
                }
            }
        });

        function updateProfileInfo() {
            const phoneElement = document.getElementById('userPhoneNumber');
            
            if (currentUser) {
                // Show user's phone number or email
                if (currentUser.phoneNumber) {
                    phoneElement.textContent = currentUser.phoneNumber;
                } else if (currentUser.email) {
                    phoneElement.textContent = currentUser.email;
                } else {
                    phoneElement.textContent = 'User Account';
                }
            } else {
                phoneElement.textContent = 'Not signed in';
            }
        }

        // Profile Menu Functions
        function showUserOrders() {
            closeProfileDrawer();
            openOrdersModal();
            console.log('📦 Showing user orders');
        }

        function showUserWishlist() {
            closeProfileDrawer();
            openWishlistModal();
            console.log('❤️ Showing user wishlist');
        }

        function showBookmarkedRecipes() {
            closeProfileDrawer();
            openRecipesModal();
            console.log('📖 Showing bookmarked recipes');
        }

        // Action Card Functions
        function showEyeJackMoney() {
            console.log('💰 EyeJack Money - Wallet & Rewards section');
            alert('EyeJack Money\n\nManage your wallet, view rewards, and track your balance.\n\nComing soon!');
        }

        function showSupport() {
            console.log('🎧 Support - Help & Contact section');
            alert('Support Center\n\nGet help with your orders, contact customer service, or view FAQs.\n\nComing soon!');
        }

        function showPayments() {
            console.log('💳 Payments - Cards & Methods section');
            alert('Payment Methods\n\nManage your saved cards, payment preferences, and billing information.\n\nComing soon!');
        }

        function showAddressBook() {
            closeProfileDrawer();
            openAddressModal();
            console.log('📍 Showing address book');
        }

        function showGSTDetails() {
            closeProfileDrawer();
            openGSTModal();
            console.log('📄 Showing GST details');
        }

        function showGiftCards() {
            closeProfileDrawer();
            openGiftCardsModal();
            console.log('🎁 Showing gift cards');
        }

        async function signOutUser() {
            try {
                console.log('👋 Signing out user');
                
                // Close profile drawer first
                closeProfileDrawer();
                
                // Sign out from Firebase
                await auth.signOut();
                
                // Clear stored data
                localStorage.removeItem('shopifyCustomer');
                localStorage.removeItem('customerAccessToken');
                localStorage.removeItem('firebaseUser');
                
                // Clear current user
                currentUser = null;
                
                // Update UI
                updateHeaderForLoggedOutUser();
                
                console.log('Signed out successfully');
                
            } catch (error) {
                console.error('❌ Sign out error:', error);
                console.error('Error signing out. Please try again.');
            }
        }

        // Modal Functions
        
        // Orders Modal
        function openOrdersModal() {
            const modal = document.getElementById('ordersModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            loadUserOrders();
        }

        function closeOrdersModal() {
            const modal = document.getElementById('ordersModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        async function loadUserOrders() {
            const content = document.getElementById('ordersContent');
            const customerAccessToken = JSON.parse(localStorage.getItem('customerAccessToken') || 'null');
            
            if (!customerAccessToken || !customerAccessToken.accessToken) {
                content.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-shopping-bag"></i>
                        <h3>No orders found</h3>
                        <p>You need to be logged in to view your orders</p>
                    </div>
                `;
                return;
            }

            try {
                // Show loading state
                content.innerHTML = `
                    <div class="loading-state">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading your orders...</p>
                    </div>
                `;
                
                // Fetch real orders from Shopify
                const response = await fetch(`${CONFIG.apiUrl}/customer-orders?customerAccessToken=${customerAccessToken.accessToken}`);
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'Failed to load orders');
                }
                
                const orders = data.orders;
                
                if (orders.length === 0) {
                    content.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-shopping-bag"></i>
                            <h3>No orders yet</h3>
                            <p>Your order history will appear here</p>
                        </div>
                    `;
                    return;
                }
                
                // Render real orders
                const ordersHTML = orders.map(order => {
                    const orderDate = new Date(order.processedAt).toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'short',
                        day: 'numeric'
                    });
                    
                    const statusClass = getOrderStatusClass(order.fulfillmentStatus, order.financialStatus);
                    const statusText = getOrderStatusText(order.fulfillmentStatus, order.financialStatus);
                    
                    // Get first line item for display
                    const firstItem = order.lineItems.edges[0]?.node;
                    const itemImage = firstItem?.variant?.image?.url || 'https://via.placeholder.com/60x60?text=No+Image';
                    const itemTitle = firstItem?.title || 'Order Items';
                    
                    const totalAmount = parseFloat(order.totalPriceV2.amount);
                    const currency = order.totalPriceV2.currencyCode;
                    
                    return `
                        <div class="order-item">
                            <div class="order-header">
                                <div class="order-number">#${order.orderNumber}</div>
                                <div class="order-status ${statusClass}">${statusText}</div>
                            </div>
                            <div class="order-details">
                                <div class="order-image" style="background-image: url('${itemImage}')"></div>
                                <div class="order-info">
                                    <div class="order-product-name">${itemTitle}</div>
                                    <div class="order-date">Ordered on ${orderDate}</div>
                                    <div class="order-total">${currency === 'INR' ? '₹' : currency} ${totalAmount.toFixed(2)}</div>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
                
                content.innerHTML = ordersHTML;
                
            } catch (error) {
                console.error('Error loading orders:', error);
                content.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3>Failed to load orders</h3>
                        <p>${error.message || 'Please try again later'}</p>
                    </div>
                `;
            }
        }
        
        function getOrderStatusClass(fulfillmentStatus, financialStatus) {
            if (fulfillmentStatus === 'FULFILLED') return 'delivered';
            if (fulfillmentStatus === 'PARTIAL') return 'shipped';
            if (financialStatus === 'PAID' || financialStatus === 'AUTHORIZED') return 'processing';
            return 'processing';
        }
        
        function getOrderStatusText(fulfillmentStatus, financialStatus) {
            if (fulfillmentStatus === 'FULFILLED') return 'Delivered';
            if (fulfillmentStatus === 'PARTIAL') return 'Shipped';
            if (fulfillmentStatus === 'UNFULFILLED' && financialStatus === 'PAID') return 'Processing';
            if (financialStatus === 'PENDING') return 'Payment Pending';
            return 'Processing';
        }

        // Wishlist Modal
        function openWishlistModal() {
            const modal = document.getElementById('wishlistModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            loadWishlistItems();
        }

        function closeWishlistModal() {
            const modal = document.getElementById('wishlistModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        function loadWishlistItems() {
            const content = document.getElementById('wishlistContent');
            const wishlist = JSON.parse(localStorage.getItem('userWishlist') || '[]');
            
            if (wishlist.length === 0) {
                content.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-heart"></i>
                        <h3>Your wishlist is empty</h3>
                        <p>Browse our products and add items to your wishlist</p>
                    </div>
                `;
                return;
            }

            const wishlistHTML = wishlist.map(item => `
                <div class="wishlist-item">
                    <div class="wishlist-image" style="background-image: url('${item.image}')"></div>
                    <div class="wishlist-info">
                        <div class="wishlist-product-name">${item.name}</div>
                        <div class="wishlist-price">₹${item.price}</div>
                        <div class="wishlist-actions">
                            <button class="wishlist-btn primary" onclick="addToCartAndUpdate('${item.id}')">Add to Cart</button>
                            <button class="wishlist-btn secondary" onclick="removeFromWishlist('${item.id}')">Remove</button>
                        </div>
                    </div>
                </div>
            `).join('');

            content.innerHTML = wishlistHTML;
        }

        function clearWishlist() {
            if (confirm('Are you sure you want to clear your entire wishlist?')) {
                localStorage.removeItem('userWishlist');
                loadWishlistItems();
                console.log('Wishlist cleared');
            }
        }

        function addToWishlist(productId, productName, productPrice, productImage) {
            const wishlist = JSON.parse(localStorage.getItem('userWishlist') || '[]');
            const existingItem = wishlist.find(item => item.id === productId);
            
            if (!existingItem) {
                wishlist.push({
                    id: productId,
                    name: productName,
                    price: productPrice,
                    image: productImage,
                    addedAt: new Date().toISOString()
                });
                localStorage.setItem('userWishlist', JSON.stringify(wishlist));
                console.log('Added to wishlist!');
            } else {
                console.log('Already in wishlist');
            }
        }

        function removeFromWishlist(productId) {
            const wishlist = JSON.parse(localStorage.getItem('userWishlist') || '[]');
            const updatedWishlist = wishlist.filter(item => item.id !== productId);
            localStorage.setItem('userWishlist', JSON.stringify(updatedWishlist));
            loadWishlistItems();
            console.log('Removed from wishlist');
        }

        // Recipes Modal
        function openRecipesModal() {
            const modal = document.getElementById('recipesModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            loadBookmarkedRecipes();
        }

        function closeRecipesModal() {
            const modal = document.getElementById('recipesModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        function loadBookmarkedRecipes() {
            const content = document.getElementById('recipesContent');
            const recipes = JSON.parse(localStorage.getItem('bookmarkedRecipes') || '[]');
            
            if (recipes.length === 0) {
                content.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-bookmark"></i>
                        <h3>No bookmarked recipes</h3>
                        <p>Save your favorite beauty and skincare recipes here</p>
                    </div>
                `;
                return;
            }

            const recipesHTML = recipes.map(recipe => `
                <div class="recipe-item">
                    <div class="recipe-image">
                        <i class="fas fa-${recipe.icon || 'heart'}"></i>
                    </div>
                    <div class="recipe-content">
                        <div class="recipe-title">${recipe.title}</div>
                        <div class="recipe-description">${recipe.description}</div>
                        <div class="recipe-tags">
                            ${recipe.tags.map(tag => `<span class="recipe-tag">${tag}</span>`).join('')}
                        </div>
                    </div>
                </div>
            `).join('');

            content.innerHTML = recipesHTML;
        }

        function addNewRecipe() {
            const title = prompt('Recipe Title:');
            if (!title) return;
            
            const description = prompt('Recipe Description:');
            if (!description) return;
            
            const tags = prompt('Tags (comma separated):');
            const tagsArray = tags ? tags.split(',').map(tag => tag.trim()) : [];
            
            const recipes = JSON.parse(localStorage.getItem('bookmarkedRecipes') || '[]');
            recipes.push({
                id: Date.now().toString(),
                title,
                description,
                tags: tagsArray,
                icon: 'leaf',
                createdAt: new Date().toISOString()
            });
            
            localStorage.setItem('bookmarkedRecipes', JSON.stringify(recipes));
            loadBookmarkedRecipes();
            console.log('Recipe added!');
        }

        // Address Modal
        function openAddressModal() {
            const modal = document.getElementById('addressModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            loadSavedAddresses();
        }

        function closeAddressModal() {
            const modal = document.getElementById('addressModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        async function loadSavedAddresses() {
            const content = document.getElementById('addressContent');
            const customerAccessToken = JSON.parse(localStorage.getItem('customerAccessToken') || 'null');
            
            if (!customerAccessToken || !customerAccessToken.accessToken) {
                content.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-map-marker-alt"></i>
                        <h3>No saved addresses</h3>
                        <p>You need to be logged in to manage addresses</p>
                    </div>
                `;
                return;
            }

            try {
                // Show loading state
                content.innerHTML = `
                    <div class="loading-state">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading your addresses...</p>
                    </div>
                `;
                
                // Fetch real addresses from Shopify
                const response = await fetch(`${CONFIG.apiUrl}/customer-addresses?customerAccessToken=${customerAccessToken.accessToken}`);
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'Failed to load addresses');
                }
                
                const addresses = data.addresses;
                
                if (addresses.length === 0) {
                    content.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-map-marker-alt"></i>
                            <h3>No saved addresses</h3>
                            <p>Add your delivery addresses for faster checkout</p>
                        </div>
                    `;
                    return;
                }

                const addressesHTML = addresses.map(address => {
                    const addressType = getAddressType(address.company, address.firstName, address.lastName);
                    const fullName = `${address.firstName} ${address.lastName}`.trim();
                    const addressLine = [address.address1, address.address2].filter(Boolean).join(', ');
                    const locationLine = [address.city, address.province, address.zip, address.country].filter(Boolean).join(', ');
                    
                    return `
                        <div class="address-item ${address.isDefault ? 'selected' : ''}" onclick="selectAddress('${address.id}')">
                            <div class="address-header">
                                <div class="address-type">${addressType}</div>
                                <div class="address-actions">
                                    <button class="address-action-btn" onclick="editAddress('${address.id}'); event.stopPropagation();">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="address-action-btn" onclick="deleteAddress('${address.id}'); event.stopPropagation();">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="address-name">${fullName}</div>
                            <div class="address-details">${addressLine}<br/>${locationLine}</div>
                            ${address.phone ? `<div class="address-phone">📞 ${address.phone}</div>` : ''}
                        </div>
                    `;
                }).join('');

                content.innerHTML = addressesHTML;
                
            } catch (error) {
                console.error('Error loading addresses:', error);
                content.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3>Failed to load addresses</h3>
                        <p>${error.message || 'Please try again later'}</p>
                    </div>
                `;
            }
        }
        
        function getAddressType(company, firstName, lastName) {
            if (company && company.trim()) return 'OFFICE';
            if (firstName && lastName) return 'HOME';
            return 'OTHER';
        }

        function addNewAddress() {
            showAddressForm();
        }
        
        function showAddressForm(editAddress = null) {
            const isEdit = editAddress !== null;
            const title = isEdit ? 'Edit Address' : 'Add New Address';
            
            const modal = document.createElement('div');
            modal.className = 'feature-modal active';
            modal.innerHTML = `
                <div class="modal-backdrop" onclick="closeAddressForm()"></div>
                <div class="modal-content">
                    <div class="modal-header">
                        <button class="modal-back-btn" onclick="closeAddressForm()">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <h2 class="modal-title">${title}</h2>
                        <button class="modal-action-btn" onclick="saveAddressForm()">Save</button>
                    </div>
                    <div class="modal-body">
                        <form id="addressForm" class="gst-form">
                            <div class="form-group">
                                <label for="firstName">First Name *</label>
                                <input type="text" id="firstName" value="${editAddress?.firstName || ''}" required>
                            </div>
                            <div class="form-group">
                                <label for="lastName">Last Name *</label>
                                <input type="text" id="lastName" value="${editAddress?.lastName || ''}" required>
                            </div>
                            <div class="form-group">
                                <label for="company">Company (Optional)</label>
                                <input type="text" id="company" value="${editAddress?.company || ''}">
                            </div>
                            <div class="form-group">
                                <label for="address1">Address Line 1 *</label>
                                <input type="text" id="address1" value="${editAddress?.address1 || ''}" required>
                            </div>
                            <div class="form-group">
                                <label for="address2">Address Line 2 (Optional)</label>
                                <input type="text" id="address2" value="${editAddress?.address2 || ''}">
                            </div>
                            <div class="form-group">
                                <label for="city">City *</label>
                                <input type="text" id="city" value="${editAddress?.city || ''}" required>
                            </div>
                            <div class="form-group">
                                <label for="province">State/Province *</label>
                                <input type="text" id="province" value="${editAddress?.province || ''}" required>
                            </div>
                            <div class="form-group">
                                <label for="zip">ZIP/Postal Code *</label>
                                <input type="text" id="zip" value="${editAddress?.zip || ''}" required>
                            </div>
                            <div class="form-group">
                                <label for="country">Country *</label>
                                <input type="text" id="country" value="${editAddress?.country || 'India'}" required>
                            </div>
                            <div class="form-group">
                                <label for="phone">Phone Number (Optional)</label>
                                <input type="tel" id="phone" value="${editAddress?.phone || ''}">
                            </div>
                            <input type="hidden" id="editAddressId" value="${editAddress?.id || ''}">
                        </form>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            document.body.style.overflow = 'hidden';
            window.currentAddressModal = modal;
        }
        
        function closeAddressForm() {
            if (window.currentAddressModal) {
                document.body.removeChild(window.currentAddressModal);
                document.body.style.overflow = '';
                window.currentAddressModal = null;
            }
        }
        
        async function saveAddressForm() {
            const customerAccessToken = JSON.parse(localStorage.getItem('customerAccessToken') || 'null');
            
            if (!customerAccessToken || !customerAccessToken.accessToken) {
                console.warn('Please log in to save address');
                return;
            }
            
            const form = document.getElementById('addressForm');
            const formData = new FormData();
            
            // Get all form values
            const addressData = {
                firstName: form.firstName.value.trim(),
                lastName: form.lastName.value.trim(),
                company: form.company.value.trim(),
                address1: form.address1.value.trim(),
                address2: form.address2.value.trim(),
                city: form.city.value.trim(),
                province: form.province.value.trim(),
                zip: form.zip.value.trim(),
                country: form.country.value.trim(),
                phone: form.phone.value.trim()
            };
            
            // Validate required fields
            if (!addressData.firstName || !addressData.lastName || !addressData.address1 || !addressData.city || !addressData.province || !addressData.zip || !addressData.country) {
                console.warn('Please fill in all required fields');
                return;
            }
            
            try {
                formData.append('customerAccessToken', customerAccessToken.accessToken);
                
                // Check if editing or creating
                const editAddressId = form.editAddressId.value;
                if (editAddressId) {
                    formData.append('action', 'update');
                    formData.append('addressId', editAddressId);
                } else {
                    formData.append('action', 'create');
                }
                
                // Append address data
                Object.keys(addressData).forEach(key => {
                    formData.append(key, addressData[key]);
                });
                
                const response = await fetch(`${CONFIG.apiUrl}/customer-addresses`, {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'Failed to save address');
                }
                
                closeAddressForm();
                loadSavedAddresses();
                console.log(editAddressId ? 'Address updated successfully!' : 'Address added successfully!');
                
            } catch (error) {
                console.error('Error saving address:', error);
                console.error(error.message || 'Failed to save address');
            }
        }
        
        function editAddress(addressId) {
            // Get the address data from the current loaded addresses
            const addressElement = document.querySelector(`.address-item[onclick="selectAddress('${addressId}')"]`);
            if (!addressElement) {
                console.error('Address not found');
                return;
            }
            
            // For now, show a simple edit interface
            // In a real implementation, you'd fetch the full address details from Shopify
            console.log('Edit functionality coming soon! Delete and re-add for now.');
        }

        async function selectAddress(addressId) {
            const customerAccessToken = JSON.parse(localStorage.getItem('customerAccessToken') || 'null');
            
            if (!customerAccessToken || !customerAccessToken.accessToken) {
                console.warn('Please log in to select default address');
                return;
            }
            
            try {
                const formData = new FormData();
                formData.append('action', 'setDefault');
                formData.append('customerAccessToken', customerAccessToken.accessToken);
                formData.append('addressId', addressId);
                
                const response = await fetch(`${CONFIG.apiUrl}/customer-addresses`, {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'Failed to update default address');
                }
                
                loadSavedAddresses();
                console.log('Default address updated');
                
            } catch (error) {
                console.error('Error setting default address:', error);
                console.error(error.message || 'Failed to update default address');
            }
        }

        async function deleteAddress(addressId) {
            if (!confirm('Are you sure you want to delete this address?')) {
                return;
            }
            
            const customerAccessToken = JSON.parse(localStorage.getItem('customerAccessToken') || 'null');
            
            if (!customerAccessToken || !customerAccessToken.accessToken) {
                console.warn('Please log in to delete address');
                return;
            }
            
            try {
                const formData = new FormData();
                formData.append('action', 'delete');
                formData.append('customerAccessToken', customerAccessToken.accessToken);
                formData.append('addressId', addressId);
                
                const response = await fetch(`${CONFIG.apiUrl}/customer-addresses`, {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'Failed to delete address');
                }
                
                loadSavedAddresses();
                console.log('Address deleted');
                
            } catch (error) {
                console.error('Error deleting address:', error);
                console.error(error.message || 'Failed to delete address');
            }
        }

        // GST Modal
        function openGSTModal() {
            const modal = document.getElementById('gstModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            loadGSTDetails();
        }

        function closeGSTModal() {
            const modal = document.getElementById('gstModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        function loadGSTDetails() {
            const gstData = JSON.parse(localStorage.getItem('gstDetails') || '{}');
            
            document.getElementById('gstNumber').value = gstData.gstNumber || '';
            document.getElementById('businessName').value = gstData.businessName || '';
            document.getElementById('businessAddress').value = gstData.businessAddress || '';
        }

        function saveGSTDetails() {
            const gstDetails = {
                gstNumber: document.getElementById('gstNumber').value,
                businessName: document.getElementById('businessName').value,
                businessAddress: document.getElementById('businessAddress').value,
                updatedAt: new Date().toISOString()
            };
            
            if (!gstDetails.gstNumber.trim()) {
                console.warn('Please enter GST Number');
                return;
            }
            
            localStorage.setItem('gstDetails', JSON.stringify(gstDetails));
            closeGSTModal();
            console.log('GST details saved successfully!');
        }

        // Gift Cards Modal
        function openGiftCardsModal() {
            const modal = document.getElementById('giftCardsModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            loadGiftCards();
        }

        function closeGiftCardsModal() {
            const modal = document.getElementById('giftCardsModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        function loadGiftCards() {
            const content = document.getElementById('giftCardsContent');
            const giftCards = JSON.parse(localStorage.getItem('userGiftCards') || '[]');
            
            if (giftCards.length === 0) {
                content.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-gift"></i>
                        <h3>No gift cards</h3>
                        <p>Purchase gift cards for yourself or loved ones</p>
                    </div>
                `;
                return;
            }

            const giftCardsHTML = giftCards.map(card => `
                <div class="gift-card">
                    <div class="gift-card-header">
                        <div class="gift-card-logo">EYEJACK</div>
                        <div class="gift-card-type">GIFT CARD</div>
                    </div>
                    <div class="gift-card-amount">₹${card.amount}</div>
                    <div class="gift-card-code">${card.code}</div>
                </div>
            `).join('');

            content.innerHTML = giftCardsHTML;
        }

        function buyGiftCard() {
            const amount = prompt('Gift Card Amount (₹):');
            if (!amount || isNaN(amount)) {
                console.warn('Please enter a valid amount');
                return;
            }
            
            const giftCards = JSON.parse(localStorage.getItem('userGiftCards') || '[]');
            const newCard = {
                id: Date.now().toString(),
                amount: parseInt(amount),
                code: 'EJ' + Math.random().toString(36).substr(2, 8).toUpperCase(),
                purchasedAt: new Date().toISOString(),
                isActive: true
            };
            
            giftCards.push(newCard);
            localStorage.setItem('userGiftCards', JSON.stringify(giftCards));
            loadGiftCards();
            console.log(`Gift card purchased! Code: ${newCard.code}`);
        }

        // Appearance Modal
        function openAppearanceModal() {
            const modal = document.getElementById('appearanceModal');
            if (!modal) {
                console.error('Appearance modal not found');
                return;
            }
            
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Update current theme selection
            try {
                const currentTheme = localStorage.getItem('selectedTheme') || 'light';
                const themeInput = document.querySelector(`input[value="${currentTheme}"]`);
                
                if (themeInput) {
                    themeInput.checked = true;
                    
                    // Remove all selected classes first
                    document.querySelectorAll('.theme-option').forEach(option => {
                        option.classList.remove('selected');
                    });
                    
                    // Add selected class to current theme
                    const themeOption = themeInput.closest('.theme-option');
                    if (themeOption) {
                        themeOption.classList.add('selected');
                    }
                } else {
                    console.warn('Theme input not found for:', currentTheme);
                }
            } catch (error) {
                console.error('Error updating theme selection:', error);
            }
        }

        function closeAppearanceModal() {
            const modal = document.getElementById('appearanceModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        // Birthday Modal Functions
        function openBirthdayModal() {
            const modal = document.getElementById('birthdayModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Load existing birthday if saved
            const savedBirthday = localStorage.getItem('userBirthday');
            if (savedBirthday) {
                const birthdayInput = document.getElementById('birthdayDate');
                birthdayInput.value = savedBirthday;
            }
        }

        function closeBirthdayModal() {
            const modal = document.getElementById('birthdayModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        function saveBirthday() {
            const birthdayInput = document.getElementById('birthdayDate');
            const birthdayValue = birthdayInput.value;
            
            if (!birthdayValue) {
                alert('Please select your birthday');
                return;
            }
            
            // Save birthday to localStorage
            localStorage.setItem('userBirthday', birthdayValue);
            
            // Update the profile section
            updateBirthdayDisplay(birthdayValue);
            
            // Close modal
            closeBirthdayModal();
            
            console.log('🎂 Birthday saved:', birthdayValue);
        }

        function updateBirthdayDisplay(birthday) {
            const birthdayTitle = document.getElementById('birthdayTitle');
            const birthdaySubtitle = document.getElementById('birthdaySubtitle');
            
            if (birthday) {
                // Format the date nicely
                const date = new Date(birthday);
                const options = { month: 'long', day: 'numeric' };
                const formattedDate = date.toLocaleDateString('en-US', options);
                
                birthdayTitle.textContent = 'Your birthday';
                birthdaySubtitle.textContent = formattedDate;
                birthdaySubtitle.style.color = '#059669';
            } else {
                birthdayTitle.textContent = 'Add your birthday';
                birthdaySubtitle.textContent = 'Enter details';
                birthdaySubtitle.style.color = '#059669';
            }
        }

        // Load birthday on page load
        function loadSavedBirthday() {
            const savedBirthday = localStorage.getItem('userBirthday');
            if (savedBirthday) {
                updateBirthdayDisplay(savedBirthday);
            }
        }

        // Thank You Modal Functions
        function showThankYouModal(order) {
            const modal = document.getElementById('thankYouModal');
            
            // Get total price - support both old and new formats
            const totalAmount = order.totalPrice || order.totalPriceSet?.shopMoney?.amount || 'N/A';
            const currency = order.currencyCode || order.totalPriceSet?.shopMoney?.currencyCode || 'INR';
            
            // Format the order date
            const orderDate = order.createdAt ? new Date(order.createdAt).toLocaleDateString('en-GB', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            }) : new Date().toLocaleDateString('en-GB', {
                day: 'numeric', 
                month: 'short',
                year: 'numeric'
            });
            
            // Update modal content with order details
            document.getElementById('thankYouOrderNumber').textContent = order.name || '#N/A';
            document.getElementById('thankYouOrderTotal').textContent = `${currency === 'INR' ? '₹' : currency + ' '}${totalAmount}`;
            document.getElementById('thankYouOrderEmail').textContent = order.email || 'N/A';
            document.getElementById('thankYouOrderDate').textContent = orderDate;
            
            // Store order details for potential future use
            localStorage.setItem('lastOrder', JSON.stringify(order));
            
            // Show modal
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            console.log('🎉 Thank you modal shown for order:', order.name);
        }

        function closeThankYouModal() {
            const modal = document.getElementById('thankYouModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        function viewOrderDetails() {
            // For now, we'll show the user orders modal
            // You can later integrate this with a specific order detail view
            closeThankYouModal();
            
            // Wait a bit then show orders modal
            setTimeout(() => {
                showUserOrders();
            }, 300);
        }

        // Track Order Functions
        function showTrackOrder() {
            const modal = document.getElementById('trackOrderModal');
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Reset form
            document.getElementById('trackOrderNumber').value = '';
            document.getElementById('trackingResults').style.display = 'none';
            document.querySelector('.track-order-form').style.display = 'block';
            
            console.log('🚚 Showing track order modal');
        }

        function closeTrackOrderModal() {
            const modal = document.getElementById('trackOrderModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        async function trackOrderByNumber() {
            const orderNumberInput = document.getElementById('trackOrderNumber');
            const orderNumber = orderNumberInput.value.trim();
            
            if (!orderNumber) {
                orderNumberInput.focus();
                return;
            }
            
            const customerAccessToken = JSON.parse(localStorage.getItem('customerAccessToken') || 'null');
            const trackingResults = document.getElementById('trackingResults');
            const trackOrderForm = document.querySelector('.track-order-form');
            
            try {
                // Show loading state
                trackingResults.innerHTML = `
                    <div class="loading-state" style="text-align: center; padding: 40px;">
                        <i class="fas fa-spinner fa-spin" style="font-size: 32px; color: #2563eb; margin-bottom: 16px;"></i>
                        <p style="color: #6b7280; margin: 0;">Tracking your order...</p>
                    </div>
                `;
                trackingResults.style.display = 'block';
                trackOrderForm.style.display = 'none';
                
                // Clean order number (remove # if present)
                const cleanOrderNumber = orderNumber.replace('#', '');
                
                // Fetch orders to find the matching one
                const response = await fetch(`${CONFIG.apiUrl}/customer-orders?customerAccessToken=${customerAccessToken?.accessToken || ''}`);
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'Failed to fetch orders');
                }
                
                // Find order by number
                const order = data.orders.find(o => 
                    o.orderNumber.toString() === cleanOrderNumber || 
                    o.name === `#${cleanOrderNumber}` ||
                    o.name === cleanOrderNumber
                );
                
                if (!order) {
                    throw new Error('Order not found. Please check the order number and try again.');
                }
                
                // Display tracking information
                displayTrackingInfo(order);
                
            } catch (error) {
                console.error('Error tracking order:', error);
                trackingResults.innerHTML = `
                    <div class="empty-state" style="text-align: center; padding: 40px;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 48px; color: #ef4444; margin-bottom: 16px;"></i>
                        <h3 style="margin: 0 0 8px 0; color: #111827;">Order Not Found</h3>
                        <p style="color: #6b7280; margin: 0 0 20px 0;">${error.message}</p>
                        <button class="btn-secondary" onclick="resetTrackingForm()" style="border: 2px solid #d1d5db; padding: 12px 24px;">
                            Try Again
                        </button>
                    </div>
                `;
            }
        }

        function resetTrackingForm() {
            document.querySelector('.track-order-form').style.display = 'block';
            document.getElementById('trackingResults').style.display = 'none';
            document.getElementById('trackOrderNumber').focus();
        }

        function displayTrackingInfo(order) {
            const trackingResults = document.getElementById('trackingResults');
            
            // Format dates
            const orderDate = new Date(order.processedAt).toLocaleDateString('en-GB', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            });
            
            const estimatedDelivery = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toLocaleDateString('en-GB', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            });
            
            // Get status info
            const statusClass = getOrderStatusClass(order.fulfillmentStatus, order.financialStatus);
            const statusText = getOrderStatusText(order.fulfillmentStatus, order.financialStatus);
            
            // Get first line item for display
            const firstItem = order.lineItems.edges[0]?.node;
            const itemTitle = firstItem?.title || 'Order Items';
            
            const totalAmount = parseFloat(order.totalPriceV2.amount);
            const currency = order.totalPriceV2.currencyCode;
            
            // Create timeline based on order status
            const timeline = generateTrackingTimeline(order);
            
            trackingResults.innerHTML = `
                <div class="tracking-item">
                    <div class="tracking-header">
                        <div class="tracking-order-number">${order.name}</div>
                        <div class="tracking-status ${statusClass}">${statusText}</div>
                    </div>
                    
                    <div class="tracking-details">
                        <div class="tracking-detail-item">
                            <div class="tracking-detail-label">Order Date</div>
                            <div class="tracking-detail-value">${orderDate}</div>
                        </div>
                        <div class="tracking-detail-item">
                            <div class="tracking-detail-label">Est. Delivery</div>
                            <div class="tracking-detail-value">${estimatedDelivery}</div>
                        </div>
                        <div class="tracking-detail-item">
                            <div class="tracking-detail-label">Total Amount</div>
                            <div class="tracking-detail-value">${currency === 'INR' ? '₹' : currency} ${totalAmount.toFixed(2)}</div>
                        </div>
                        <div class="tracking-detail-item">
                            <div class="tracking-detail-label">Items</div>
                            <div class="tracking-detail-value">${order.lineItems.edges.length} item${order.lineItems.edges.length > 1 ? 's' : ''}</div>
                        </div>
                    </div>
                    
                    <div class="tracking-timeline">
                        ${timeline}
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn-secondary" onclick="resetTrackingForm()" style="border: 2px solid #d1d5db; padding: 12px 24px;">
                        Track Another Order
                    </button>
                </div>
            `;
        }

        function generateTrackingTimeline(order) {
            const steps = [
                { title: 'Order Placed', status: 'completed', date: new Date(order.processedAt) },
                { title: 'Payment Confirmed', status: order.financialStatus === 'PAID' ? 'completed' : 'pending' },
                { title: 'Order Processing', status: order.fulfillmentStatus === 'UNFULFILLED' ? 'current' : order.fulfillmentStatus === 'FULFILLED' ? 'completed' : 'pending' },
                { title: 'Shipped', status: order.fulfillmentStatus === 'FULFILLED' || order.fulfillmentStatus === 'PARTIAL' ? 'completed' : 'pending' },
                { title: 'Delivered', status: order.fulfillmentStatus === 'FULFILLED' ? 'completed' : 'pending' }
            ];
            
            return steps.map(step => {
                const dateStr = step.date ? step.date.toLocaleDateString('en-GB', { day: 'numeric', month: 'short' }) : '';
                const icon = step.status === 'completed' ? '✓' : step.status === 'current' ? '●' : '○';
                
                return `
                    <div class="timeline-step">
                        <div class="timeline-icon ${step.status}">${icon}</div>
                        <div class="timeline-content">
                            <div class="timeline-title">${step.title}</div>
                            <div class="timeline-date">${dateStr}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function setTheme(theme) {
            console.log('🎨 Setting theme to:', theme);
            
            try {
                // Update radio button
                const themeInput = document.querySelector(`input[value="${theme}"]`);
                if (themeInput) {
                    themeInput.checked = true;
                }
                
                // Update selected state
                document.querySelectorAll('.theme-option').forEach(option => {
                    option.classList.remove('selected');
                });
                
                const selectedOption = document.querySelector(`input[value="${theme}"]`)?.closest('.theme-option');
                if (selectedOption) {
                    selectedOption.classList.add('selected');
                }
                
                // Apply theme
                localStorage.setItem('selectedTheme', theme);
                applyTheme(theme);
                
                // Update profile drawer label
                const themeLabel = document.getElementById('currentThemeLabel');
                if (themeLabel) {
                    themeLabel.textContent = theme.toUpperCase();
                }
                
                console.log(`${theme.charAt(0).toUpperCase() + theme.slice(1)} mode enabled`);
                
                console.log('✅ Theme switching completed');
                
                // Close modal after a brief delay
                setTimeout(() => {
                    closeAppearanceModal();
                }, 1500);
                
            } catch (error) {
                console.error('❌ Error setting theme:', error);
                console.error('Failed to change theme');
            }
        }

        function applyTheme(theme) {
            console.log('🎨 Applying theme:', theme);
            
            const root = document.documentElement;
            const body = document.body;
            const mobileContainer = document.querySelector('.mobile-container');
            
            // Remove existing theme classes
            body.classList.remove('dark-theme', 'light-theme');
            
            if (theme === 'dark') {
                // Apply dark theme
                body.classList.add('dark-theme');
                if (mobileContainer) {
                    mobileContainer.style.background = '#1f2937';
                    mobileContainer.style.color = '#f9fafb';
                }
                
                // Update CSS variables
                root.style.setProperty('--bg-color', '#1f2937');
                root.style.setProperty('--text-color', '#f9fafb');
                root.style.setProperty('--card-bg', '#374151');
                root.style.setProperty('--border-color', '#4b5563');
                root.style.setProperty('--header-bg', '#111827');
                root.style.setProperty('--modal-bg', '#374151');
                
                // Apply dark theme to specific elements
                const profileDrawer = document.querySelector('.profile-drawer-content');
                if (profileDrawer) {
                    profileDrawer.style.background = '#374151';
                    profileDrawer.style.color = '#f9fafb';
                }
                
                const modals = document.querySelectorAll('.modal-content');
                modals.forEach(modal => {
                    modal.style.background = '#374151';
                    modal.style.color = '#f9fafb';
                });
                
                console.log('✅ Dark theme applied');
            } else {
                // Apply light theme  
                body.classList.add('light-theme');
                if (mobileContainer) {
                    mobileContainer.style.background = '#ffffff';
                    mobileContainer.style.color = '#1f2937';
                }
                
                // Update CSS variables
                root.style.setProperty('--bg-color', '#ffffff');
                root.style.setProperty('--text-color', '#1f2937');
                root.style.setProperty('--card-bg', '#ffffff');
                root.style.setProperty('--border-color', '#e5e7eb');
                root.style.setProperty('--header-bg', '#ffffff');
                root.style.setProperty('--modal-bg', '#f8f9fa');
                
                // Apply light theme to specific elements
                const profileDrawer = document.querySelector('.profile-drawer-content');
                if (profileDrawer) {
                    profileDrawer.style.background = '#f8f9fa';
                    profileDrawer.style.color = '#1f2937';
                }
                
                const modals = document.querySelectorAll('.modal-content');
                modals.forEach(modal => {
                    modal.style.background = '#f8f9fa';
                    modal.style.color = '#1f2937';
                });
                
                console.log('✅ Light theme applied');
            }
            
            // Update the profile drawer theme label
            const themeLabel = document.getElementById('currentThemeLabel');
            if (themeLabel) {
                themeLabel.textContent = theme.toUpperCase();
            }
        }

        // Test appearance functionality (for debugging)
        function testAppearance() {
            console.log('🔧 Testing appearance functionality...');
            console.log('Current theme:', localStorage.getItem('selectedTheme') || 'light');
            
            // Test modal opening
            try {
                openAppearanceModal();
                console.log('✅ Appearance modal opened successfully');
            } catch (error) {
                console.error('❌ Error opening appearance modal:', error);
            }
            
            // Test theme switching
            setTimeout(() => {
                try {
                    setTheme('dark');
                    console.log('✅ Dark theme applied successfully');
                } catch (error) {
                    console.error('❌ Error applying dark theme:', error);
                }
            }, 2000);
        }

        // Make test function available globally for debugging
        window.testAppearance = testAppearance;
        window.setTheme = setTheme;
        window.openAppearanceModal = openAppearanceModal;

        // Add click event listener to appearance setting as backup
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                const appearanceSetting = document.querySelector('.appearance-setting');
                if (appearanceSetting) {
                    // Remove any existing click handlers and add a new one
                    appearanceSetting.removeAttribute('onclick');
                    appearanceSetting.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('🎨 Appearance setting clicked');
                        openAppearanceModal();
                    });
                    console.log('✅ Appearance setting click handler added');
                } else {
                    console.warn('⚠️ Appearance setting element not found');
                }
            }, 200);
        });

        // Initialize theme on page load
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize theme after a short delay to ensure DOM is ready
            setTimeout(() => {
                const savedTheme = localStorage.getItem('selectedTheme') || 'light';
                console.log('🎨 Initializing theme:', savedTheme);
                applyTheme(savedTheme);
                if (document.getElementById('currentThemeLabel')) {
                    document.getElementById('currentThemeLabel').textContent = savedTheme.toUpperCase();
                }
                console.log('✅ Theme initialization complete');
                
                // Load saved birthday
                loadSavedBirthday();
                console.log('✅ Birthday initialization complete');
            }, 100);
        });

        // Utility Functions
        function resetPhoneForm() {
            document.getElementById('phoneNumber').value = '';
            document.getElementById('countryCode').value = '+1';
        }

        function resetOTPForm() {
            const otpInputs = document.querySelectorAll('.otp-digit');
            otpInputs.forEach(input => input.value = '');
        }

        function moveToNext(current, index) {
            if (current.value.length === 1 && index < 5) {
                const nextInput = document.querySelectorAll('.otp-digit')[index + 1];
                if (nextInput) nextInput.focus();
            }
            
            // Auto verify if all digits entered
            const otpInputs = document.querySelectorAll('.otp-digit');
            const otp = Array.from(otpInputs).map(input => input.value).join('');
            if (otp.length === 6) {
                setTimeout(() => verifyOTP(), 500);
            }
        }



        // Check if user is already logged in on page load
        document.addEventListener('DOMContentLoaded', () => {
            const savedUser = localStorage.getItem('firebaseUser');
            if (savedUser && auth.currentUser) {
                updateHeaderForLoggedInUser(auth.currentUser);
            }
        });

        // Update existing showProfile function to open auth modal
        function showProfile() {
            if (currentUser) {
                showUserProfile();
            } else {
                openAuthModal();
            }
        }
        
        // Check authentication status on page load
        document.addEventListener('DOMContentLoaded', () => {
            if (firebaseInitialized) {
                console.log('🔥 Firebase authentication system ready!');
                console.log('✅ Available sign-in methods: Phone OTP, Google, Facebook, Apple');
                
                // Check for any saved user data
                const savedUser = localStorage.getItem('firebaseUser');
                if (savedUser && auth.currentUser) {
                    updateHeaderForLoggedInUser(auth.currentUser);
                    console.log('👤 User already logged in');
                } else {
                    // Log success notification for new users
                    setTimeout(() => {
                        console.log('Authentication system ready! Click profile icon to sign in.');
                    }, 2000);
                }
            } else {
                console.log('⚠️ Firebase authentication setup incomplete');
                console.log('📖 Please enable authentication methods in Firebase Console');
            }
        });



        // Global variables for product detail
        let currentProductDetail = null;
        let selectedColor = null;

        // Product Detail Modal Functions
        async function showProduct(productId) {
            try {
                console.log(`🔍 CLICKED PRODUCT ID: "${productId}" (type: ${typeof productId})`);
                console.log('🔍 STACK TRACE:', new Error().stack);
                
                // Debug: Show all cached product IDs
                if (window.cachedProducts && window.cachedProducts.length > 0) {
                    console.log('📦 TOTAL CACHED PRODUCTS:', window.cachedProducts.length);
                    console.log('📦 Available cached product IDs:', window.cachedProducts.map(p => ({
                        id: p.id,
                        title: p.title,
                        handle: p.handle,
                        hasImages: !!p.images,
                        imageEdges: p.images?.edges?.length || 0
                    })));
                } else {
                    console.log('🔄 No cached products, loading from API...');
                    await loadProducts();
                }
                
                // Get product details
                const product = await getProductDetails(productId);
                if (!product) {
                    console.error('❌ Product not found for ID:', productId);
                    console.error('❌ Available product IDs:', window.cachedProducts?.map(p => p.id));
                    return;
                }

                currentProductDetail = product;
                console.log('✅ FOUND PRODUCT FOR DETAIL VIEW:', {
                    requestedId: productId,
                    foundId: product.id,
                    title: product.title,
                    hasImages: !!product.images,
                    imageStructure: product.images ? Object.keys(product.images) : 'no images',
                    fullImageData: product.images,
                    firstImageUrl: product.images?.edges?.[0]?.node?.url
                });
                populateProductDetail(product);
                
                // Show the modal with animation
                const modal = document.getElementById('productDetailModal');
                modal.classList.add('active');
                
                // Prevent body scroll
                document.body.style.overflow = 'hidden';
                
                console.log('✅ Product detail modal opened');
            } catch (error) {
                console.error('Error loading product details:', error);
            }
        }

        function closeProductDetail() {
            const modal = document.getElementById('productDetailModal');
            modal.classList.remove('active');
            
            // Allow body scroll
            document.body.style.overflow = '';
            
            console.log('Product detail modal closed');
        }

        function populateProductDetail(product) {
            // Update product information
            document.getElementById('productDetailBrand').textContent = 'Olivesk';
            document.getElementById('productDetailTitle').textContent = product.title || 'Beauty Flower Dress';
            
            // 🔍 DEBUG: Log the complete product pricing structure
            console.log('💰 PRODUCT DETAIL PRICING DEBUG:', {
                productId: product.id,
                title: product.title,
                priceRangeV2: product.priceRangeV2,
                variants: product.variants,
                variantPrice: product.variants?.edges?.[0]?.node?.price,
                variantCompareAtPrice: product.variants?.edges?.[0]?.node?.compareAtPrice
            });
            
            // Format price and compare at price - USE SAME LOGIC AS HOMEPAGE for consistency
            // Priority: 1) priceRangeV2 2) variant.price 3) transformed variant price from API
            let price, compareAtPrice;
            
            if (product.priceRangeV2?.minVariantPrice?.amount) {
                // Use priceRangeV2 if available
                price = product.priceRangeV2.minVariantPrice.amount;
                compareAtPrice = product.compareAtPriceRange?.minVariantPrice?.amount;
            } else if (product.variant?.price?.amount) {
                // Use the same variant data as homepage (transformed by backend API)
                price = product.variant.price.amount;
                compareAtPrice = product.variant.compareAtPrice?.amount;
            } else if (product.variants?.edges?.[0]?.node) {
                // Fallback to first variant from edges
                const firstVariant = product.variants.edges[0].node;
                price = firstVariant.price?.amount || firstVariant.price;
                compareAtPrice = firstVariant.compareAtPrice?.amount || firstVariant.compareAtPrice;
            } else {
                console.warn('⚠️ No pricing data found for product:', product.id);
                price = '0.00';
                compareAtPrice = null;
            }
            
            console.log('💰 EXTRACTED PRICES:', {
                extractedPrice: price,
                extractedCompareAtPrice: compareAtPrice,
                priceSource: product.priceRangeV2?.minVariantPrice?.amount ? 'priceRangeV2' : 
                           product.variant?.price?.amount ? 'variant.price (HOMEPAGE COMPATIBLE)' : 
                           product.variants?.edges?.[0]?.node ? 'first variant edge' : 'none',
                homepageVariant: product.variant
            });
            
            const currency = product.priceRangeV2?.minVariantPrice?.currencyCode || 'INR';
            const formattedPrice = currency === 'INR' ? `₹${price}` : `₹${price}`;
            
            // Update current price
            document.getElementById('productDetailPrice').textContent = formattedPrice;
            console.log('✅ PRODUCT DETAIL PRICE SET TO:', formattedPrice);
            
            // Handle compare at price and sale badge
            const originalPriceElement = document.getElementById('productDetailOriginalPrice');
            const saleBadgeElement = document.getElementById('productDetailSaleBadge');
            
            if (compareAtPrice && parseFloat(compareAtPrice) > parseFloat(price)) {
                // Product is on sale - use real Shopify compareAtPrice only
                const formattedComparePrice = currency === 'INR' ? `₹${compareAtPrice}` : `₹${compareAtPrice}`;
                originalPriceElement.textContent = formattedComparePrice;
                originalPriceElement.style.display = 'block';
                saleBadgeElement.style.display = 'block';
                
                // Calculate discount percentage
                const discountPercent = Math.round(((parseFloat(compareAtPrice) - parseFloat(price)) / parseFloat(compareAtPrice)) * 100);
                if (discountPercent > 0) {
                    saleBadgeElement.textContent = `SALE ${discountPercent}% OFF`;
                } else {
                    saleBadgeElement.textContent = 'SALE';
                }
            } else {
                // No sale price available - hide compared price elements
                originalPriceElement.style.display = 'none';
                saleBadgeElement.style.display = 'none';
            }
            
            // Handle product image
            const imageElement = document.getElementById('productDetailImage');
            const placeholderElement = document.getElementById('productDetailPlaceholder');
            
            console.log('📸 FULL PRODUCT OBJECT:', product);
            console.log('📸 Product images structure:', {
                hasImages: !!product.images,
                hasEdges: !!product.images?.edges,
                edgeCount: product.images?.edges?.length || 0,
                firstImageUrl: product.images?.edges?.[0]?.node?.url,
                rawImages: product.images,
                imageProperty: product.image,
                featuredImageProperty: product.featuredImage
            });
            
            let imageUrl = '';
            
            // Try different image data structures with detailed logging
            console.log('🔍 Attempting to extract image URL...');
            
            if (product.images?.edges && product.images.edges.length > 0) {
                imageUrl = product.images.edges[0].node.url;
                console.log('✅ Found GraphQL image:', imageUrl);
                console.log('🔍 GraphQL node structure:', product.images.edges[0].node);
            } else if (product.images && Array.isArray(product.images) && product.images.length > 0) {
                imageUrl = product.images[0].url || product.images[0];
                console.log('✅ Found array image:', imageUrl);
                console.log('🔍 Array structure:', product.images[0]);
            } else if (product.image) {
                imageUrl = typeof product.image === 'string' ? product.image : product.image.url;
                console.log('✅ Found simple image:', imageUrl);
                console.log('🔍 Simple image structure:', product.image);
            } else if (product.featuredImage) {
                imageUrl = product.featuredImage.url || product.featuredImage;
                console.log('✅ Found featured image:', imageUrl);
                console.log('🔍 Featured image structure:', product.featuredImage);
            } else {
                console.log('❌ No image found in any format');
            }
            
            // Add fallback test image if no real image found
            if (!imageUrl || imageUrl.trim() === '') {
                imageUrl = 'https://images.unsplash.com/photo-1572635196237-14b3f281503f?w=400&h=400&fit=crop';
                console.log('🔄 Using fallback test image');
            }
            
            console.log('🔄 Attempting to load image:', imageUrl);
            const testImg = new Image();
            testImg.onload = function() {
                console.log('✅ Image loaded successfully:', imageUrl);
                imageElement.style.backgroundImage = `url('${imageUrl}')`;
                imageElement.style.backgroundSize = 'cover';
                imageElement.style.backgroundPosition = 'center';
                imageElement.style.backgroundRepeat = 'no-repeat';
                imageElement.style.display = 'block';
                placeholderElement.style.display = 'none';
            };
            testImg.onerror = function() {
                console.log('❌ Image failed to load:', imageUrl);
                // Try with a different fallback
                const fallbackUrl = 'https://via.placeholder.com/400x400/f5f5f5/999?text=Product+Image';
                const fallbackImg = new Image();
                fallbackImg.onload = function() {
                    console.log('✅ Fallback image loaded');
                    imageElement.style.backgroundImage = `url('${fallbackUrl}')`;
                    imageElement.style.backgroundSize = 'cover';
                    imageElement.style.backgroundPosition = 'center';
                    imageElement.style.backgroundRepeat = 'no-repeat';
                    imageElement.style.display = 'block';
                    placeholderElement.style.display = 'none';
                };
                fallbackImg.onerror = function() {
                    console.log('❌ Even fallback failed, showing placeholder');
                    imageElement.style.display = 'none';
                    placeholderElement.style.display = 'flex';
                };
                fallbackImg.src = fallbackUrl;
            };
            testImg.src = imageUrl;
            
            // Update description
            const description = product.description || 'Very beautiful Dress with flared cut Using textured chiffon material, There is frilling on the sleeves and around the bottom of the dress.';
            document.getElementById('productDetailDescription').textContent = description;
            
            // Parse colors from description and generate color options
            parseAndDisplayColors(description);
            
            // Reset selected color
            selectedColor = null;
        }

        function selectColor(color) {
            selectedColor = color;
            updateColorSelection();
        }

        function updateColorSelection() {
            // Update UI
            document.querySelectorAll('.color-option').forEach(option => {
                option.classList.remove('selected');
                if (option.dataset.color === selectedColor) {
                    option.classList.add('selected');
                }
            });
        }

        function parseAndDisplayColors(description) {
            // Common color names and their hex values
            const colorMap = {
                'black': '#000000',
                'white': '#ffffff',
                'red': '#ef4444',
                'blue': '#3b82f6',
                'green': '#22c55e',
                'yellow': '#eab308',
                'orange': '#f97316',
                'purple': '#a855f7',
                'pink': '#ec4899',
                'brown': '#a3a3a3',
                'gray': '#6b7280',
                'grey': '#6b7280',
                'navy': '#1e3a8a',
                'beige': '#f5f5dc',
                'cream': '#fffdd0',
                'gold': '#ffd700',
                'silver': '#c0c0c0',
                'maroon': '#800000',
                'olive': '#808000',
                'lime': '#00ff00',
                'aqua': '#00ffff',
                'teal': '#008080',
                'fuchsia': '#ff00ff'
            };

            // Extract colors from description
            const foundColors = [];
            const descriptionLower = description.toLowerCase();
            
            Object.keys(colorMap).forEach(colorName => {
                if (descriptionLower.includes(colorName)) {
                    foundColors.push({
                        name: colorName.charAt(0).toUpperCase() + colorName.slice(1),
                        hex: colorMap[colorName]
                    });
                }
            });

            // If no colors found in description, add some default colors
            if (foundColors.length === 0) {
                foundColors.push(
                    { name: 'Black', hex: '#000000' },
                    { name: 'Brown', hex: '#8b4513' },
                    { name: 'Blue', hex: '#3b82f6' }
                );
            }

            // Generate color options HTML
            const colorContainer = document.getElementById('productDetailColors');
            colorContainer.innerHTML = '';
            
            foundColors.forEach((color, index) => {
                const colorOption = document.createElement('div');
                colorOption.className = 'color-option';
                colorOption.style.backgroundColor = color.hex;
                colorOption.dataset.color = color.name;
                colorOption.title = color.name;
                colorOption.onclick = () => selectColor(color.name);
                
                // Select first color by default
                if (index === 0) {
                    selectedColor = color.name;
                    colorOption.classList.add('selected');
                }
                
                colorContainer.appendChild(colorOption);
            });

            console.log('🎨 Parsed colors from description:', foundColors);
        }

        async function addToCartFromDetail() {
            if (!currentProductDetail) return;
            
            try {
                // Add product to cart
                await addToCart(currentProductDetail.id, 1);
                
                // Update cart content and badge
                loadCartContent();
                
                // Show success feedback
                console.log('✅ Product added to cart');
                
            } catch (error) {
                console.error('Error adding to cart:', error);
            }
        }

        async function buyNowFromDetail() {
            if (!currentProductDetail) return;
            
            try {
                // Add to cart first
                await addToCart(currentProductDetail.id, 1);
                
                // Close product detail
                closeProductDetail();
                
                // Show cart
                setTimeout(() => {
                    showCart();
                }, 300);
                
                console.log('✅ Buy now initiated');
                
            } catch (error) {
                console.error('Error with buy now:', error);
            }
        }

        function shareProduct() {
            if (!currentProductDetail) return;
            
            if (navigator.share) {
                navigator.share({
                    title: currentProductDetail.title,
                    text: `Check out this product: ${currentProductDetail.title}`,
                    url: window.location.href
                });
            } else {
                // Fallback: copy to clipboard
                const url = window.location.href;
                navigator.clipboard.writeText(url).then(() => {
                    alert('Product link copied to clipboard!');
                });
            }
        }

        // Update product cards to be clickable
        function updateProductCardsClickable() {
            // This will be called after products are loaded
            setTimeout(() => {
                const productCards = document.querySelectorAll('.product-card, .enhanced-product-card');
                productCards.forEach(card => {
                    if (!card.onclick) {
                        const productData = card.getAttribute('data-product');
                        if (productData) {
                            try {
                                const product = JSON.parse(productData);
                                card.style.cursor = 'pointer';
                                card.onclick = () => showProduct(product.id);
                            } catch (e) {
                                // Fallback: extract product ID from card
                                const title = card.querySelector('.product-title')?.textContent;
                                if (title && products.length > 0) {
                                    const product = products.find(p => p.title === title);
                                    if (product) {
                                        card.style.cursor = 'pointer';
                                        card.onclick = () => showProduct(product.id);
                                    }
                                }
                            }
                        }
                    }
                });
            }, 1000);
        }

        // Call this after products are loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Add click handlers to existing product cards
            setTimeout(() => {
                updateProductCardsClickable();
            }, 2000);
        });

    </script>
</body>
</html> 